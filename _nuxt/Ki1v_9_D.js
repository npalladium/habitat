import{e as Q,g as X,o as n,c as d,a as o,b as r,w as f,d as h,j as Z,F as w,r as k,n as C,i,t as p,p as _,m as j,l as ee,q as te,G as se,y as V,z as le,x as D,A as ie}from"./D__IzthQ.js";import{_ as oe}from"./Do0eRNzt.js";import{_ as ae}from"./C28jTKjj.js";import{_ as ne}from"./C9lyoWvN.js";import{_ as re}from"./N7pPXhgQ.js";const de={class:"max-w-lg mx-auto space-y-5"},ue={class:"flex items-center justify-between"},ce={class:"flex gap-2"},me=["onClick"],_e={class:"flex items-center justify-between"},pe={class:"text-xs font-semibold uppercase tracking-wider text-slate-500"},fe=["onClick"],ge={class:"flex-1 min-w-0"},ve={key:0,class:"text-xs text-slate-500 mt-0.5 truncate"},ye={class:"flex flex-wrap items-center gap-x-2 gap-y-1 mt-1.5"},xe={key:1,class:"text-xs text-slate-500 flex items-center gap-0.5"},be={key:2,class:"text-xs text-slate-500 flex items-center gap-0.5"},he={key:3,class:"text-xs text-amber-500 flex items-center gap-0.5"},we={key:1,class:"flex flex-wrap gap-1 mt-1.5"},ke={class:"flex flex-col gap-1 shrink-0"},Ce={key:0,class:"text-center py-12 text-slate-500"},Te={key:1,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},Ve={class:"relative w-full sm:max-w-md bg-slate-900 border border-slate-800 rounded-t-3xl sm:rounded-2xl p-5 space-y-4 max-h-[90vh] overflow-y-auto"},De={class:"text-lg font-semibold"},$e={class:"space-y-3"},Ue={class:"flex gap-2"},Oe=["onClick"],Se={class:"flex items-center justify-between"},je={key:0},Be={class:"flex gap-2"},Ne=["onClick"],ze={class:"flex items-center justify-between"},Ie={key:1},Me=["value"],Ae={class:"flex gap-2 pt-1"},Ge=Q({__name:"todos",setup(Ee){const y=ie(),c=V([]),S=V([]),U=V("all"),x=V(!1),v=V(null),O=V(!1),l=le({title:"",description:"",due_date:"",priority:"medium",estimated_minutes:"",is_recurring:!1,recurrence_rule:"daily",show_in_bored:!1,bored_category_id:"",tags:""});async function F(){[c.value,S.value]=await Promise.all([y.getTodos(),y.getBoredCategories()])}X(F);const T=new Date().toISOString().slice(0,10),B=D(()=>c.value.filter(t=>!t.is_done&&!t.archived_at&&t.due_date&&t.due_date<T)),N=D(()=>c.value.filter(t=>!t.is_done&&!t.archived_at&&t.due_date===T)),z=D(()=>{const t=new Date;t.setDate(t.getDate()+30);const e=t.toISOString().slice(0,10);return c.value.filter(u=>!u.is_done&&!u.archived_at&&u.due_date&&u.due_date>T&&u.due_date<=e)}),I=D(()=>c.value.filter(t=>!t.is_done&&!t.archived_at&&!t.due_date)),M=D(()=>c.value.filter(t=>t.is_done&&!t.archived_at).slice(-20).reverse()),A=D(()=>U.value==="done"?[{label:"Done",items:M.value,key:"done"}]:U.value==="active"?[{label:"ðŸ”´ Overdue",items:B.value,key:"overdue"},{label:"ðŸ“… Today",items:N.value,key:"today"},{label:"ðŸ“‹ Upcoming",items:z.value,key:"upcoming"},{label:"ðŸ“Œ No date",items:I.value,key:"nodate"}].filter(t=>t.items.length>0):[{label:"ðŸ”´ Overdue",items:B.value,key:"overdue"},{label:"ðŸ“… Today",items:N.value,key:"today"},{label:"ðŸ“‹ Upcoming",items:z.value,key:"upcoming"},{label:"ðŸ“Œ No date",items:I.value,key:"nodate"},{label:"âœ“ Done",items:M.value,key:"done",collapsible:!0}].filter(t=>t.items.length>0));function L(t){return t==="high"?"bg-red-500":t==="low"?"bg-slate-600":"bg-amber-500"}function q(t){if(t===T)return"Today";const e=Math.round((new Date(t).getTime()-new Date(T).getTime())/864e5);return e===1?"Tomorrow":e===-1?"Yesterday":e<0?`${Math.abs(e)}d ago`:e<7?`in ${e}d`:new Date(t+"T00:00:00").toLocaleDateString(void 0,{month:"short",day:"numeric"})}function P(t){return!t.is_done&&t.due_date&&t.due_date<T}async function R(t){const e=await y.toggleTodo(t.id),u=c.value.findIndex(m=>m.id===t.id);u!==-1&&(c.value[u]=e)}function G(){v.value=null,Object.assign(l,{title:"",description:"",due_date:"",priority:"medium",estimated_minutes:"",is_recurring:!1,recurrence_rule:"daily",show_in_bored:!1,bored_category_id:"",tags:""}),x.value=!0}function H(t){v.value=t,Object.assign(l,{title:t.title,description:t.description,due_date:t.due_date??"",priority:t.priority,estimated_minutes:t.estimated_minutes??"",is_recurring:t.is_recurring,recurrence_rule:t.recurrence_rule??"daily",show_in_bored:t.show_in_bored,bored_category_id:t.bored_category_id??"",tags:t.tags.join(", ")}),x.value=!0}async function W(){if(!l.title.trim())return;const t=l.estimated_minutes!==""?Number(l.estimated_minutes):null,e=l.tags.split(",").map(m=>m.trim()).filter(Boolean),u={title:l.title.trim(),description:l.description.trim(),due_date:l.due_date||null,priority:l.priority,estimated_minutes:t,is_recurring:l.is_recurring,recurrence_rule:l.is_recurring?l.recurrence_rule:null,show_in_bored:l.show_in_bored,bored_category_id:l.show_in_bored&&l.bored_category_id?l.bored_category_id:null,tags:e,annotations:{}};if(v.value){const m=await y.updateTodo({id:v.value.id,...u}),b=c.value.findIndex(g=>g.id===v.value.id);b!==-1&&(c.value[b]=m)}else{const m=await y.createTodo(u);c.value.push(m)}x.value=!1}async function Y(t){await y.archiveTodo(t.id),c.value=c.value.filter(e=>e.id!==t.id)}async function J(t){await y.deleteTodo(t.id),c.value=c.value.filter(e=>e.id!==t.id)}return(t,e)=>{const u=Z,m=ee,b=oe,g=ae,K=ne,E=re;return n(),d("div",de,[o("div",ue,[e[13]||(e[13]=o("h1",{class:"text-2xl font-bold"},"TODOs",-1)),r(u,{size:"sm",icon:"i-heroicons-plus",onClick:G},{default:f(()=>[...e[12]||(e[12]=[h("Add",-1)])]),_:1})]),o("div",ce,[(n(),d(w,null,k([["all","All"],["active","Active"],["done","Done"]],s=>o("button",{key:s[0],class:C(["px-3 py-1 rounded-full text-sm font-medium transition-colors",i(U)===s[0]?"bg-primary-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"]),onClick:a=>U.value=s[0]},p(s[1]),11,me)),64))]),(n(!0),d(w,null,k(i(A),s=>(n(),d("div",{key:s.key,class:"space-y-2"},[o("div",_e,[o("p",pe,p(s.label),1),s.collapsible?(n(),d("button",{key:0,class:"text-xs text-slate-500 hover:text-slate-300",onClick:e[0]||(e[0]=a=>O.value=!i(O))},p(i(O)?"Collapse":"Show"),1)):_("",!0)]),!s.collapsible||i(O)?(n(!0),d(w,{key:0},k(s.items,a=>(n(),d("div",{key:a.id,class:"flex items-start gap-3 bg-slate-900 border border-slate-800 rounded-xl px-3 py-3"},[o("div",{class:C(["w-1 self-stretch rounded-full shrink-0 mt-0.5",L(a.priority)])},null,2),o("button",{class:C(["mt-0.5 shrink-0 w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors",a.is_done?"border-green-500 bg-green-500":"border-slate-600 hover:border-slate-400"]),onClick:$=>R(a)},[a.is_done?(n(),j(m,{key:0,name:"i-heroicons-check",class:"w-3 h-3 text-white"})):a.is_recurring?(n(),j(m,{key:1,name:"i-heroicons-arrow-path",class:"w-2.5 h-2.5 text-slate-500"})):_("",!0)],10,fe),o("div",ge,[o("p",{class:C(["text-sm font-medium",a.is_done?"line-through text-slate-500":""])},p(a.title),3),a.description?(n(),d("p",ve,p(a.description),1)):_("",!0),o("div",ye,[a.due_date?(n(),d("span",{key:0,class:C(["text-xs flex items-center gap-0.5",P(a)?"text-red-400":"text-slate-400"])},[r(m,{name:"i-heroicons-calendar",class:"w-3 h-3"}),h(" "+p(q(a.due_date)),1)],2)):_("",!0),a.estimated_minutes?(n(),d("span",xe,[r(m,{name:"i-heroicons-clock",class:"w-3 h-3"}),h(" "+p(a.estimated_minutes)+"m ",1)])):_("",!0),a.is_recurring?(n(),d("span",be,[r(m,{name:"i-heroicons-arrow-path",class:"w-3 h-3"}),h(" "+p(a.recurrence_rule),1)])):_("",!0),a.show_in_bored?(n(),d("span",he,[r(m,{name:"i-heroicons-sparkles",class:"w-3 h-3"}),e[14]||(e[14]=h(" Bored ",-1))])):_("",!0)]),a.tags.length?(n(),d("div",we,[(n(!0),d(w,null,k(a.tags,$=>(n(),d("span",{key:$,class:"text-xs px-1.5 py-0.5 rounded bg-slate-800 text-slate-400"},p($),1))),128))])):_("",!0)]),o("div",ke,[r(u,{variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-pencil",onClick:$=>H(a)},null,8,["onClick"]),r(u,{variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-archive-box",onClick:$=>Y(a)},null,8,["onClick"])])]))),128)):_("",!0)]))),128)),i(A).length===0?(n(),d("div",Ce,[r(m,{name:"i-heroicons-check-circle",class:"w-12 h-12 mx-auto mb-3 opacity-30"}),e[15]||(e[15]=o("p",null,"No todos yet. Tap + to add one.",-1))])):_("",!0),i(x)?(n(),d("div",Te,[o("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e[1]||(e[1]=s=>x.value=!1)}),o("div",Ve,[o("h2",De,p(i(v)?"Edit TODO":"New TODO"),1),o("div",$e,[r(g,{label:"Title",required:""},{default:f(()=>[r(b,{modelValue:i(l).title,"onUpdate:modelValue":e[2]||(e[2]=s=>i(l).title=s),placeholder:"What needs doing?",class:"w-full",autofocus:""},null,8,["modelValue"])]),_:1}),r(g,{label:"Description"},{default:f(()=>[r(K,{modelValue:i(l).description,"onUpdate:modelValue":e[3]||(e[3]=s=>i(l).description=s),placeholder:"Optional details",class:"w-full"},null,8,["modelValue"])]),_:1}),r(g,{label:"Due date"},{default:f(()=>[r(b,{modelValue:i(l).due_date,"onUpdate:modelValue":e[4]||(e[4]=s=>i(l).due_date=s),type:"date",class:"w-full"},null,8,["modelValue"])]),_:1}),r(g,{label:"Priority"},{default:f(()=>[o("div",Ue,[(n(),d(w,null,k([["high","High","bg-red-600"],["medium","Medium","bg-amber-600"],["low","Low","bg-slate-600"]],s=>o("button",{key:s[0],class:C(["flex-1 py-1.5 rounded-lg text-sm font-medium transition-colors",i(l).priority===s[0]?s[2]+" text-white":"bg-slate-800 text-slate-300"]),onClick:a=>i(l).priority=s[0]},p(s[1]),11,Oe)),64))])]),_:1}),r(g,{label:"Estimated minutes"},{default:f(()=>[r(b,{modelValue:i(l).estimated_minutes,"onUpdate:modelValue":e[5]||(e[5]=s=>i(l).estimated_minutes=s),type:"number",min:"1",placeholder:"e.g. 30",class:"w-full"},null,8,["modelValue"])]),_:1}),o("div",Se,[e[16]||(e[16]=o("span",{class:"text-sm"},"Recurring",-1)),r(E,{modelValue:i(l).is_recurring,"onUpdate:modelValue":e[6]||(e[6]=s=>i(l).is_recurring=s)},null,8,["modelValue"])]),i(l).is_recurring?(n(),d("div",je,[r(g,{label:"Recurrence"},{default:f(()=>[o("div",Be,[(n(),d(w,null,k(["daily","weekly","monthly"],s=>o("button",{key:s,class:C(["flex-1 py-1.5 rounded-lg text-sm font-medium capitalize transition-colors",i(l).recurrence_rule===s?"bg-primary-600 text-white":"bg-slate-800 text-slate-300"]),onClick:a=>i(l).recurrence_rule=s},p(s),11,Ne)),64))])]),_:1})])):_("",!0),r(g,{label:"Tags (comma-separated)"},{default:f(()=>[r(b,{modelValue:i(l).tags,"onUpdate:modelValue":e[7]||(e[7]=s=>i(l).tags=s),placeholder:"tag1, tag2",class:"w-full"},null,8,["modelValue"])]),_:1}),o("div",ze,[e[17]||(e[17]=o("span",{class:"text-sm"},"Show in Bored mode",-1)),r(E,{modelValue:i(l).show_in_bored,"onUpdate:modelValue":e[8]||(e[8]=s=>i(l).show_in_bored=s)},null,8,["modelValue"])]),i(l).show_in_bored&&i(S).length?(n(),d("div",Ie,[r(g,{label:"Bored category (optional)"},{default:f(()=>[te(o("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>i(l).bored_category_id=s),class:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm text-slate-100"},[e[18]||(e[18]=o("option",{value:""},"None",-1)),(n(!0),d(w,null,k(i(S),s=>(n(),d("option",{key:s.id,value:s.id},p(s.name),9,Me))),128))],512),[[se,i(l).bored_category_id]])]),_:1})])):_("",!0)]),o("div",Ae,[r(u,{variant:"soft",color:"neutral",class:"flex-1",onClick:e[10]||(e[10]=s=>x.value=!1)},{default:f(()=>[...e[19]||(e[19]=[h("Cancel",-1)])]),_:1}),i(v)?(n(),j(u,{key:0,variant:"ghost",color:"error",class:"flex-none",icon:"i-heroicons-trash",onClick:e[11]||(e[11]=s=>{J(i(v)),x.value=!1})})):_("",!0),r(u,{color:"primary",class:"flex-1",onClick:W},{default:f(()=>[...e[20]||(e[20]=[h("Save",-1)])]),_:1})])])])):_("",!0)])}}});export{Ge as default};
