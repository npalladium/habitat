import{e as Z,g as ee,o as n,c as d,a as i,b as r,w as f,d as h,j as te,F as w,r as k,n as C,i as a,t as p,p as _,m as B,l as se,q as le,G as ae,y as V,z as ie,x as D,A as oe}from"./O9JIA0ss.js";import{_ as ne}from"./nd7kv66y.js";import{_ as re}from"./B4YtyPT5.js";import{_ as de}from"./lDetNp4R.js";import{_ as ue}from"./BZt495mH.js";const ce={class:"max-w-lg mx-auto space-y-5"},me={class:"flex items-center justify-between"},_e={class:"flex gap-2"},pe=["onClick"],fe={class:"flex items-center justify-between"},ge={class:"text-xs font-semibold uppercase tracking-wider text-slate-500"},ve=["onClick"],ye={class:"flex-1 min-w-0"},xe={key:0,class:"text-xs text-slate-500 mt-0.5 truncate"},be={class:"flex flex-wrap items-center gap-x-2 gap-y-1 mt-1.5"},he={key:1,class:"text-xs text-slate-500 flex items-center gap-0.5"},we={key:2,class:"text-xs text-slate-500 flex items-center gap-0.5"},ke={key:3,class:"text-xs text-amber-500 flex items-center gap-0.5"},Ce={key:1,class:"flex flex-wrap gap-1 mt-1.5"},Te={class:"flex flex-col gap-1 shrink-0"},Ve={key:0,class:"text-center py-12 text-slate-500"},De={key:1,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},$e={class:"relative w-full sm:max-w-md bg-slate-900 border border-slate-800 rounded-t-3xl sm:rounded-2xl p-5 space-y-4 max-h-[90vh] overflow-y-auto"},Se={class:"text-lg font-semibold"},Ue={class:"space-y-3"},Oe={class:"flex gap-2"},je=["onClick"],Be={class:"flex items-center justify-between"},Ne={key:0},Me={class:"flex gap-2"},ze=["onClick"],Ae={class:"flex items-center justify-between"},Fe={key:1},Ie=["value"],Ee={class:"flex gap-2 pt-1"},He=Z({__name:"todos",setup(Le){const y=oe(),c=V([]),O=V([]),S=V("all"),x=V(!1),v=V(null),U=V(!1),l=ie({title:"",description:"",due_date:"",priority:"medium",estimated_minutes:"",is_recurring:!1,recurrence_rule:"daily",show_in_bored:!1,bored_category_id:"",tags:""});async function L(){[c.value,O.value]=await Promise.all([y.getTodos(),y.getBoredCategories()])}ee(L);const j=new Date,T=`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}-${String(j.getDate()).padStart(2,"0")}`,N=D(()=>c.value.filter(e=>!e.is_done&&!e.archived_at&&e.due_date&&e.due_date<T)),M=D(()=>c.value.filter(e=>!e.is_done&&!e.archived_at&&e.due_date===T)),z=D(()=>{const e=new Date;e.setDate(e.getDate()+30);const t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;return c.value.filter(u=>!u.is_done&&!u.archived_at&&u.due_date&&u.due_date>T&&u.due_date<=t)}),A=D(()=>c.value.filter(e=>!e.is_done&&!e.archived_at&&!e.due_date)),F=D(()=>c.value.filter(e=>e.is_done&&!e.archived_at).sort((e,t)=>(t.done_at??t.updated_at).localeCompare(e.done_at??e.updated_at)).slice(0,20)),I=D(()=>S.value==="done"?[{label:"Done",items:F.value,key:"done"}]:S.value==="active"?[{label:"ðŸ”´ Overdue",items:N.value,key:"overdue"},{label:"ðŸ“… Today",items:M.value,key:"today"},{label:"ðŸ“‹ Upcoming",items:z.value,key:"upcoming"},{label:"ðŸ“Œ No date",items:A.value,key:"nodate"}].filter(e=>e.items.length>0):[{label:"ðŸ”´ Overdue",items:N.value,key:"overdue"},{label:"ðŸ“… Today",items:M.value,key:"today"},{label:"ðŸ“‹ Upcoming",items:z.value,key:"upcoming"},{label:"ðŸ“Œ No date",items:A.value,key:"nodate"},{label:"âœ“ Done",items:F.value,key:"done",collapsible:!0}].filter(e=>e.items.length>0));function Y(e){return e==="high"?"bg-red-500":e==="low"?"bg-slate-600":"bg-amber-500"}function q(e){if(e===T)return"Today";const t=Math.round((new Date(e).getTime()-new Date(T).getTime())/864e5);return t===1?"Tomorrow":t===-1?"Yesterday":t<0?`${Math.abs(t)}d ago`:t<7?`in ${t}d`:new Date(e+"T00:00:00").toLocaleDateString(void 0,{month:"short",day:"numeric"})}function P(e){return!e.is_done&&e.due_date&&e.due_date<T}async function R(e){const t=await y.toggleTodo(e.id),u=c.value.findIndex(m=>m.id===e.id);u!==-1&&(c.value[u]=t)}function G(){v.value=null,Object.assign(l,{title:"",description:"",due_date:"",priority:"medium",estimated_minutes:"",is_recurring:!1,recurrence_rule:"daily",show_in_bored:!1,bored_category_id:"",tags:""}),x.value=!0}function H(e){v.value=e,Object.assign(l,{title:e.title,description:e.description,due_date:e.due_date??"",priority:e.priority,estimated_minutes:e.estimated_minutes??"",is_recurring:e.is_recurring,recurrence_rule:e.recurrence_rule??"daily",show_in_bored:e.show_in_bored,bored_category_id:e.bored_category_id??"",tags:e.tags.join(", ")}),x.value=!0}async function W(){if(!l.title.trim())return;const e=l.estimated_minutes!==""?Number(l.estimated_minutes):null,t=l.tags.split(",").map(m=>m.trim()).filter(Boolean),u={title:l.title.trim(),description:l.description.trim(),due_date:l.due_date||null,priority:l.priority,estimated_minutes:e,is_recurring:l.is_recurring,recurrence_rule:l.is_recurring?l.recurrence_rule:null,show_in_bored:l.show_in_bored,bored_category_id:l.show_in_bored&&l.bored_category_id?l.bored_category_id:null,tags:t,annotations:{}};if(v.value){const m=await y.updateTodo({id:v.value.id,...u}),b=c.value.findIndex(g=>g.id===v.value.id);b!==-1&&(c.value[b]=m)}else{const m=await y.createTodo(u);c.value.push(m)}x.value=!1}async function J(e){await y.archiveTodo(e.id),c.value=c.value.filter(t=>t.id!==e.id)}async function K(e){await y.deleteTodo(e.id),c.value=c.value.filter(t=>t.id!==e.id)}async function Q(e){await K(e),x.value=!1}return(e,t)=>{const u=te,m=se,b=ne,g=re,X=de,E=ue;return n(),d("div",ce,[i("div",me,[t[13]||(t[13]=i("h1",{class:"text-2xl font-bold"},"TODOs",-1)),r(u,{size:"sm",icon:"i-heroicons-plus",onClick:G},{default:f(()=>[...t[12]||(t[12]=[h("Add",-1)])]),_:1})]),i("div",_e,[(n(),d(w,null,k([["all","All"],["active","Active"],["done","Done"]],s=>i("button",{key:s[0],class:C(["px-3 py-1 rounded-full text-sm font-medium transition-colors",a(S)===s[0]?"bg-primary-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"]),onClick:o=>S.value=s[0]},p(s[1]),11,pe)),64))]),(n(!0),d(w,null,k(a(I),s=>(n(),d("div",{key:s.key,class:"space-y-2"},[i("div",fe,[i("p",ge,p(s.label),1),s.collapsible?(n(),d("button",{key:0,class:"text-xs text-slate-500 hover:text-slate-300",onClick:t[0]||(t[0]=o=>U.value=!a(U))},p(a(U)?"Collapse":"Show"),1)):_("",!0)]),!s.collapsible||a(U)?(n(!0),d(w,{key:0},k(s.items,o=>(n(),d("div",{key:o.id,class:"flex items-start gap-3 bg-slate-900 border border-slate-800 rounded-xl px-3 py-3"},[i("div",{class:C(["w-1 self-stretch rounded-full shrink-0 mt-0.5",Y(o.priority)])},null,2),i("button",{class:C(["mt-0.5 shrink-0 w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors",o.is_done?"border-green-500 bg-green-500":"border-slate-600 hover:border-slate-400"]),onClick:$=>R(o)},[o.is_done?(n(),B(m,{key:0,name:"i-heroicons-check",class:"w-3 h-3 text-white"})):o.is_recurring?(n(),B(m,{key:1,name:"i-heroicons-arrow-path",class:"w-2.5 h-2.5 text-slate-500"})):_("",!0)],10,ve),i("div",ye,[i("p",{class:C(["text-sm font-medium",o.is_done?"line-through text-slate-500":""])},p(o.title),3),o.description?(n(),d("p",xe,p(o.description),1)):_("",!0),i("div",be,[o.due_date?(n(),d("span",{key:0,class:C(["text-xs flex items-center gap-0.5",P(o)?"text-red-400":"text-slate-400"])},[r(m,{name:"i-heroicons-calendar",class:"w-3 h-3"}),h(" "+p(q(o.due_date)),1)],2)):_("",!0),o.estimated_minutes?(n(),d("span",he,[r(m,{name:"i-heroicons-clock",class:"w-3 h-3"}),h(" "+p(o.estimated_minutes)+"m ",1)])):_("",!0),o.is_recurring?(n(),d("span",we,[r(m,{name:"i-heroicons-arrow-path",class:"w-3 h-3"}),h(" "+p(o.recurrence_rule),1)])):_("",!0),o.show_in_bored?(n(),d("span",ke,[r(m,{name:"i-heroicons-sparkles",class:"w-3 h-3"}),t[14]||(t[14]=h(" Bored ",-1))])):_("",!0)]),o.tags.length?(n(),d("div",Ce,[(n(!0),d(w,null,k(o.tags,$=>(n(),d("span",{key:$,class:"text-xs px-1.5 py-0.5 rounded bg-slate-800 text-slate-400"},p($),1))),128))])):_("",!0)]),i("div",Te,[r(u,{variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-pencil",onClick:$=>H(o)},null,8,["onClick"]),r(u,{variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-archive-box",onClick:$=>J(o)},null,8,["onClick"])])]))),128)):_("",!0)]))),128)),a(I).length===0?(n(),d("div",Ve,[r(m,{name:"i-heroicons-check-circle",class:"w-12 h-12 mx-auto mb-3 opacity-30"}),t[15]||(t[15]=i("p",null,"No todos yet. Tap + to add one.",-1))])):_("",!0),a(x)?(n(),d("div",De,[i("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t[1]||(t[1]=s=>x.value=!1)}),i("div",$e,[i("h2",Se,p(a(v)?"Edit TODO":"New TODO"),1),i("div",Ue,[r(g,{label:"Title",required:""},{default:f(()=>[r(b,{modelValue:a(l).title,"onUpdate:modelValue":t[2]||(t[2]=s=>a(l).title=s),placeholder:"What needs doing?",class:"w-full",autofocus:""},null,8,["modelValue"])]),_:1}),r(g,{label:"Description"},{default:f(()=>[r(X,{modelValue:a(l).description,"onUpdate:modelValue":t[3]||(t[3]=s=>a(l).description=s),placeholder:"Optional details",class:"w-full"},null,8,["modelValue"])]),_:1}),r(g,{label:"Due date"},{default:f(()=>[r(b,{modelValue:a(l).due_date,"onUpdate:modelValue":t[4]||(t[4]=s=>a(l).due_date=s),type:"date",class:"w-full"},null,8,["modelValue"])]),_:1}),r(g,{label:"Priority"},{default:f(()=>[i("div",Oe,[(n(),d(w,null,k([["high","High","bg-red-600"],["medium","Medium","bg-amber-600"],["low","Low","bg-slate-600"]],s=>i("button",{key:s[0],class:C(["flex-1 py-1.5 rounded-lg text-sm font-medium transition-colors",a(l).priority===s[0]?s[2]+" text-white":"bg-slate-800 text-slate-300"]),onClick:o=>a(l).priority=s[0]},p(s[1]),11,je)),64))])]),_:1}),r(g,{label:"Estimated minutes"},{default:f(()=>[r(b,{modelValue:a(l).estimated_minutes,"onUpdate:modelValue":t[5]||(t[5]=s=>a(l).estimated_minutes=s),type:"number",min:"1",placeholder:"e.g. 30",class:"w-full"},null,8,["modelValue"])]),_:1}),i("div",Be,[t[16]||(t[16]=i("span",{class:"text-sm"},"Recurring",-1)),r(E,{modelValue:a(l).is_recurring,"onUpdate:modelValue":t[6]||(t[6]=s=>a(l).is_recurring=s)},null,8,["modelValue"])]),a(l).is_recurring?(n(),d("div",Ne,[r(g,{label:"Recurrence"},{default:f(()=>[i("div",Me,[(n(),d(w,null,k(["daily","weekly","monthly"],s=>i("button",{key:s,class:C(["flex-1 py-1.5 rounded-lg text-sm font-medium capitalize transition-colors",a(l).recurrence_rule===s?"bg-primary-600 text-white":"bg-slate-800 text-slate-300"]),onClick:o=>a(l).recurrence_rule=s},p(s),11,ze)),64))])]),_:1})])):_("",!0),r(g,{label:"Tags (comma-separated)"},{default:f(()=>[r(b,{modelValue:a(l).tags,"onUpdate:modelValue":t[7]||(t[7]=s=>a(l).tags=s),placeholder:"tag1, tag2",class:"w-full"},null,8,["modelValue"])]),_:1}),i("div",Ae,[t[17]||(t[17]=i("span",{class:"text-sm"},"Show in Bored mode",-1)),r(E,{modelValue:a(l).show_in_bored,"onUpdate:modelValue":t[8]||(t[8]=s=>a(l).show_in_bored=s)},null,8,["modelValue"])]),a(l).show_in_bored&&a(O).length?(n(),d("div",Fe,[r(g,{label:"Bored category (optional)"},{default:f(()=>[le(i("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>a(l).bored_category_id=s),class:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm text-slate-100"},[t[18]||(t[18]=i("option",{value:""},"None",-1)),(n(!0),d(w,null,k(a(O),s=>(n(),d("option",{key:s.id,value:s.id},p(s.name),9,Ie))),128))],512),[[ae,a(l).bored_category_id]])]),_:1})])):_("",!0)]),i("div",Ee,[r(u,{variant:"soft",color:"neutral",class:"flex-1",onClick:t[10]||(t[10]=s=>x.value=!1)},{default:f(()=>[...t[19]||(t[19]=[h("Cancel",-1)])]),_:1}),a(v)?(n(),B(u,{key:0,variant:"ghost",color:"error",class:"flex-none",icon:"i-heroicons-trash",onClick:t[11]||(t[11]=s=>Q(a(v)))})):_("",!0),r(u,{color:"primary",class:"flex-1",onClick:W},{default:f(()=>[...t[20]||(t[20]=[h("Save",-1)])]),_:1})])])])):_("",!0)])}}});export{He as default};
