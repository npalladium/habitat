async function xn(Xe={}){var me,u=Xe,Ue=!!globalThis.window,Ye=!!globalThis.WorkerGlobalScope;globalThis.process?.versions?.node&&globalThis.process?.type;var je="./this.program",Ze=import.meta.url,vt="";function Rt(e){return u.locateFile?u.locateFile(e,vt):vt+e}var tt,fe;if(Ue||Ye){try{vt=new URL(".",Ze).href}catch{}Ye&&(fe=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),tt=async e=>{var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)}}var te=console.log.bind(console),Me=console.error.bind(console),ze,lt=!1,ct,_t,$e,dt,Tt,Ne,Pe,Qe,Qt=!1;function Vt(){var e=ot.buffer;$e=new Int8Array(e),Tt=new Int16Array(e),dt=new Uint8Array(e),Ne=new Int32Array(e),Pe=new Uint32Array(e),Qe=new BigInt64Array(e),new BigUint64Array(e)}function ln(){if(u.wasmMemory)ot=u.wasmMemory;else{var e=u.INITIAL_MEMORY||8388608;ot=new WebAssembly.Memory({initial:e/65536,maximum:32768})}Vt()}function cn(){if(u.preRun)for(typeof u.preRun=="function"&&(u.preRun=[u.preRun]);u.preRun.length;)bn(u.preRun.shift());Xt($t)}function Gt(){Qt=!0,!u.noFSInit&&!l.initialized&&l.init(),xt.__wasm_call_ctors(),l.ignorePermissions=!1}function _n(){if(u.postRun)for(typeof u.postRun=="function"&&(u.postRun=[u.postRun]);u.postRun.length;)gn(u.postRun.shift());Xt(Jt)}function nt(e){u.onAbort?.(e),e="Aborted("+e+")",Me(e),lt=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw _t?.(t),t}var Dt;function un(){return u.locateFile?Rt("sqlite3.wasm"):new URL(""+new URL("sqlite3-DGXXSD5r.wasm",import.meta.url).href,import.meta.url).href}function fn(e){if(e==Dt&&ze)return new Uint8Array(ze);if(fe)return fe(e);throw"both async and sync fetching of the wasm failed"}async function dn(e){if(!ze)try{var t=await tt(e);return new Uint8Array(t)}catch{}return fn(e)}async function pn(e,t){try{var o=await dn(e);return await WebAssembly.instantiate(o,t)}catch(s){Me(`failed to asynchronously prepare wasm: ${s}`),nt(s)}}async function hn(e,t,o){if(!e)try{var s=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(s,o)}catch(n){Me(`wasm streaming compile failed: ${n}`),Me("falling back to ArrayBuffer instantiation")}return pn(t,o)}function mn(){return{env:Bn,wasi_snapshot_preview1:Bn}}async function Mt(){function e(s,n){return xt=s.exports,dr(xt),xt}function t(s){return e(s.instance)}var o=mn();return u.instantiateWasm?new Promise((s,n)=>{u.instantiateWasm(o,(i,r)=>{s(e(i))})}):(Dt??=un(),t(await hn(ze,Dt,o)))}var Xt=e=>{for(;e.length>0;)e.shift()(u)},Jt=[],gn=e=>Jt.push(e),$t=[],bn=e=>$t.push(e),ot,Fe={isAbs:e=>e.charAt(0)==="/",splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var o=0,s=e.length-1;s>=0;s--){var n=e[s];n==="."?e.splice(s,1):n===".."?(e.splice(s,1),o++):o&&(e.splice(s,1),o--)}if(t)for(;o;o--)e.unshift("..");return e},normalize:e=>{var t=Fe.isAbs(e),o=e.slice(-1)==="/";return e=Fe.normalizeArray(e.split("/").filter(s=>!!s),!t).join("/"),!e&&!t&&(e="."),e&&o&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=Fe.splitPath(e),o=t[0],s=t[1];return!o&&!s?".":(s&&(s=s.slice(0,-1)),o+s)},basename:e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],join:(...e)=>Fe.normalize(e.join("/")),join2:(e,t)=>Fe.normalize(e+"/"+t)},yn=()=>e=>crypto.getRandomValues(e),Kt=e=>{(Kt=yn())(e)},bt={resolve:(...e)=>{for(var t="",o=!1,s=e.length-1;s>=-1&&!o;s--){var n=s>=0?e[s]:l.cwd();if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";t=n+"/"+t,o=Fe.isAbs(n)}return t=Fe.normalizeArray(t.split("/").filter(i=>!!i),!o).join("/"),(o?"/":"")+t||"."},relative:(e,t)=>{e=bt.resolve(e).slice(1),t=bt.resolve(t).slice(1);function o(R){for(var Z=0;Z<R.length&&R[Z]==="";Z++);for(var D=R.length-1;D>=0&&R[D]==="";D--);return Z>D?[]:R.slice(Z,D-Z+1)}for(var s=o(e.split("/")),n=o(t.split("/")),i=Math.min(s.length,n.length),r=i,c=0;c<i;c++)if(s[c]!==n[c]){r=c;break}for(var P=[],c=r;c<s.length;c++)P.push("..");return P=P.concat(n.slice(r)),P.join("/")}},yt=new TextDecoder,At=(e,t,o,s)=>{for(var n=t+o;e[t]&&!(t>=n);)++t;return t},ut=(e,t=0,o,s)=>{var n=At(e,t,o);return yt.decode(e.buffer?e.subarray(t,n):new Uint8Array(e.slice(t,n)))},Et=[],Lt=e=>{for(var t=0,o=0;o<e.length;++o){var s=e.charCodeAt(o);s<=127?t++:s<=2047?t+=2:s>=55296&&s<=57343?(t+=4,++o):t+=3}return t},Yt=(e,t,o,s)=>{if(!(s>0))return 0;for(var n=o,i=o+s-1,r=0;r<e.length;++r){var c=e.codePointAt(r);if(c<=127){if(o>=i)break;t[o++]=c}else if(c<=2047){if(o+1>=i)break;t[o++]=192|c>>6,t[o++]=128|c&63}else if(c<=65535){if(o+2>=i)break;t[o++]=224|c>>12,t[o++]=128|c>>6&63,t[o++]=128|c&63}else{if(o+3>=i)break;t[o++]=240|c>>18,t[o++]=128|c>>12&63,t[o++]=128|c>>6&63,t[o++]=128|c&63,r++}}return t[o]=0,o-n},Ut=(e,t,o)=>{var s=Lt(e)+1,n=new Array(s),i=Yt(e,n,0,n.length);return n.length=i,n},En=()=>{if(!Et.length){var e=null;if(globalThis.window?.prompt&&(e=window.prompt("Input: "),e!==null&&(e+=`
`)),!e)return null;Et=Ut(e)}return Et.shift()},ft={ttys:[],init(){},shutdown(){},register(e,t){ft.ttys[e]={input:[],output:[],ops:t},l.registerDevice(e,ft.stream_ops)},stream_ops:{open(e){var t=ft.ttys[e.node.rdev];if(!t)throw new l.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,o,s,n){if(!e.tty||!e.tty.ops.get_char)throw new l.ErrnoError(60);for(var i=0,r=0;r<s;r++){var c;try{c=e.tty.ops.get_char(e.tty)}catch{throw new l.ErrnoError(29)}if(c===void 0&&i===0)throw new l.ErrnoError(6);if(c==null)break;i++,t[o+r]=c}return i&&(e.node.atime=Date.now()),i},write(e,t,o,s,n){if(!e.tty||!e.tty.ops.put_char)throw new l.ErrnoError(60);try{for(var i=0;i<s;i++)e.tty.ops.put_char(e.tty,t[o+i])}catch{throw new l.ErrnoError(29)}return s&&(e.node.mtime=e.node.ctime=Date.now()),i}},default_tty_ops:{get_char(e){return En()},put_char(e,t){t===null||t===10?(te(ut(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(te(ut(e.output)),e.output=[])},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,t,o){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,t){t===null||t===10?(Me(ut(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(Me(ut(e.output)),e.output=[])}}},Nt=(e,t)=>dt.fill(0,e,e+t),Zt=(e,t)=>Math.ceil(e/t)*t,en=e=>{e=Zt(e,65536);var t=jn(65536,e);return t&&Nt(t,e),t},Ae={ops_table:null,mount(e){return Ae.createNode(null,"/",16895,0)},createNode(e,t,o,s){if(l.isBlkdev(o)||l.isFIFO(o))throw new l.ErrnoError(63);Ae.ops_table||={dir:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr,lookup:Ae.node_ops.lookup,mknod:Ae.node_ops.mknod,rename:Ae.node_ops.rename,unlink:Ae.node_ops.unlink,rmdir:Ae.node_ops.rmdir,readdir:Ae.node_ops.readdir,symlink:Ae.node_ops.symlink},stream:{llseek:Ae.stream_ops.llseek}},file:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr},stream:{llseek:Ae.stream_ops.llseek,read:Ae.stream_ops.read,write:Ae.stream_ops.write,mmap:Ae.stream_ops.mmap,msync:Ae.stream_ops.msync}},link:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr,readlink:Ae.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Ae.node_ops.getattr,setattr:Ae.node_ops.setattr},stream:l.chrdev_stream_ops}};var n=l.createNode(e,t,o,s);return l.isDir(n.mode)?(n.node_ops=Ae.ops_table.dir.node,n.stream_ops=Ae.ops_table.dir.stream,n.contents={}):l.isFile(n.mode)?(n.node_ops=Ae.ops_table.file.node,n.stream_ops=Ae.ops_table.file.stream,n.usedBytes=0,n.contents=null):l.isLink(n.mode)?(n.node_ops=Ae.ops_table.link.node,n.stream_ops=Ae.ops_table.link.stream):l.isChrdev(n.mode)&&(n.node_ops=Ae.ops_table.chrdev.node,n.stream_ops=Ae.ops_table.chrdev.stream),n.atime=n.mtime=n.ctime=Date.now(),e&&(e.contents[t]=n,e.atime=e.mtime=e.ctime=n.atime),n},getFileDataAsTypedArray(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage(e,t){var o=e.contents?e.contents.length:0;if(!(o>=t)){t=Math.max(t,o*(o<1024*1024?2:1.125)>>>0),o!=0&&(t=Math.max(t,256));var s=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(s.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(t==0)e.contents=null,e.usedBytes=0;else{var o=e.contents;e.contents=new Uint8Array(t),o&&e.contents.set(o.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=l.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,l.isDir(e.mode)?t.size=4096:l.isFile(e.mode)?t.size=e.usedBytes:l.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.atime),t.mtime=new Date(e.mtime),t.ctime=new Date(e.ctime),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){for(const o of["mode","atime","mtime","ctime"])t[o]!=null&&(e[o]=t[o]);t.size!==void 0&&Ae.resizeFileStorage(e,t.size)},lookup(e,t){throw Ae.doesNotExistError||(Ae.doesNotExistError=new l.ErrnoError(44),Ae.doesNotExistError.stack="<generic error, no stack>"),Ae.doesNotExistError},mknod(e,t,o,s){return Ae.createNode(e,t,o,s)},rename(e,t,o){var s;try{s=l.lookupNode(t,o)}catch{}if(s){if(l.isDir(e.mode))for(var n in s.contents)throw new l.ErrnoError(55);l.hashRemoveNode(s)}delete e.parent.contents[e.name],t.contents[o]=e,e.name=o,t.ctime=t.mtime=e.parent.ctime=e.parent.mtime=Date.now()},unlink(e,t){delete e.contents[t],e.ctime=e.mtime=Date.now()},rmdir(e,t){for(var o in l.lookupNode(e,t).contents)throw new l.ErrnoError(55);delete e.contents[t],e.ctime=e.mtime=Date.now()},readdir(e){return[".","..",...Object.keys(e.contents)]},symlink(e,t,o){var s=Ae.createNode(e,t,41471,0);return s.link=o,s},readlink(e){if(!l.isLink(e.mode))throw new l.ErrnoError(28);return e.link}},stream_ops:{read(e,t,o,s,n){var i=e.node.contents;if(n>=e.node.usedBytes)return 0;var r=Math.min(e.node.usedBytes-n,s);if(r>8&&i.subarray)t.set(i.subarray(n,n+r),o);else for(var c=0;c<r;c++)t[o+c]=i[n+c];return r},write(e,t,o,s,n,i){if(t.buffer===$e.buffer&&(i=!1),!s)return 0;var r=e.node;if(r.mtime=r.ctime=Date.now(),t.subarray&&(!r.contents||r.contents.subarray)){if(i)return r.contents=t.subarray(o,o+s),r.usedBytes=s,s;if(r.usedBytes===0&&n===0)return r.contents=t.slice(o,o+s),r.usedBytes=s,s;if(n+s<=r.usedBytes)return r.contents.set(t.subarray(o,o+s),n),s}if(Ae.expandFileStorage(r,n+s),r.contents.subarray&&t.subarray)r.contents.set(t.subarray(o,o+s),n);else for(var c=0;c<s;c++)r.contents[n+c]=t[o+c];return r.usedBytes=Math.max(r.usedBytes,n+s),s},llseek(e,t,o){var s=t;if(o===1?s+=e.position:o===2&&l.isFile(e.node.mode)&&(s+=e.node.usedBytes),s<0)throw new l.ErrnoError(28);return s},mmap(e,t,o,s,n){if(!l.isFile(e.node.mode))throw new l.ErrnoError(43);var i,r,c=e.node.contents;if(!(n&2)&&c&&c.buffer===$e.buffer)r=!1,i=c.byteOffset;else{if(r=!0,i=en(t),!i)throw new l.ErrnoError(48);c&&((o>0||o+t<c.length)&&(c.subarray?c=c.subarray(o,o+t):c=Array.prototype.slice.call(c,o,o+t)),$e.set(c,i))}return{ptr:i,allocated:r}},msync(e,t,o,s,n){return Ae.stream_ops.write(e,t,0,s,o,!1),0}}},Ft=e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(typeof t>"u")throw new Error(`Unknown file open mode: ${e}`);return t},jt=(e,t)=>{var o=0;return e&&(o|=365),t&&(o|=146),o},qn=async e=>{var t=await tt(e);return new Uint8Array(t)},Sn=(...e)=>l.createDataFile(...e),pt=0,It=null,Ct=e=>{if(pt--,u.monitorRunDependencies?.(pt),pt==0&&It){var t=It;It=null,t()}},tn=e=>{pt++,u.monitorRunDependencies?.(pt)},nn=[],vn=async(e,t)=>{typeof Browser<"u"&&Browser.init();for(var o of nn)if(o.canHandle(t))return o.handle(e,t);return e},rn=async(e,t,o,s,n,i,r,c)=>{var P=t?bt.resolve(Fe.join2(e,t)):e;tn();try{var R=o;typeof o=="string"&&(R=await qn(o)),R=await vn(R,P),c?.(),i||Sn(e,t,R,s,n,r)}finally{Ct()}},Bt=(e,t,o,s,n,i,r,c,P,R)=>{rn(e,t,o,s,n,c,P,R).then(i).catch(r)},l={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{name="ErrnoError";constructor(e){this.errno=e}},FSStream:class{shared={};get object(){return this.node}set object(e){this.node=e}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{node_ops={};stream_ops={};readMode=365;writeMode=146;mounted=null;constructor(e,t,o,s){e||(e=this),this.parent=e,this.mount=e.mount,this.id=l.nextInode++,this.name=t,this.mode=o,this.rdev=s,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return l.isDir(this.mode)}get isDevice(){return l.isChrdev(this.mode)}},lookupPath(e,t={}){if(!e)throw new l.ErrnoError(44);t.follow_mount??=!0,Fe.isAbs(e)||(e=l.cwd()+"/"+e);e:for(var o=0;o<40;o++){for(var s=e.split("/").filter(R=>!!R),n=l.root,i="/",r=0;r<s.length;r++){var c=r===s.length-1;if(c&&t.parent)break;if(s[r]!=="."){if(s[r]===".."){if(i=Fe.dirname(i),l.isRoot(n)){e=i+"/"+s.slice(r+1).join("/"),o--;continue e}else n=n.parent;continue}i=Fe.join2(i,s[r]);try{n=l.lookupNode(n,s[r])}catch(R){if(R?.errno===44&&c&&t.noent_okay)return{path:i};throw R}if(l.isMountpoint(n)&&(!c||t.follow_mount)&&(n=n.mounted.root),l.isLink(n.mode)&&(!c||t.follow)){if(!n.node_ops.readlink)throw new l.ErrnoError(52);var P=n.node_ops.readlink(n);Fe.isAbs(P)||(P=Fe.dirname(i)+"/"+P),e=P+"/"+s.slice(r+1).join("/");continue e}}}return{path:i,node:n}}throw new l.ErrnoError(32)},getPath(e){for(var t;;){if(l.isRoot(e)){var o=e.mount.mountpoint;return t?o[o.length-1]!=="/"?`${o}/${t}`:o+t:o}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var o=0,s=0;s<t.length;s++)o=(o<<5)-o+t.charCodeAt(s)|0;return(e+o>>>0)%l.nameTable.length},hashAddNode(e){var t=l.hashName(e.parent.id,e.name);e.name_next=l.nameTable[t],l.nameTable[t]=e},hashRemoveNode(e){var t=l.hashName(e.parent.id,e.name);if(l.nameTable[t]===e)l.nameTable[t]=e.name_next;else for(var o=l.nameTable[t];o;){if(o.name_next===e){o.name_next=e.name_next;break}o=o.name_next}},lookupNode(e,t){var o=l.mayLookup(e);if(o)throw new l.ErrnoError(o);for(var s=l.hashName(e.id,t),n=l.nameTable[s];n;n=n.name_next){var i=n.name;if(n.parent.id===e.id&&i===t)return n}return l.lookup(e,t)},createNode(e,t,o,s){var n=new l.FSNode(e,t,o,s);return l.hashAddNode(n),n},destroyNode(e){l.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return(e&61440)===32768},isDir(e){return(e&61440)===16384},isLink(e){return(e&61440)===40960},isChrdev(e){return(e&61440)===8192},isBlkdev(e){return(e&61440)===24576},isFIFO(e){return(e&61440)===4096},isSocket(e){return(e&49152)===49152},flagsToPermissionString(e){var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},nodePermissions(e,t){return l.ignorePermissions?0:t.includes("r")&&!(e.mode&292)||t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73)?2:0},mayLookup(e){if(!l.isDir(e.mode))return 54;var t=l.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){if(!l.isDir(e.mode))return 54;try{return l.lookupNode(e,t),20}catch{}return l.nodePermissions(e,"wx")},mayDelete(e,t,o){var s;try{s=l.lookupNode(e,t)}catch(i){return i.errno}var n=l.nodePermissions(e,"wx");if(n)return n;if(o){if(!l.isDir(s.mode))return 54;if(l.isRoot(s)||l.getPath(s)===l.cwd())return 10}else if(l.isDir(s.mode))return 31;return 0},mayOpen(e,t){return e?l.isLink(e.mode)?32:l.isDir(e.mode)&&(l.flagsToPermissionString(t)!=="r"||t&576)?31:l.nodePermissions(e,l.flagsToPermissionString(t)):44},checkOpExists(e,t){if(!e)throw new l.ErrnoError(t);return e},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=l.MAX_OPEN_FDS;e++)if(!l.streams[e])return e;throw new l.ErrnoError(33)},getStreamChecked(e){var t=l.getStream(e);if(!t)throw new l.ErrnoError(8);return t},getStream:e=>l.streams[e],createStream(e,t=-1){return e=Object.assign(new l.FSStream,e),t==-1&&(t=l.nextfd()),e.fd=t,l.streams[t]=e,e},closeStream(e){l.streams[e]=null},dupStream(e,t=-1){var o=l.createStream(e,t);return o.stream_ops?.dup?.(o),o},doSetAttr(e,t,o){var s=e?.stream_ops.setattr,n=s?e:t;s??=t.node_ops.setattr,l.checkOpExists(s,63),s(n,o)},chrdev_stream_ops:{open(e){e.stream_ops=l.getDevice(e.node.rdev).stream_ops,e.stream_ops.open?.(e)},llseek(){throw new l.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,t)=>e<<8|t,registerDevice(e,t){l.devices[e]={stream_ops:t}},getDevice:e=>l.devices[e],getMounts(e){for(var t=[],o=[e];o.length;){var s=o.pop();t.push(s),o.push(...s.mounts)}return t},syncfs(e,t){typeof e=="function"&&(t=e,e=!1),l.syncFSRequests++,l.syncFSRequests>1&&Me(`warning: ${l.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var o=l.getMounts(l.root.mount),s=0;function n(c){return l.syncFSRequests--,t(c)}function i(c){if(c)return i.errored?void 0:(i.errored=!0,n(c));++s>=o.length&&n(null)}for(var r of o)r.type.syncfs?r.type.syncfs(r,e,i):i(null)},mount(e,t,o){var s=o==="/",n=!o,i;if(s&&l.root)throw new l.ErrnoError(10);if(!s&&!n){var r=l.lookupPath(o,{follow_mount:!1});if(o=r.path,i=r.node,l.isMountpoint(i))throw new l.ErrnoError(10);if(!l.isDir(i.mode))throw new l.ErrnoError(54)}var c={type:e,opts:t,mountpoint:o,mounts:[]},P=e.mount(c);return P.mount=c,c.root=P,s?l.root=P:i&&(i.mounted=c,i.mount&&i.mount.mounts.push(c)),P},unmount(e){var t=l.lookupPath(e,{follow_mount:!1});if(!l.isMountpoint(t.node))throw new l.ErrnoError(28);var o=t.node,s=o.mounted,n=l.getMounts(s);for(var[i,r]of Object.entries(l.nameTable))for(;r;){var c=r.name_next;n.includes(r.mount)&&l.destroyNode(r),r=c}o.mounted=null;var P=o.mount.mounts.indexOf(s);o.mount.mounts.splice(P,1)},lookup(e,t){return e.node_ops.lookup(e,t)},mknod(e,t,o){var s=l.lookupPath(e,{parent:!0}).node,n=Fe.basename(e);if(!n)throw new l.ErrnoError(28);if(n==="."||n==="..")throw new l.ErrnoError(20);var i=l.mayCreate(s,n);if(i)throw new l.ErrnoError(i);if(!s.node_ops.mknod)throw new l.ErrnoError(63);return s.node_ops.mknod(s,n,t,o)},statfs(e){return l.statfsNode(l.lookupPath(e,{follow:!0}).node)},statfsStream(e){return l.statfsNode(e.node)},statfsNode(e){var t={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:l.nextInode,ffree:l.nextInode-1,fsid:42,flags:2,namelen:255};return e.node_ops.statfs&&Object.assign(t,e.node_ops.statfs(e.mount.opts.root)),t},create(e,t=438){return t&=4095,t|=32768,l.mknod(e,t,0)},mkdir(e,t=511){return t&=1023,t|=16384,l.mknod(e,t,0)},mkdirTree(e,t){var o=e.split("/"),s="";for(var n of o)if(n){(s||Fe.isAbs(e))&&(s+="/"),s+=n;try{l.mkdir(s,t)}catch(i){if(i.errno!=20)throw i}}},mkdev(e,t,o){return typeof o>"u"&&(o=t,t=438),t|=8192,l.mknod(e,t,o)},symlink(e,t){if(!bt.resolve(e))throw new l.ErrnoError(44);var o=l.lookupPath(t,{parent:!0}).node;if(!o)throw new l.ErrnoError(44);var s=Fe.basename(t),n=l.mayCreate(o,s);if(n)throw new l.ErrnoError(n);if(!o.node_ops.symlink)throw new l.ErrnoError(63);return o.node_ops.symlink(o,s,e)},rename(e,t){var o=Fe.dirname(e),s=Fe.dirname(t),n=Fe.basename(e),i=Fe.basename(t),r=l.lookupPath(e,{parent:!0}),c=r.node,P;if(r=l.lookupPath(t,{parent:!0}),P=r.node,!c||!P)throw new l.ErrnoError(44);if(c.mount!==P.mount)throw new l.ErrnoError(75);var R=l.lookupNode(c,n),Z=bt.relative(e,s);if(Z.charAt(0)!==".")throw new l.ErrnoError(28);if(Z=bt.relative(t,o),Z.charAt(0)!==".")throw new l.ErrnoError(55);var D;try{D=l.lookupNode(P,i)}catch{}if(R!==D){var $=l.isDir(R.mode),m=l.mayDelete(c,n,$);if(m)throw new l.ErrnoError(m);if(m=D?l.mayDelete(P,i,$):l.mayCreate(P,i),m)throw new l.ErrnoError(m);if(!c.node_ops.rename)throw new l.ErrnoError(63);if(l.isMountpoint(R)||D&&l.isMountpoint(D))throw new l.ErrnoError(10);if(P!==c&&(m=l.nodePermissions(c,"w"),m))throw new l.ErrnoError(m);l.hashRemoveNode(R);try{c.node_ops.rename(R,P,i),R.parent=P}catch(W){throw W}finally{l.hashAddNode(R)}}},rmdir(e){var t=l.lookupPath(e,{parent:!0}).node,o=Fe.basename(e),s=l.lookupNode(t,o),n=l.mayDelete(t,o,!0);if(n)throw new l.ErrnoError(n);if(!t.node_ops.rmdir)throw new l.ErrnoError(63);if(l.isMountpoint(s))throw new l.ErrnoError(10);t.node_ops.rmdir(t,o),l.destroyNode(s)},readdir(e){var t=l.lookupPath(e,{follow:!0}).node;return l.checkOpExists(t.node_ops.readdir,54)(t)},unlink(e){var t=l.lookupPath(e,{parent:!0}).node;if(!t)throw new l.ErrnoError(44);var o=Fe.basename(e),s=l.lookupNode(t,o),n=l.mayDelete(t,o,!1);if(n)throw new l.ErrnoError(n);if(!t.node_ops.unlink)throw new l.ErrnoError(63);if(l.isMountpoint(s))throw new l.ErrnoError(10);t.node_ops.unlink(t,o),l.destroyNode(s)},readlink(e){var t=l.lookupPath(e).node;if(!t)throw new l.ErrnoError(44);if(!t.node_ops.readlink)throw new l.ErrnoError(28);return t.node_ops.readlink(t)},stat(e,t){var o=l.lookupPath(e,{follow:!t}).node;return l.checkOpExists(o.node_ops.getattr,63)(o)},fstat(e){var t=l.getStreamChecked(e),o=t.node,s=t.stream_ops.getattr,n=s?t:o;return s??=o.node_ops.getattr,l.checkOpExists(s,63),s(n)},lstat(e){return l.stat(e,!0)},doChmod(e,t,o,s){l.doSetAttr(e,t,{mode:o&4095|t.mode&-4096,ctime:Date.now(),dontFollow:s})},chmod(e,t,o){var s;typeof e=="string"?s=l.lookupPath(e,{follow:!o}).node:s=e,l.doChmod(null,s,t,o)},lchmod(e,t){l.chmod(e,t,!0)},fchmod(e,t){var o=l.getStreamChecked(e);l.doChmod(o,o.node,t,!1)},doChown(e,t,o){l.doSetAttr(e,t,{timestamp:Date.now(),dontFollow:o})},chown(e,t,o,s){var n;typeof e=="string"?n=l.lookupPath(e,{follow:!s}).node:n=e,l.doChown(null,n,s)},lchown(e,t,o){l.chown(e,t,o,!0)},fchown(e,t,o){var s=l.getStreamChecked(e);l.doChown(s,s.node,!1)},doTruncate(e,t,o){if(l.isDir(t.mode))throw new l.ErrnoError(31);if(!l.isFile(t.mode))throw new l.ErrnoError(28);var s=l.nodePermissions(t,"w");if(s)throw new l.ErrnoError(s);l.doSetAttr(e,t,{size:o,timestamp:Date.now()})},truncate(e,t){if(t<0)throw new l.ErrnoError(28);var o;typeof e=="string"?o=l.lookupPath(e,{follow:!0}).node:o=e,l.doTruncate(null,o,t)},ftruncate(e,t){var o=l.getStreamChecked(e);if(t<0||(o.flags&2097155)===0)throw new l.ErrnoError(28);l.doTruncate(o,o.node,t)},utime(e,t,o){var s=l.lookupPath(e,{follow:!0}).node;l.checkOpExists(s.node_ops.setattr,63)(s,{atime:t,mtime:o})},open(e,t,o=438){if(e==="")throw new l.ErrnoError(44);t=typeof t=="string"?Ft(t):t,t&64?o=o&4095|32768:o=0;var s,n;if(typeof e=="object")s=e;else{n=e.endsWith("/");var i=l.lookupPath(e,{follow:!(t&131072),noent_okay:!0});s=i.node,e=i.path}var r=!1;if(t&64)if(s){if(t&128)throw new l.ErrnoError(20)}else{if(n)throw new l.ErrnoError(31);s=l.mknod(e,o|511,0),r=!0}if(!s)throw new l.ErrnoError(44);if(l.isChrdev(s.mode)&&(t&=-513),t&65536&&!l.isDir(s.mode))throw new l.ErrnoError(54);if(!r){var c=l.mayOpen(s,t);if(c)throw new l.ErrnoError(c)}t&512&&!r&&l.truncate(s,0),t&=-131713;var P=l.createStream({node:s,path:l.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1});return P.stream_ops.open&&P.stream_ops.open(P),r&&l.chmod(s,o&511),u.logReadFiles&&!(t&1)&&(e in l.readFiles||(l.readFiles[e]=1)),P},close(e){if(l.isClosed(e))throw new l.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{l.closeStream(e.fd)}e.fd=null},isClosed(e){return e.fd===null},llseek(e,t,o){if(l.isClosed(e))throw new l.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new l.ErrnoError(70);if(o!=0&&o!=1&&o!=2)throw new l.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,o),e.ungotten=[],e.position},read(e,t,o,s,n){if(s<0||n<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if((e.flags&2097155)===1)throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.read)throw new l.ErrnoError(28);var i=typeof n<"u";if(!i)n=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var r=e.stream_ops.read(e,t,o,s,n);return i||(e.position+=r),r},write(e,t,o,s,n,i){if(s<0||n<0)throw new l.ErrnoError(28);if(l.isClosed(e))throw new l.ErrnoError(8);if((e.flags&2097155)===0)throw new l.ErrnoError(8);if(l.isDir(e.node.mode))throw new l.ErrnoError(31);if(!e.stream_ops.write)throw new l.ErrnoError(28);e.seekable&&e.flags&1024&&l.llseek(e,0,2);var r=typeof n<"u";if(!r)n=e.position;else if(!e.seekable)throw new l.ErrnoError(70);var c=e.stream_ops.write(e,t,o,s,n,i);return r||(e.position+=c),c},mmap(e,t,o,s,n){if((s&2)!==0&&(n&2)===0&&(e.flags&2097155)!==2)throw new l.ErrnoError(2);if((e.flags&2097155)===1)throw new l.ErrnoError(2);if(!e.stream_ops.mmap)throw new l.ErrnoError(43);if(!t)throw new l.ErrnoError(28);return e.stream_ops.mmap(e,t,o,s,n)},msync(e,t,o,s,n){return e.stream_ops.msync?e.stream_ops.msync(e,t,o,s,n):0},ioctl(e,t,o){if(!e.stream_ops.ioctl)throw new l.ErrnoError(59);return e.stream_ops.ioctl(e,t,o)},readFile(e,t={}){t.flags=t.flags||0,t.encoding=t.encoding||"binary",t.encoding!=="utf8"&&t.encoding!=="binary"&&nt(`Invalid encoding type "${t.encoding}"`);var o=l.open(e,t.flags),s=l.stat(e).size,n=new Uint8Array(s);return l.read(o,n,0,s,0),t.encoding==="utf8"&&(n=ut(n)),l.close(o),n},writeFile(e,t,o={}){o.flags=o.flags||577;var s=l.open(e,o.flags,o.mode);typeof t=="string"&&(t=new Uint8Array(Ut(t))),ArrayBuffer.isView(t)?l.write(s,t,0,t.byteLength,void 0,o.canOwn):nt("Unsupported data type"),l.close(s)},cwd:()=>l.currentPath,chdir(e){var t=l.lookupPath(e,{follow:!0});if(t.node===null)throw new l.ErrnoError(44);if(!l.isDir(t.node.mode))throw new l.ErrnoError(54);var o=l.nodePermissions(t.node,"x");if(o)throw new l.ErrnoError(o);l.currentPath=t.path},createDefaultDirectories(){l.mkdir("/tmp"),l.mkdir("/home"),l.mkdir("/home/web_user")},createDefaultDevices(){l.mkdir("/dev"),l.registerDevice(l.makedev(1,3),{read:()=>0,write:(s,n,i,r,c)=>r,llseek:()=>0}),l.mkdev("/dev/null",l.makedev(1,3)),ft.register(l.makedev(5,0),ft.default_tty_ops),ft.register(l.makedev(6,0),ft.default_tty1_ops),l.mkdev("/dev/tty",l.makedev(5,0)),l.mkdev("/dev/tty1",l.makedev(6,0));var e=new Uint8Array(1024),t=0,o=()=>(t===0&&(Kt(e),t=e.byteLength),e[--t]);l.createDevice("/dev","random",o),l.createDevice("/dev","urandom",o),l.mkdir("/dev/shm"),l.mkdir("/dev/shm/tmp")},createSpecialDirectories(){l.mkdir("/proc");var e=l.mkdir("/proc/self");l.mkdir("/proc/self/fd"),l.mount({mount(){var t=l.createNode(e,"fd",16895,73);return t.stream_ops={llseek:Ae.stream_ops.llseek},t.node_ops={lookup(o,s){var n=+s,i=l.getStreamChecked(n),r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path},id:n+1};return r.parent=r,r},readdir(){return Array.from(l.streams.entries()).filter(([o,s])=>s).map(([o,s])=>o.toString())}},t}},{},"/proc/self/fd")},createStandardStreams(e,t,o){e?l.createDevice("/dev","stdin",e):l.symlink("/dev/tty","/dev/stdin"),t?l.createDevice("/dev","stdout",null,t):l.symlink("/dev/tty","/dev/stdout"),o?l.createDevice("/dev","stderr",null,o):l.symlink("/dev/tty1","/dev/stderr"),l.open("/dev/stdin",0),l.open("/dev/stdout",1),l.open("/dev/stderr",1)},staticInit(){l.nameTable=new Array(4096),l.mount(Ae,{},"/"),l.createDefaultDirectories(),l.createDefaultDevices(),l.createSpecialDirectories(),l.filesystems={MEMFS:Ae}},init(e,t,o){l.initialized=!0,e??=u.stdin,t??=u.stdout,o??=u.stderr,l.createStandardStreams(e,t,o)},quit(){l.initialized=!1;for(var e of l.streams)e&&l.close(e)},findObject(e,t){var o=l.analyzePath(e,t);return o.exists?o.object:null},analyzePath(e,t){try{var o=l.lookupPath(e,{follow:!t});e=o.path}catch{}var s={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var o=l.lookupPath(e,{parent:!0});s.parentExists=!0,s.parentPath=o.path,s.parentObject=o.node,s.name=Fe.basename(e),o=l.lookupPath(e,{follow:!t}),s.exists=!0,s.path=o.path,s.object=o.node,s.name=o.node.name,s.isRoot=o.path==="/"}catch(n){s.error=n.errno}return s},createPath(e,t,o,s){e=typeof e=="string"?e:l.getPath(e);for(var n=t.split("/").reverse();n.length;){var i=n.pop();if(i){var r=Fe.join2(e,i);try{l.mkdir(r)}catch(c){if(c.errno!=20)throw c}e=r}}return r},createFile(e,t,o,s,n){var i=Fe.join2(typeof e=="string"?e:l.getPath(e),t),r=jt(s,n);return l.create(i,r)},createDataFile(e,t,o,s,n,i){var r=t;e&&(e=typeof e=="string"?e:l.getPath(e),r=t?Fe.join2(e,t):e);var c=jt(s,n),P=l.create(r,c);if(o){if(typeof o=="string"){for(var R=new Array(o.length),Z=0,D=o.length;Z<D;++Z)R[Z]=o.charCodeAt(Z);o=R}l.chmod(P,c|146);var $=l.open(P,577);l.write($,o,0,o.length,0,i),l.close($),l.chmod(P,c)}},createDevice(e,t,o,s){var n=Fe.join2(typeof e=="string"?e:l.getPath(e),t),i=jt(!!o,!!s);l.createDevice.major??=64;var r=l.makedev(l.createDevice.major++,0);return l.registerDevice(r,{open(c){c.seekable=!1},close(c){s?.buffer?.length&&s(10)},read(c,P,R,Z,D){for(var $=0,m=0;m<Z;m++){var W;try{W=o()}catch{throw new l.ErrnoError(29)}if(W===void 0&&$===0)throw new l.ErrnoError(6);if(W==null)break;$++,P[R+m]=W}return $&&(c.node.atime=Date.now()),$},write(c,P,R,Z,D){for(var $=0;$<Z;$++)try{s(P[R+$])}catch{throw new l.ErrnoError(29)}return Z&&(c.node.mtime=c.node.ctime=Date.now()),$}}),l.mkdev(n,i,r)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(globalThis.XMLHttpRequest)nt("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else try{e.contents=fe(e.url)}catch{throw new l.ErrnoError(29)}},createLazyFile(e,t,o,s,n){class i{lengthKnown=!1;chunks=[];get(D){if(!(D>this.length-1||D<0)){var $=D%this.chunkSize,m=D/this.chunkSize|0;return this.getter(m)[$]}}setDataGetter(D){this.getter=D}cacheLength(){var D=new XMLHttpRequest;D.open("HEAD",o,!1),D.send(null),D.status>=200&&D.status<300||D.status===304||nt("Couldn't load "+o+". Status: "+D.status);var $=Number(D.getResponseHeader("Content-length")),m,W=(m=D.getResponseHeader("Accept-Ranges"))&&m==="bytes",M=(m=D.getResponseHeader("Content-Encoding"))&&m==="gzip",se=1024*1024;W||(se=$);var q=(U,Q)=>{U>Q&&nt("invalid range ("+U+", "+Q+") or no bytes requested!"),Q>$-1&&nt("only "+$+" bytes available! programmer error!");var I=new XMLHttpRequest;return I.open("GET",o,!1),$!==se&&I.setRequestHeader("Range","bytes="+U+"-"+Q),I.responseType="arraybuffer",I.overrideMimeType&&I.overrideMimeType("text/plain; charset=x-user-defined"),I.send(null),I.status>=200&&I.status<300||I.status===304||nt("Couldn't load "+o+". Status: "+I.status),I.response!==void 0?new Uint8Array(I.response||[]):Ut(I.responseText||"")},E=this;E.setDataGetter(U=>{var Q=U*se,I=(U+1)*se-1;return I=Math.min(I,$-1),typeof E.chunks[U]>"u"&&(E.chunks[U]=q(Q,I)),typeof E.chunks[U]>"u"&&nt("doXHR failed!"),E.chunks[U]}),(M||!$)&&(se=$=1,$=this.getter(0).length,se=$,te("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=$,this._chunkSize=se,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(globalThis.XMLHttpRequest){Ye||nt("Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc");var r={isDevice:!1,contents:new i}}else var r={isDevice:!1,url:o};var c=l.createFile(e,t,r,s,n);r.contents?c.contents=r.contents:r.url&&(c.contents=null,c.url=r.url),Object.defineProperties(c,{usedBytes:{get:function(){return this.contents.length}}});var P={};for(const[Z,D]of Object.entries(c.stream_ops))P[Z]=(...$)=>(l.forceLoadFile(c),D(...$));function R(Z,D,$,m,W){var M=Z.node.contents;if(W>=M.length)return 0;var se=Math.min(M.length-W,m);if(M.slice)for(var q=0;q<se;q++)D[$+q]=M[W+q];else for(var q=0;q<se;q++)D[$+q]=M.get(W+q);return se}return P.read=(Z,D,$,m,W)=>(l.forceLoadFile(c),R(Z,D,$,m,W)),P.mmap=(Z,D,$,m,W)=>{l.forceLoadFile(c);var M=en(D);if(!M)throw new l.ErrnoError(48);return R(Z,$e,M,D,$),{ptr:M,allocated:!0}},c.stream_ops=P,c}},Tn=(e,t,o)=>{if(!e)return"";var s=At(dt,e,t);return yt.decode(dt.subarray(e,s))},ke={calculateAt(e,t,o){if(Fe.isAbs(t))return t;var s;if(e===-100?s=l.cwd():s=ke.getStreamFromFD(e).path,t.length==0){if(!o)throw new l.ErrnoError(44);return s}return s+"/"+t},writeStat(e,t){Pe[e>>2]=t.dev,Pe[e+4>>2]=t.mode,Pe[e+8>>2]=t.nlink,Pe[e+12>>2]=t.uid,Pe[e+16>>2]=t.gid,Pe[e+20>>2]=t.rdev,Qe[e+24>>3]=BigInt(t.size),Ne[e+32>>2]=4096,Ne[e+36>>2]=t.blocks;var o=t.atime.getTime(),s=t.mtime.getTime(),n=t.ctime.getTime();return Qe[e+40>>3]=BigInt(Math.floor(o/1e3)),Pe[e+48>>2]=o%1e3*1e3*1e3,Qe[e+56>>3]=BigInt(Math.floor(s/1e3)),Pe[e+64>>2]=s%1e3*1e3*1e3,Qe[e+72>>3]=BigInt(Math.floor(n/1e3)),Pe[e+80>>2]=n%1e3*1e3*1e3,Qe[e+88>>3]=BigInt(t.ino),0},writeStatFs(e,t){Pe[e+4>>2]=t.bsize,Pe[e+60>>2]=t.bsize,Qe[e+8>>3]=BigInt(t.blocks),Qe[e+16>>3]=BigInt(t.bfree),Qe[e+24>>3]=BigInt(t.bavail),Qe[e+32>>3]=BigInt(t.files),Qe[e+40>>3]=BigInt(t.ffree),Pe[e+48>>2]=t.fsid,Pe[e+64>>2]=t.flags,Pe[e+56>>2]=t.namelen},doMsync(e,t,o,s,n){if(!l.isFile(t.node.mode))throw new l.ErrnoError(43);if(s&2)return 0;var i=dt.slice(e,e+o);l.msync(t,i,n,o,s)},getStreamFromFD(e){return l.getStreamChecked(e)},varargs:void 0,getStr(e){return Tn(e)}};function An(e,t){try{return e=ke.getStr(e),l.chmod(e,t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function zt(e,t,o,s){try{if(t=ke.getStr(t),t=ke.calculateAt(e,t),o&-8)return-28;var n=l.lookupPath(t,{follow:!0}).node;if(!n)return-44;var i="";return o&4&&(i+="r"),o&2&&(i+="w"),o&1&&(i+="x"),i&&l.nodePermissions(n,i)?-2:0}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function sn(e,t){try{return l.fchmod(e,t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function In(e,t,o){try{return l.fchown(e,t,o),0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var Pt=()=>{var e=Ne[+ke.varargs>>2];return ke.varargs+=4,e},qt=Pt;function wn(e,t,o){ke.varargs=o;try{var s=ke.getStreamFromFD(e);switch(t){case 0:var n=Pt();if(n<0)return-28;for(;l.streams[n];)n++;return l.dupStream(s,n).fd;case 1:case 2:return 0;case 3:return s.flags;case 4:var n=Pt();return s.flags|=n,0;case 12:var n=qt(),i=0;return Tt[n+i>>1]=2,0;case 13:case 14:return 0}return-28}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function On(e,t){try{return ke.writeStat(t,l.fstat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var kn=9007199254740992,Rn=-9007199254740992,ht=e=>e<Rn||e>kn?NaN:Number(e);function Ln(e,t){t=ht(t);try{return isNaN(t)?-61:(l.ftruncate(e,t),0)}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var Ve=(e,t,o)=>Yt(e,dt,t,o);function wt(e,t){try{if(t===0)return-28;var o=l.cwd(),s=Lt(o)+1;return t<s?-68:(Ve(o,e,t),s)}catch(n){if(typeof l>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function d(e,t,o){ke.varargs=o;try{var s=ke.getStreamFromFD(e);switch(t){case 21509:return s.tty?0:-59;case 21505:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcgets){var n=s.tty.ops.ioctl_tcgets(s),D=qt();Ne[D>>2]=n.c_iflag||0,Ne[D+4>>2]=n.c_oflag||0,Ne[D+8>>2]=n.c_cflag||0,Ne[D+12>>2]=n.c_lflag||0;for(var i=0;i<32;i++)$e[D+i+17]=n.c_cc[i]||0;return 0}return 0;case 21510:case 21511:case 21512:return s.tty?0:-59;case 21506:case 21507:case 21508:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcsets){for(var D=qt(),r=Ne[D>>2],c=Ne[D+4>>2],P=Ne[D+8>>2],R=Ne[D+12>>2],Z=[],i=0;i<32;i++)Z.push($e[D+i+17]);return s.tty.ops.ioctl_tcsets(s.tty,t,{c_iflag:r,c_oflag:c,c_cflag:P,c_lflag:R,c_cc:Z})}return 0;case 21519:if(!s.tty)return-59;var D=qt();return Ne[D>>2]=0,0;case 21520:return s.tty?-28:-59;case 21537:case 21531:var D=qt();return l.ioctl(s,t,D);case 21523:if(!s.tty)return-59;if(s.tty.ops.ioctl_tiocgwinsz){var $=s.tty.ops.ioctl_tiocgwinsz(s.tty),D=qt();Tt[D>>1]=$[0],Tt[D+2>>1]=$[1]}return 0;case 21524:return s.tty?0:-59;case 21515:return s.tty?0:-59;default:return-28}}catch(m){if(typeof l>"u"||m.name!=="ErrnoError")throw m;return-m.errno}}function h(e,t){try{return e=ke.getStr(e),ke.writeStat(t,l.lstat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function F(e,t,o){try{return t=ke.getStr(t),t=ke.calculateAt(e,t),l.mkdir(t,o,0),0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function ce(e,t,o,s){try{t=ke.getStr(t);var n=s&256,i=s&4096;return s=s&-6401,t=ke.calculateAt(e,t,i),ke.writeStat(o,n?l.lstat(t):l.stat(t))}catch(r){if(typeof l>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Se(e,t,o,s){ke.varargs=s;try{t=ke.getStr(t),t=ke.calculateAt(e,t);var n=s?Pt():0;return l.open(t,o,n).fd}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function Te(e,t,o,s){try{if(t=ke.getStr(t),t=ke.calculateAt(e,t),s<=0)return-28;var n=l.readlink(t),i=Math.min(s,Lt(n)),r=$e[o+i];return Ve(n,o,s+1),$e[o+i]=r,i}catch(c){if(typeof l>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function Re(e){try{return e=ke.getStr(e),l.rmdir(e),0}catch(t){if(typeof l>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function Ot(e,t){try{return e=ke.getStr(e),ke.writeStat(t,l.stat(e))}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function mt(e,t,o){try{if(t=ke.getStr(t),t=ke.calculateAt(e,t),!o)l.unlink(t);else if(o===512)l.rmdir(t);else return-28;return 0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var rt=e=>Pe[e>>2]+Ne[e+4>>2]*4294967296;function Nn(e,t,o,s){try{t=ke.getStr(t),t=ke.calculateAt(e,t,!0);var n=Date.now(),i,r;if(!o)i=n,r=n;else{var c=rt(o),P=Ne[o+8>>2];P==1073741823?i=n:P==1073741822?i=null:i=c*1e3+P/(1e3*1e3),o+=16,c=rt(o),P=Ne[o+8>>2],P==1073741823?r=n:P==1073741822?r=null:r=c*1e3+P/(1e3*1e3)}return(r??i)!==null&&l.utime(t,i,r),0}catch(R){if(typeof l>"u"||R.name!=="ErrnoError")throw R;return-R.errno}}var Fn=e=>e%4===0&&(e%100!==0||e%400===0),Hn=[0,31,60,91,121,152,182,213,244,274,305,335],Qn=[0,31,59,90,120,151,181,212,243,273,304,334],Vn=e=>(Fn(e.getFullYear())?Hn:Qn)[e.getMonth()]+e.getDate()-1;function Gn(e,t){e=ht(e);var o=new Date(e*1e3);Ne[t>>2]=o.getSeconds(),Ne[t+4>>2]=o.getMinutes(),Ne[t+8>>2]=o.getHours(),Ne[t+12>>2]=o.getDate(),Ne[t+16>>2]=o.getMonth(),Ne[t+20>>2]=o.getFullYear()-1900,Ne[t+24>>2]=o.getDay();var s=Vn(o)|0;Ne[t+28>>2]=s,Ne[t+36>>2]=-(o.getTimezoneOffset()*60);var n=new Date(o.getFullYear(),0,1),i=new Date(o.getFullYear(),6,1).getTimezoneOffset(),r=n.getTimezoneOffset(),c=(i!=r&&o.getTimezoneOffset()==Math.min(r,i))|0;Ne[t+32>>2]=c}function Xn(e,t,o,s,n,i,r){n=ht(n);try{var c=ke.getStreamFromFD(s),P=l.mmap(c,e,n,t,o),R=P.ptr;return Ne[i>>2]=P.allocated,Pe[r>>2]=R,0}catch(Z){if(typeof l>"u"||Z.name!=="ErrnoError")throw Z;return-Z.errno}}function Jn(e,t,o,s,n,i){i=ht(i);try{var r=ke.getStreamFromFD(n);o&2&&ke.doMsync(e,r,t,s,i)}catch(c){if(typeof l>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}var $n=(e,t,o,s)=>{var n=new Date().getFullYear(),i=new Date(n,0,1),r=new Date(n,6,1),c=i.getTimezoneOffset(),P=r.getTimezoneOffset(),R=Math.max(c,P);Pe[e>>2]=R*60,Ne[t>>2]=+(c!=P);var Z=m=>{var W=m>=0?"-":"+",M=Math.abs(m);return`UTC${W}${String(Math.floor(M/60)).padStart(2,"0")}${String(M%60).padStart(2,"0")}`},D=Z(c),$=Z(P);P<c?(Ve(D,o,17),Ve($,s,17)):(Ve(D,s,17),Ve($,o,17))},Dn=()=>performance.now(),Mn=()=>Date.now(),Kn=e=>e>=0&&e<=3;function Yn(e,t,o){if(!Kn(e))return 28;var s;e===0?s=Mn():s=Dn();var n=Math.round(s*1e3*1e3);return Qe[o>>3]=BigInt(n),0}var Un=()=>2147483648,Zn=()=>Un(),er=e=>{var t=(e-ot.buffer.byteLength+65535)/65536|0;try{return ot.grow(t),Vt(),1}catch{}},tr=e=>{var t=dt.length;e>>>=0;var o=Un();if(e>o)return!1;for(var s=1;s<=4;s*=2){var n=t*(1+.2/s);if(n=Math.min(n,e+100663296),er(Math.min(o,Zt(Math.max(e,n),65536))))return!0}return!1},Cn={},nr=()=>je||"./this.program",Wt=()=>{if(!Wt.strings){var e=(globalThis.navigator?.language??"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:nr()};for(var o in Cn)Cn[o]===void 0?delete t[o]:t[o]=Cn[o];var s=[];for(var o in t)s.push(`${o}=${t[o]}`);Wt.strings=s}return Wt.strings},rr=(e,t)=>{var o=0,s=0;for(var n of Wt()){var i=t+o;Pe[e+s>>2]=i,o+=Ve(n,i,1/0)+1,s+=4}return 0},ir=(e,t)=>{var o=Wt();Pe[e>>2]=o.length;var s=0;for(var n of o)s+=Lt(n)+1;return Pe[t>>2]=s,0};function sr(e){try{var t=ke.getStreamFromFD(e);return l.close(t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return o.errno}}function or(e,t){try{var o=0,s=0,n=0,i=ke.getStreamFromFD(e),r=i.tty?2:l.isDir(i.mode)?3:l.isLink(i.mode)?7:4;return $e[t]=r,Tt[t+2>>1]=n,Qe[t+8>>3]=BigInt(o),Qe[t+16>>3]=BigInt(s),0}catch(c){if(typeof l>"u"||c.name!=="ErrnoError")throw c;return c.errno}}var ar=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Pe[t>>2],c=Pe[t+4>>2];t+=8;var P=l.read(e,$e,r,c,s);if(P<0)return-1;if(n+=P,P<c)break}return n};function lr(e,t,o,s){try{var n=ar(ke.getStreamFromFD(e),t,o);return Pe[s>>2]=n,0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function cr(e,t,o,s){t=ht(t);try{if(isNaN(t))return 61;var n=ke.getStreamFromFD(e);return l.llseek(n,t,o),Qe[s>>3]=BigInt(n.position),n.getdents&&t===0&&o===0&&(n.getdents=null),0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function _r(e){try{var t=ke.getStreamFromFD(e);return t.stream_ops?.fsync?.(t)}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return o.errno}}var ur=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Pe[t>>2],c=Pe[t+4>>2];t+=8;var P=l.write(e,$e,r,c,s);if(P<0)return-1;if(n+=P,P<c)break}return n};function fr(e,t,o,s){try{var n=ur(ke.getStreamFromFD(e),t,o);return Pe[s>>2]=n,0}catch(i){if(typeof l>"u"||i.name!=="ErrnoError")throw i;return i.errno}}if(l.createPreloadedFile=Bt,l.preloadFile=rn,l.staticInit(),ln(),u.noExitRuntime&&u.noExitRuntime,u.preloadPlugins&&(nn=u.preloadPlugins),u.print&&(te=u.print),u.printErr&&(Me=u.printErr),u.wasmBinary&&(ze=u.wasmBinary),u.arguments&&u.arguments,u.thisProgram&&(je=u.thisProgram),u.preInit)for(typeof u.preInit=="function"&&(u.preInit=[u.preInit]);u.preInit.length>0;)u.preInit.shift()();u.wasmMemory=ot;var jn;function dr(e){u._sqlite3_status64=e.sqlite3_status64,u._sqlite3_status=e.sqlite3_status,u._sqlite3_db_status64=e.sqlite3_db_status64,u._sqlite3_msize=e.sqlite3_msize,u._sqlite3_db_status=e.sqlite3_db_status,u._sqlite3_vfs_find=e.sqlite3_vfs_find,u._sqlite3_initialize=e.sqlite3_initialize,u._sqlite3_malloc=e.sqlite3_malloc,u._sqlite3_free=e.sqlite3_free,u._sqlite3_vfs_register=e.sqlite3_vfs_register,u._sqlite3_vfs_unregister=e.sqlite3_vfs_unregister,u._sqlite3_malloc64=e.sqlite3_malloc64,u._sqlite3_realloc=e.sqlite3_realloc,u._sqlite3_realloc64=e.sqlite3_realloc64,u._sqlite3_value_text=e.sqlite3_value_text,u._sqlite3_randomness=e.sqlite3_randomness,u._sqlite3_stricmp=e.sqlite3_stricmp,u._sqlite3_strnicmp=e.sqlite3_strnicmp,u._sqlite3_uri_parameter=e.sqlite3_uri_parameter,u._sqlite3_uri_boolean=e.sqlite3_uri_boolean,u._sqlite3_serialize=e.sqlite3_serialize,u._sqlite3_prepare_v2=e.sqlite3_prepare_v2,u._sqlite3_step=e.sqlite3_step,u._sqlite3_column_int64=e.sqlite3_column_int64,u._sqlite3_reset=e.sqlite3_reset,u._sqlite3_exec=e.sqlite3_exec,u._sqlite3_column_int=e.sqlite3_column_int,u._sqlite3_finalize=e.sqlite3_finalize,u._sqlite3_file_control=e.sqlite3_file_control,u._sqlite3_column_name=e.sqlite3_column_name,u._sqlite3_column_text=e.sqlite3_column_text,u._sqlite3_column_type=e.sqlite3_column_type,u._sqlite3_errmsg=e.sqlite3_errmsg,u._sqlite3_deserialize=e.sqlite3_deserialize,u._sqlite3_clear_bindings=e.sqlite3_clear_bindings,u._sqlite3_value_blob=e.sqlite3_value_blob,u._sqlite3_value_bytes=e.sqlite3_value_bytes,u._sqlite3_value_double=e.sqlite3_value_double,u._sqlite3_value_int=e.sqlite3_value_int,u._sqlite3_value_int64=e.sqlite3_value_int64,u._sqlite3_value_subtype=e.sqlite3_value_subtype,u._sqlite3_value_pointer=e.sqlite3_value_pointer,u._sqlite3_value_type=e.sqlite3_value_type,u._sqlite3_value_nochange=e.sqlite3_value_nochange,u._sqlite3_value_frombind=e.sqlite3_value_frombind,u._sqlite3_value_dup=e.sqlite3_value_dup,u._sqlite3_value_free=e.sqlite3_value_free,u._sqlite3_result_blob=e.sqlite3_result_blob,u._sqlite3_result_error_toobig=e.sqlite3_result_error_toobig,u._sqlite3_result_error_nomem=e.sqlite3_result_error_nomem,u._sqlite3_result_double=e.sqlite3_result_double,u._sqlite3_result_error=e.sqlite3_result_error,u._sqlite3_result_int=e.sqlite3_result_int,u._sqlite3_result_int64=e.sqlite3_result_int64,u._sqlite3_result_null=e.sqlite3_result_null,u._sqlite3_result_pointer=e.sqlite3_result_pointer,u._sqlite3_result_subtype=e.sqlite3_result_subtype,u._sqlite3_result_text=e.sqlite3_result_text,u._sqlite3_result_zeroblob=e.sqlite3_result_zeroblob,u._sqlite3_result_zeroblob64=e.sqlite3_result_zeroblob64,u._sqlite3_result_error_code=e.sqlite3_result_error_code,u._sqlite3_user_data=e.sqlite3_user_data,u._sqlite3_context_db_handle=e.sqlite3_context_db_handle,u._sqlite3_vtab_nochange=e.sqlite3_vtab_nochange,u._sqlite3_vtab_in_first=e.sqlite3_vtab_in_first,u._sqlite3_vtab_in_next=e.sqlite3_vtab_in_next,u._sqlite3_aggregate_context=e.sqlite3_aggregate_context,u._sqlite3_get_auxdata=e.sqlite3_get_auxdata,u._sqlite3_set_auxdata=e.sqlite3_set_auxdata,u._sqlite3_column_count=e.sqlite3_column_count,u._sqlite3_data_count=e.sqlite3_data_count,u._sqlite3_column_blob=e.sqlite3_column_blob,u._sqlite3_column_bytes=e.sqlite3_column_bytes,u._sqlite3_column_double=e.sqlite3_column_double,u._sqlite3_column_value=e.sqlite3_column_value,u._sqlite3_column_decltype=e.sqlite3_column_decltype,u._sqlite3_column_database_name=e.sqlite3_column_database_name,u._sqlite3_column_table_name=e.sqlite3_column_table_name,u._sqlite3_column_origin_name=e.sqlite3_column_origin_name,u._sqlite3_bind_blob=e.sqlite3_bind_blob,u._sqlite3_bind_double=e.sqlite3_bind_double,u._sqlite3_bind_int=e.sqlite3_bind_int,u._sqlite3_bind_int64=e.sqlite3_bind_int64,u._sqlite3_bind_null=e.sqlite3_bind_null,u._sqlite3_bind_pointer=e.sqlite3_bind_pointer,u._sqlite3_bind_text=e.sqlite3_bind_text,u._sqlite3_bind_parameter_count=e.sqlite3_bind_parameter_count,u._sqlite3_bind_parameter_name=e.sqlite3_bind_parameter_name,u._sqlite3_bind_parameter_index=e.sqlite3_bind_parameter_index,u._sqlite3_db_handle=e.sqlite3_db_handle,u._sqlite3_stmt_readonly=e.sqlite3_stmt_readonly,u._sqlite3_stmt_isexplain=e.sqlite3_stmt_isexplain,u._sqlite3_stmt_explain=e.sqlite3_stmt_explain,u._sqlite3_stmt_busy=e.sqlite3_stmt_busy,u._sqlite3_next_stmt=e.sqlite3_next_stmt,u._sqlite3_stmt_status=e.sqlite3_stmt_status,u._sqlite3_sql=e.sqlite3_sql,u._sqlite3_expanded_sql=e.sqlite3_expanded_sql,u._sqlite3_preupdate_old=e.sqlite3_preupdate_old,u._sqlite3_preupdate_count=e.sqlite3_preupdate_count,u._sqlite3_preupdate_depth=e.sqlite3_preupdate_depth,u._sqlite3_preupdate_blobwrite=e.sqlite3_preupdate_blobwrite,u._sqlite3_preupdate_new=e.sqlite3_preupdate_new,u._sqlite3_value_numeric_type=e.sqlite3_value_numeric_type,u._sqlite3_set_authorizer=e.sqlite3_set_authorizer,u._sqlite3_strglob=e.sqlite3_strglob,u._sqlite3_strlike=e.sqlite3_strlike,u._sqlite3_auto_extension=e.sqlite3_auto_extension,u._sqlite3_cancel_auto_extension=e.sqlite3_cancel_auto_extension,u._sqlite3_reset_auto_extension=e.sqlite3_reset_auto_extension,u._sqlite3_prepare_v3=e.sqlite3_prepare_v3,u._sqlite3_create_module=e.sqlite3_create_module,u._sqlite3_create_module_v2=e.sqlite3_create_module_v2,u._sqlite3_drop_modules=e.sqlite3_drop_modules,u._sqlite3_declare_vtab=e.sqlite3_declare_vtab,u._sqlite3_vtab_on_conflict=e.sqlite3_vtab_on_conflict,u._sqlite3_vtab_collation=e.sqlite3_vtab_collation,u._sqlite3_vtab_in=e.sqlite3_vtab_in,u._sqlite3_vtab_rhs_value=e.sqlite3_vtab_rhs_value,u._sqlite3_vtab_distinct=e.sqlite3_vtab_distinct,u._sqlite3_keyword_name=e.sqlite3_keyword_name,u._sqlite3_keyword_count=e.sqlite3_keyword_count,u._sqlite3_keyword_check=e.sqlite3_keyword_check,u._sqlite3_complete=e.sqlite3_complete,u._sqlite3_libversion=e.sqlite3_libversion,u._sqlite3_libversion_number=e.sqlite3_libversion_number,u._sqlite3_shutdown=e.sqlite3_shutdown,u._sqlite3_last_insert_rowid=e.sqlite3_last_insert_rowid,u._sqlite3_set_last_insert_rowid=e.sqlite3_set_last_insert_rowid,u._sqlite3_changes64=e.sqlite3_changes64,u._sqlite3_changes=e.sqlite3_changes,u._sqlite3_total_changes64=e.sqlite3_total_changes64,u._sqlite3_total_changes=e.sqlite3_total_changes,u._sqlite3_txn_state=e.sqlite3_txn_state,u._sqlite3_close_v2=e.sqlite3_close_v2,u._sqlite3_busy_handler=e.sqlite3_busy_handler,u._sqlite3_progress_handler=e.sqlite3_progress_handler,u._sqlite3_busy_timeout=e.sqlite3_busy_timeout,u._sqlite3_interrupt=e.sqlite3_interrupt,u._sqlite3_is_interrupted=e.sqlite3_is_interrupted,u._sqlite3_create_function=e.sqlite3_create_function,u._sqlite3_create_function_v2=e.sqlite3_create_function_v2,u._sqlite3_create_window_function=e.sqlite3_create_window_function,u._sqlite3_overload_function=e.sqlite3_overload_function,u._sqlite3_trace_v2=e.sqlite3_trace_v2,u._sqlite3_commit_hook=e.sqlite3_commit_hook,u._sqlite3_update_hook=e.sqlite3_update_hook,u._sqlite3_rollback_hook=e.sqlite3_rollback_hook,u._sqlite3_preupdate_hook=e.sqlite3_preupdate_hook,u._sqlite3_set_errmsg=e.sqlite3_set_errmsg,u._sqlite3_error_offset=e.sqlite3_error_offset,u._sqlite3_errcode=e.sqlite3_errcode,u._sqlite3_extended_errcode=e.sqlite3_extended_errcode,u._sqlite3_errstr=e.sqlite3_errstr,u._sqlite3_limit=e.sqlite3_limit,u._sqlite3_open=e.sqlite3_open,u._sqlite3_open_v2=e.sqlite3_open_v2,u._sqlite3_create_collation=e.sqlite3_create_collation,u._sqlite3_create_collation_v2=e.sqlite3_create_collation_v2,u._sqlite3_collation_needed=e.sqlite3_collation_needed,u._sqlite3_get_autocommit=e.sqlite3_get_autocommit,u._sqlite3_table_column_metadata=e.sqlite3_table_column_metadata,u._sqlite3_extended_result_codes=e.sqlite3_extended_result_codes,u._sqlite3_uri_key=e.sqlite3_uri_key,u._sqlite3_uri_int64=e.sqlite3_uri_int64,u._sqlite3_db_name=e.sqlite3_db_name,u._sqlite3_db_filename=e.sqlite3_db_filename,u._sqlite3_db_readonly=e.sqlite3_db_readonly,u._sqlite3_compileoption_used=e.sqlite3_compileoption_used,u._sqlite3_compileoption_get=e.sqlite3_compileoption_get,u._sqlite3session_diff=e.sqlite3session_diff,u._sqlite3session_attach=e.sqlite3session_attach,u._sqlite3session_create=e.sqlite3session_create,u._sqlite3session_delete=e.sqlite3session_delete,u._sqlite3session_table_filter=e.sqlite3session_table_filter,u._sqlite3session_changeset=e.sqlite3session_changeset,u._sqlite3session_changeset_strm=e.sqlite3session_changeset_strm,u._sqlite3session_patchset_strm=e.sqlite3session_patchset_strm,u._sqlite3session_patchset=e.sqlite3session_patchset,u._sqlite3session_enable=e.sqlite3session_enable,u._sqlite3session_indirect=e.sqlite3session_indirect,u._sqlite3session_isempty=e.sqlite3session_isempty,u._sqlite3session_memory_used=e.sqlite3session_memory_used,u._sqlite3session_object_config=e.sqlite3session_object_config,u._sqlite3session_changeset_size=e.sqlite3session_changeset_size,u._sqlite3changeset_start=e.sqlite3changeset_start,u._sqlite3changeset_start_v2=e.sqlite3changeset_start_v2,u._sqlite3changeset_start_strm=e.sqlite3changeset_start_strm,u._sqlite3changeset_start_v2_strm=e.sqlite3changeset_start_v2_strm,u._sqlite3changeset_next=e.sqlite3changeset_next,u._sqlite3changeset_op=e.sqlite3changeset_op,u._sqlite3changeset_pk=e.sqlite3changeset_pk,u._sqlite3changeset_old=e.sqlite3changeset_old,u._sqlite3changeset_new=e.sqlite3changeset_new,u._sqlite3changeset_conflict=e.sqlite3changeset_conflict,u._sqlite3changeset_fk_conflicts=e.sqlite3changeset_fk_conflicts,u._sqlite3changeset_finalize=e.sqlite3changeset_finalize,u._sqlite3changeset_invert=e.sqlite3changeset_invert,u._sqlite3changeset_invert_strm=e.sqlite3changeset_invert_strm,u._sqlite3changeset_apply_v2=e.sqlite3changeset_apply_v2,u._sqlite3changeset_apply_v3=e.sqlite3changeset_apply_v3,u._sqlite3changeset_apply=e.sqlite3changeset_apply,u._sqlite3changeset_apply_v3_strm=e.sqlite3changeset_apply_v3_strm,u._sqlite3changeset_apply_v2_strm=e.sqlite3changeset_apply_v2_strm,u._sqlite3changeset_apply_strm=e.sqlite3changeset_apply_strm,u._sqlite3changegroup_new=e.sqlite3changegroup_new,u._sqlite3changegroup_add=e.sqlite3changegroup_add,u._sqlite3changegroup_output=e.sqlite3changegroup_output,u._sqlite3changegroup_add_strm=e.sqlite3changegroup_add_strm,u._sqlite3changegroup_output_strm=e.sqlite3changegroup_output_strm,u._sqlite3changegroup_delete=e.sqlite3changegroup_delete,u._sqlite3changeset_concat=e.sqlite3changeset_concat,u._sqlite3changeset_concat_strm=e.sqlite3changeset_concat_strm,u._sqlite3session_config=e.sqlite3session_config,u._sqlite3_sourceid=e.sqlite3_sourceid,u._sqlite3__wasm_pstack_ptr=e.sqlite3__wasm_pstack_ptr,u._sqlite3__wasm_pstack_restore=e.sqlite3__wasm_pstack_restore,u._sqlite3__wasm_pstack_alloc=e.sqlite3__wasm_pstack_alloc,u._sqlite3__wasm_pstack_remaining=e.sqlite3__wasm_pstack_remaining,u._sqlite3__wasm_pstack_quota=e.sqlite3__wasm_pstack_quota,u._sqlite3__wasm_test_struct=e.sqlite3__wasm_test_struct,u._sqlite3__wasm_enum_json=e.sqlite3__wasm_enum_json,u._sqlite3__wasm_vfs_unlink=e.sqlite3__wasm_vfs_unlink,u._sqlite3__wasm_db_vfs=e.sqlite3__wasm_db_vfs,u._sqlite3__wasm_db_reset=e.sqlite3__wasm_db_reset,u._sqlite3__wasm_db_export_chunked=e.sqlite3__wasm_db_export_chunked,u._sqlite3__wasm_db_serialize=e.sqlite3__wasm_db_serialize,u._sqlite3__wasm_vfs_create_file=e.sqlite3__wasm_vfs_create_file,u._sqlite3__wasm_posix_create_file=e.sqlite3__wasm_posix_create_file,u._sqlite3__wasm_kvvfsMakeKey=e.sqlite3__wasm_kvvfsMakeKey,u._sqlite3__wasm_kvvfs_methods=e.sqlite3__wasm_kvvfs_methods,u._sqlite3__wasm_vtab_config=e.sqlite3__wasm_vtab_config,u._sqlite3__wasm_db_config_ip=e.sqlite3__wasm_db_config_ip,u._sqlite3__wasm_db_config_pii=e.sqlite3__wasm_db_config_pii,u._sqlite3__wasm_db_config_s=e.sqlite3__wasm_db_config_s,u._sqlite3__wasm_config_i=e.sqlite3__wasm_config_i,u._sqlite3__wasm_config_ii=e.sqlite3__wasm_config_ii,u._sqlite3__wasm_config_j=e.sqlite3__wasm_config_j,u._sqlite3__wasm_qfmt_token=e.sqlite3__wasm_qfmt_token,u._sqlite3__wasm_kvvfs_decode=e.sqlite3__wasm_kvvfs_decode,u._sqlite3__wasm_kvvfs_encode=e.sqlite3__wasm_kvvfs_encode,u._sqlite3__wasm_init_wasmfs=e.sqlite3__wasm_init_wasmfs,u._sqlite3__wasm_test_intptr=e.sqlite3__wasm_test_intptr,u._sqlite3__wasm_test_voidptr=e.sqlite3__wasm_test_voidptr,u._sqlite3__wasm_test_int64_max=e.sqlite3__wasm_test_int64_max,u._sqlite3__wasm_test_int64_min=e.sqlite3__wasm_test_int64_min,u._sqlite3__wasm_test_int64_times2=e.sqlite3__wasm_test_int64_times2,u._sqlite3__wasm_test_int64_minmax=e.sqlite3__wasm_test_int64_minmax,u._sqlite3__wasm_test_int64ptr=e.sqlite3__wasm_test_int64ptr,u._sqlite3__wasm_test_stack_overflow=e.sqlite3__wasm_test_stack_overflow,u._sqlite3__wasm_test_str_hello=e.sqlite3__wasm_test_str_hello,u._sqlite3__wasm_SQLTester_strglob=e.sqlite3__wasm_SQLTester_strglob,u._malloc=e.malloc,u._free=e.free,u._realloc=e.realloc,jn=e.emscripten_builtin_memalign,e._emscripten_stack_restore,e._emscripten_stack_alloc,e.emscripten_stack_get_current,e.__indirect_function_table}var Bn={__syscall_chmod:An,__syscall_faccessat:zt,__syscall_fchmod:sn,__syscall_fchown32:In,__syscall_fcntl64:wn,__syscall_fstat64:On,__syscall_ftruncate64:Ln,__syscall_getcwd:wt,__syscall_ioctl:d,__syscall_lstat64:h,__syscall_mkdirat:F,__syscall_newfstatat:ce,__syscall_openat:Se,__syscall_readlinkat:Te,__syscall_rmdir:Re,__syscall_stat64:Ot,__syscall_unlinkat:mt,__syscall_utimensat:Nn,_localtime_js:Gn,_mmap_js:Xn,_munmap_js:Jn,_tzset_js:$n,clock_time_get:Yn,emscripten_date_now:Mn,emscripten_get_heap_max:Zn,emscripten_get_now:Dn,emscripten_resize_heap:tr,environ_get:rr,environ_sizes_get:ir,fd_close:sr,fd_fdstat_get:or,fd_read:lr,fd_seek:cr,fd_sync:_r,fd_write:fr,memory:ot};function Pn(){if(pt>0){It=Pn;return}if(cn(),pt>0){It=Pn;return}function e(){u.calledRun=!0,!lt&&(Gt(),ct?.(u),u.onRuntimeInitialized?.(),_n())}u.setStatus?(u.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>u.setStatus(""),1),e()},1)):e()}var xt=await Mt();return Pn(),u.runSQLite3PostLoadInit=async function(e,t,o){delete t.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function s(n=globalThis.sqlite3ApiConfig||s.defaultConfig){if(s.sqlite3)return(s.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),s.sqlite3;const i=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},n||{});Object.assign(i,{allocExportName:i.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:i.useStdAlloc?"free":"sqlite3_free",reallocExportName:i.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(f=>{typeof i[f]=="function"&&(i[f]=i[f]())});const r=Object.create(null),c=Object.create(null),P=f=>r.sqlite3_js_rc_str&&r.sqlite3_js_rc_str(f)||"Unknown result code #"+f,R=f=>typeof f=="number"&&f===(f|0)&&f<=2147483647&&f>=-2147483648;class Z extends Error{constructor(...b){let S;if(b.length)if(R(b[0]))if(S=b[0],b.length===1)super(P(b[0]));else{const B=P(S);typeof b[1]=="object"?super(B,b[1]):(b[0]=B+":",super(b.join(" ")))}else b.length===2&&typeof b[1]=="object"?super(...b):super(b.join(" "));this.resultCode=S||r.SQLITE_ERROR,this.name="SQLite3Error"}}Z.toss=(...f)=>{throw new Z(...f)};const D=Z.toss;i.wasmfsOpfsDir&&!/^\/[^/]+$/.test(i.wasmfsOpfsDir)&&D("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const $=function f(b){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),b>=f._min&&b<=f._max},m=f=>f>=-2147483647n-1n&&f<=2147483647n,W=function f(b){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),b>=f._min&&b<=f._max},M=f=>f&&f.constructor&&R(f.constructor.BYTES_PER_ELEMENT)?f:!1,se=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),q=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),E=f=>se(f)||D("Value is not of a supported TypedArray type."),U=function(f){return q(f)?c.typedArrayToString(f instanceof ArrayBuffer?new Uint8Array(f):f,0,f.length):Array.isArray(f)?f.join(""):(c.isPtr(f)&&(f=c.cstrToJs(f)),f)};class Q extends Error{constructor(...b){b.length===2&&typeof b[1]=="object"?super(...b):b.length?super(b.join(" ")):super("Allocation failed."),this.resultCode=r.SQLITE_NOMEM,this.name="WasmAllocError"}}Q.toss=(...f)=>{throw new Q(...f)},Object.assign(r,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,b,S,B,ne,_e,ve,Ie,be)=>{},sqlite3_create_function:(f,b,S,B,ne,_e,ve,Ie)=>{},sqlite3_create_window_function:(f,b,S,B,ne,_e,ve,Ie,be,X)=>{},sqlite3_prepare_v3:(f,b,S,B,ne,_e)=>{},sqlite3_prepare_v2:(f,b,S,B,ne)=>{},sqlite3_exec:(f,b,S,B,ne)=>{},sqlite3_randomness:(f,b)=>{}});const I={affirmBindableTypedArray:E,flexibleString:U,bigIntFits32:m,bigIntFits64:$,bigIntFitsDouble:W,isBindableTypedArray:se,isInt32:R,isSQLableTypedArray:q,isTypedArray:M,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...f){throw new Error(f.join(" "))},toss3:D,typedArrayPart:c.typedArrayPart,assert:function(f,b){f||I.toss("Assertion failed:",b)},affirmDbHeader:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const b="SQLite format 3";15>f.byteLength&&D("Input does not contain an SQLite3 database header.");for(let S=0;S<15;++S)b.charCodeAt(S)!==f[S]&&D("Input does not contain an SQLite3 database header.")},affirmIsDb:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const b=f.byteLength;(b<512||b%512!==0)&&D("Byte array size",b,"is invalid for an SQLite3 db."),I.affirmDbHeader(f)}};Object.assign(c,{exports:i.exports||D("Missing API config.exports (WASM module exports)."),memory:i.memory||i.exports.memory||D("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),pointerSize:typeof i.exports.sqlite3_libversion()=="number"?4:8,bigIntEnabled:!!i.bigIntEnabled,functionTable:i.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),c.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),E(f);const b=c.alloc(f.byteLength||1);return c.heapForSize(f.constructor).set(f.byteLength?f:[0],Number(b)),b};{const f=i.allocExportName,b=i.deallocExportName,S=i.reallocExportName;for(const B of[f,b,S])c.exports[B]instanceof Function||D("Missing required exports[",B,"] function.");c.alloc=function B(ne){return B.impl(ne)||Q.toss("Failed to allocate",ne," bytes.")},c.alloc.impl=c.exports[f],c.realloc=function B(ne,_e){const ve=B.impl(c.ptr.coerce(ne),_e);return _e?ve||Q.toss("Failed to reallocate",_e," bytes."):c.ptr.null},c.realloc.impl=c.exports[S],c.dealloc=function B(ne){B.impl(c.ptr.coerce(ne))},c.dealloc.impl=c.exports[b]}c.compileOptionUsed=function f(b){if(arguments.length){if(Array.isArray(b)){const S=Object.create(null);return b.forEach(B=>{S[B]=r.sqlite3_compileoption_used(B)}),S}else if(typeof b=="object")return Object.keys(b).forEach(S=>{b[S]=r.sqlite3_compileoption_used(S)}),b}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(ve,Ie){const be=f._rx.exec(ve);Ie[0]=be?be[1]:ve,Ie[1]=be?f._rxInt.test(be[2])?+be[2]:be[2]:!0});const S=Object.create(null),B=[0,0];let ne=0,_e;for(;_e=r.sqlite3_compileoption_get(ne++);)f._opt(_e,B),S[B[0]]=B[1];return f._result=S}return typeof b=="string"?!!r.sqlite3_compileoption_used(b):!1},c.pstack=Object.assign(Object.create(null),{restore:c.exports.sqlite3__wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=c.sizeofIR(f))&&Q.toss("Invalid value for pstack.alloc(",arguments[0],")"),c.exports.sqlite3__wasm_pstack_alloc(f)||Q.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,b){typeof b=="string"&&!(b=c.sizeofIR(b))&&Q.toss("Invalid size value for allocChunks(",arguments[1],")");const S=c.pstack.alloc(f*b),B=[S];let ne=1,_e=b;for(;ne<f;++ne,_e+=b)B.push(c.ptr.add(S,_e));return B},allocPtr:(f=1,b=!0)=>f===1?c.pstack.alloc(b?8:c.ptr.size):c.pstack.allocChunks(f,b?8:c.ptr.size),call:function(f){const b=c.pstack.pointer;try{return f(L)}finally{c.pstack.restore(b)}}}),Object.defineProperties(c.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:c.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:c.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:c.exports.sqlite3__wasm_pstack_remaining}}),r.sqlite3_randomness=(...f)=>{if(f.length===1&&I.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const b=f[0];if(b.byteLength===0)return c.exports.sqlite3_randomness(0,c.ptr.null),b;const S=c.pstack.pointer;try{let B=b.byteLength,ne=0;const _e=c.exports.sqlite3_randomness,ve=c.heap8u(),Ie=B<512?B:512,be=c.pstack.alloc(Ie);do{const X=B>Ie?Ie:B;_e(X,be),b.set(c.typedArrayPart(ve,be,c.ptr.add(be,X)),ne),B-=X,ne+=X}while(B>0)}catch(B){i.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",B)}finally{c.pstack.restore(S)}return b}c.exports.sqlite3_randomness(...f)},r.sqlite3_wasmfs_opfs_dir=(function(){if(this.dir!==void 0)return this.dir;const f=i.wasmfsOpfsDir;if(!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!c.exports.sqlite3__wasm_init_wasmfs)return this.dir="";try{return f&&c.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],f)===0?this.dir=f:this.dir=""}catch{return this.dir=""}}).bind(Object.create(null)),r.sqlite3_wasmfs_filename_is_persistent=function(f){const b=r.sqlite3_wasmfs_opfs_dir();return b&&f?f.startsWith(b+"/"):!1},r.sqlite3_js_db_uses_vfs=function(f,b,S=0){try{const B=r.sqlite3_vfs_find(b);return B?f?B===r.sqlite3_js_db_vfs(f,S)?B:!1:B===r.sqlite3_vfs_find(0)?B:!1:!1}catch{return!1}},r.sqlite3_js_vfs_list=function(){const f=[];let b=r.sqlite3_vfs_find(c.ptr.null);for(;b;){const S=new r.sqlite3_vfs(b);f.push(c.cstrToJs(S.$zName)),b=S.$pNext,S.dispose()}return f},r.sqlite3_js_db_export=function(f,b=0){f=c.xWrap.testConvertArg("sqlite3*",f),f||D("Invalid sqlite3* argument."),c.bigIntEnabled||D("BigInt support is not enabled.");const S=c.scopedAllocPush();let B;try{const ne=c.scopedAlloc(8+c.ptr.size),_e=c.ptr.add(ne,8),ve=b?c.isPtr(b)?b:c.scopedAllocCString(""+b):c.ptr.null;let Ie=c.exports.sqlite3__wasm_db_serialize(f,ve,_e,ne,0);Ie&&D("Database serialization failed with code",L.capi.sqlite3_js_rc_str(Ie)),B=c.peekPtr(_e);const be=c.peek(ne,"i64");return Ie=be?c.heap8u().slice(Number(B),Number(B)+Number(be)):new Uint8Array,Ie}finally{B&&c.exports.sqlite3_free(B),c.scopedAllocPop(S)}},r.sqlite3_js_db_vfs=(f,b=c.ptr.null)=>I.sqlite3__wasm_db_vfs(f,b),r.sqlite3_js_aggregate_context=(f,b)=>r.sqlite3_aggregate_context(f,b)||(b?Q.toss("Cannot allocate",b,"bytes for sqlite3_aggregate_context()"):0),r.sqlite3_js_posix_create_file=function(f,b,S){let B;b&&c.isPtr(b)?B=b:b instanceof ArrayBuffer||b instanceof Uint8Array?(B=c.allocFromTypedArray(b),(arguments.length<3||!I.isInt32(S)||S<0)&&(S=b.byteLength)):Z.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!I.isInt32(S)||S<0)&&Z.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const ne=I.sqlite3__wasm_posix_create_file(f,B,S);ne&&Z.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(ne))}finally{B&&B!==b&&c.dealloc(B)}},r.sqlite3_js_vfs_create_file=function(f,b,S,B){i.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let ne;S?c.isPtr(S)?ne=S:(S instanceof ArrayBuffer&&(S=new Uint8Array(S)),S instanceof Uint8Array?(ne=c.allocFromTypedArray(S),(arguments.length<4||!I.isInt32(B)||B<0)&&(B=S.byteLength)):Z.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):ne=0,(!I.isInt32(B)||B<0)&&(ne&&ne!==S&&c.dealloc(ne),Z.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const _e=I.sqlite3__wasm_vfs_create_file(f,b,ne,B);_e&&Z.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(_e))}finally{ne&&ne!==S&&c.dealloc(ne)}},r.sqlite3_js_sql_to_string=f=>{if(typeof f=="string")return f;const b=U(v);return b===v?void 0:b},r.sqlite3_db_config=(function(f,b,...S){switch(b){case r.SQLITE_DBCONFIG_ENABLE_FKEY:case r.SQLITE_DBCONFIG_ENABLE_TRIGGER:case r.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case r.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case r.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case r.SQLITE_DBCONFIG_ENABLE_QPSG:case r.SQLITE_DBCONFIG_TRIGGER_EQP:case r.SQLITE_DBCONFIG_RESET_DATABASE:case r.SQLITE_DBCONFIG_DEFENSIVE:case r.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case r.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case r.SQLITE_DBCONFIG_DQS_DML:case r.SQLITE_DBCONFIG_DQS_DDL:case r.SQLITE_DBCONFIG_ENABLE_VIEW:case r.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case r.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case r.SQLITE_DBCONFIG_STMT_SCANSTATUS:case r.SQLITE_DBCONFIG_REVERSE_SCANORDER:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case r.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=c.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(f,b,S[0],S[1]||0);case r.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=c.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(f,b,S[0],S[1],S[2]);case r.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=c.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(f,b,S[0]);default:return r.SQLITE_MISUSE}}).bind(Object.create(null)),r.sqlite3_value_to_js=function(f,b=!0){let S;const B=r.sqlite3_value_type(f);switch(B){case r.SQLITE_INTEGER:c.bigIntEnabled?(S=r.sqlite3_value_int64(f),I.bigIntFitsDouble(S)&&(S=Number(S))):S=r.sqlite3_value_double(f);break;case r.SQLITE_FLOAT:S=r.sqlite3_value_double(f);break;case r.SQLITE_TEXT:S=r.sqlite3_value_text(f);break;case r.SQLITE_BLOB:{const ne=r.sqlite3_value_bytes(f),_e=r.sqlite3_value_blob(f);ne&&!_e&&L.WasmAllocError.toss("Cannot allocate memory for blob argument of",ne,"byte(s)"),S=ne?c.heap8u().slice(Number(_e),Number(_e)+Number(ne)):null;break}case r.SQLITE_NULL:S=null;break;default:b&&D(r.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",B),S=void 0}return S},r.sqlite3_values_to_js=function(f,b,S=!0){let B;const ne=[];for(B=0;B<f;++B)ne.push(r.sqlite3_value_to_js(c.peekPtr(c.ptr.add(b,c.ptr.size*B)),S));return ne},r.sqlite3_result_error_js=function(f,b){b instanceof Q?r.sqlite3_result_error_nomem(f):r.sqlite3_result_error(f,""+b,-1)},r.sqlite3_result_js=function(f,b){if(b instanceof Error){r.sqlite3_result_error_js(f,b);return}try{switch(typeof b){case"undefined":break;case"boolean":r.sqlite3_result_int(f,b?1:0);break;case"bigint":I.bigIntFits32(b)?r.sqlite3_result_int(f,Number(b)):I.bigIntFitsDouble(b)?r.sqlite3_result_double(f,Number(b)):c.bigIntEnabled?I.bigIntFits64(b)?r.sqlite3_result_int64(f,b):D("BigInt value",b.toString(),"is too BigInt for int64."):D("BigInt value",b.toString(),"is too BigInt.");break;case"number":{let S;I.isInt32(b)?S=r.sqlite3_result_int:c.bigIntEnabled&&Number.isInteger(b)&&I.bigIntFits64(BigInt(b))?S=r.sqlite3_result_int64:S=r.sqlite3_result_double,S(f,b);break}case"string":{const[S,B]=c.allocCString(b,!0);r.sqlite3_result_text(f,S,B,r.SQLITE_WASM_DEALLOC);break}case"object":if(b===null){r.sqlite3_result_null(f);break}else if(I.isBindableTypedArray(b)){const S=c.allocFromTypedArray(b);r.sqlite3_result_blob(f,S,b.byteLength,r.SQLITE_WASM_DEALLOC);break}default:D("Don't not how to handle this UDF result value:",typeof b,b)}}catch(S){r.sqlite3_result_error_js(f,S)}},r.sqlite3_column_js=function(f,b,S=!0){const B=r.sqlite3_column_value(f,b);return B===0?void 0:r.sqlite3_value_to_js(B,S)};{const f=(function(b,S,B){B=r[B],this.ptr?c.pokePtr(this.ptr,0):this.ptr=c.allocPtr();const ne=B(b,S,this.ptr);if(ne)return Z.toss(ne,arguments[2]+"() failed with code "+ne);const _e=c.peekPtr(this.ptr);return _e?r.sqlite3_value_to_js(_e,!0):void 0}).bind(Object.create(null));r.sqlite3_preupdate_new_js=(b,S)=>f(b,S,"sqlite3_preupdate_new"),r.sqlite3_preupdate_old_js=(b,S)=>f(b,S,"sqlite3_preupdate_old"),r.sqlite3changeset_new_js=(b,S)=>f(b,S,"sqlite3changeset_new"),r.sqlite3changeset_old_js=(b,S)=>f(b,S,"sqlite3changeset_old")}const L={WasmAllocError:Q,SQLite3Error:Z,capi:r,util:I,wasm:c,config:i,version:Object.create(null),client:void 0,asyncPostInit:(async function f(){if(f.isReady instanceof Promise)return f.isReady;let b=this.initializersAsync;delete this.initializersAsync;const S=async()=>(L.__isUnderTest||(delete L.util,delete L.StructBinder),L),B=_e=>{throw i.error("an async sqlite3 initializer failed:",_e),_e};if(!b||!b.length)return f.isReady=S().catch(B);b=b.map(_e=>_e instanceof Function?async ve=>_e(L):_e),b.push(S);let ne=Promise.resolve(L);for(;b.length;)ne=ne.then(b.shift());return f.isReady=ne.catch(B)}).bind(s),scriptInfo:void 0};typeof o<"u"&&(L.__isUnderTest=!!o);try{s.initializers.forEach(f=>{f(L)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}if(delete s.initializers,s.sqlite3=L,typeof e<"u"&&(e.debugModule("sqlite3ApiBootstrap() complete",L),L.scriptInfo=e),L.__isUnderTest){typeof t<"u"&&(L.config.emscripten=t);const f=L.scriptInfo?.instantiateWasm;f&&(L.wasm.module=f.module,L.wasm.instance=f.instance,L.wasm.imports=f.imports)}return delete globalThis.sqlite3ApiConfig,delete globalThis.sqlite3ApiBootstrap,delete s.defaultConfig,L.asyncPostInit().then(f=>(typeof e<"u"&&e.debugModule("sqlite3.asyncPostInit() complete",f),delete f.asyncPostInit,delete f.scriptInfo,delete f.emscripten,f))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.sqlite3ApiBootstrap.initializers.push(function(s){s.version={libVersion:"3.52.0",libVersionNumber:3052e3,sourceId:"2026-01-30 06:37:34 407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",downloadVersion:352e4,scm:{"sha3-256":"407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",branch:"trunk",tags:"",datetime:"2026-01-30T06:37:34.096Z"}}}),globalThis.WhWasmUtilInstaller=function(n){n.bigIntEnabled===void 0&&(n.bigIntEnabled=!!globalThis.BigInt64Array);const i=(...a)=>{throw new Error(a.join(" "))};if(!n.pointerSize&&!n.pointerIR&&n.alloc&&n.dealloc){const a=n.alloc(1);n.pointerSize=typeof a=="bigint"?8:4,n.dealloc(a)}n.pointerSize&&!n.pointerIR&&(n.pointerIR=n.pointerSize===4?"i32":"i64");const r=n.pointerIR??="i32",c=n.pointerSize??=r==="i32"?4:r==="i64"?8:0;delete n.pointerSize,delete n.pointerIR,r!=="i32"&&r!=="i64"?i("Invalid pointerIR:",r):c!==8&&c!==4&&i("Invalid pointerSize:",c);const P=n.bigIntEnabled?a=>BigInt(a||0):a=>i("BigInt support is disabled in this build."),Z=c===4?a=>Number(a||0):P,D=Z(0),$=function(...a){let _=Z(0);for(const p of a)_+=Z(p);return _};{const a=Object.create(null);Object.defineProperty(n,"ptr",{enumerable:!0,get:()=>a,set:()=>i("The ptr property is read-only.")}),(function _(p,T){return Object.defineProperty(a,p,{enumerable:!0,get:()=>T,set:()=>i("ptr["+p+"] is read-only.")}),_})("null",D)("size",c)("ir",r)("coerce",Z)("add",$)("addn",r===4?$:(..._)=>Number($(..._)))}n.exports||Object.defineProperty(n,"exports",{enumerable:!0,configurable:!0,get:()=>n.instance?.exports});const m=Object.create(null);m.heapSize=0,m.memory=null,m.freeFuncIndexes=[],m.scopedAlloc=[],m.scopedAlloc.pushPtr=a=>(m.scopedAlloc[m.scopedAlloc.length-1].push(a),a),m.utf8Decoder=new TextDecoder,m.utf8Encoder=new TextEncoder("utf-8"),n.sizeofIR=a=>{switch(a){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return c;default:return(""+a).endsWith("*")?c:void 0}};const W=function(){if(!m.memory)m.memory=n.memory instanceof WebAssembly.Memory?n.memory:n.exports.memory;else if(m.heapSize===m.memory.buffer.byteLength)return m;const a=m.memory.buffer;return m.HEAP8=new Int8Array(a),m.HEAP8U=new Uint8Array(a),m.HEAP16=new Int16Array(a),m.HEAP16U=new Uint16Array(a),m.HEAP32=new Int32Array(a),m.HEAP32U=new Uint32Array(a),m.HEAP32F=new Float32Array(a),m.HEAP64F=new Float64Array(a),n.bigIntEnabled&&(typeof BigInt64Array<"u"?(m.HEAP64=new BigInt64Array(a),m.HEAP64U=new BigUint64Array(a)):i("BigInt support is enabled, but the BigInt64Array type is missing.")),m.heapSize=a.byteLength,m};n.heap8=()=>W().HEAP8,n.heap8u=()=>W().HEAP8U,n.heap16=()=>W().HEAP16,n.heap16u=()=>W().HEAP16U,n.heap32=()=>W().HEAP32,n.heap32u=()=>W().HEAP32U,n.heapForSize=function(a,_=!0){const p=m.memory&&m.heapSize===m.memory.buffer.byteLength?m:W();switch(a){case Int8Array:return p.HEAP8;case Uint8Array:return p.HEAP8U;case Int16Array:return p.HEAP16;case Uint16Array:return p.HEAP16U;case Int32Array:return p.HEAP32;case Uint32Array:return p.HEAP32U;case 8:return _?p.HEAP8U:p.HEAP8;case 16:return _?p.HEAP16U:p.HEAP16;case 32:return _?p.HEAP32U:p.HEAP32;case 64:if(p.HEAP64)return _?p.HEAP64U:p.HEAP64;break;default:if(n.bigIntEnabled){if(a===globalThis.BigUint64Array)return p.HEAP64U;if(a===globalThis.BigInt64Array)return p.HEAP64;break}}i("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const M=n.functionTable;delete n.functionTable,n.functionTable=M?()=>M:()=>n.exports.__indirect_function_table,n.functionEntry=function(a){const _=n.functionTable();return a<_.length?_.get(Z(a)):void 0},n.jsFuncToWasm=function a(_,p){if(a._||(a._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:r,P:r,s:r,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(j,g,N)=>{N<128?j[g](N):j[g](N%128|128,N>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:j=>{const g=a._.rxJSig.exec(j);return g?g[2]:j.substr(1)},letterType:j=>a._.sigTypes[j]||i("Invalid signature letter:",j),pushSigType:(j,g)=>j.push(a._.typeCodes[a._.letterType(g)])}),typeof _=="string"){const j=p;p=_,_=j}const T=a._,V=T.sigParams(p),Y=[1,96];T.uleb128Encode(Y,"push",V.length);for(const j of V)T.pushSigType(Y,j);return p[0]==="v"?Y.push(0):(Y.push(1),T.pushSigType(Y,p[0])),T.uleb128Encode(Y,"unshift",Y.length),Y.unshift(0,97,115,109,1,0,0,0,1),Y.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(Y)),{e:{f:_}}).exports.f};const se=function(_,p,T){if(T&&!m.scopedAlloc.length&&i("No scopedAllocPush() scope is active."),typeof _=="string"){const g=p;p=_,_=g}(typeof p!="string"||!(_ instanceof Function))&&i("Invalid arguments: expecting (function,signature) or (signature,function).");const V=n.functionTable(),Y=Z(V.length);let j;for(;(j=m.freeFuncIndexes.pop())&&V.get(j);){j=null;continue}j||(j=Z(Y),V.grow(Z(1)));try{return V.set(j,_),T&&m.scopedAlloc.pushPtr(j),j}catch(g){if(!(g instanceof TypeError))throw j===Y&&m.freeFuncIndexes.push(Y),g}try{const g=n.jsFuncToWasm(_,p);V.set(j,g),T&&m.scopedAlloc.pushPtr(j)}catch(g){throw j===Y&&m.freeFuncIndexes.push(Y),g}return j};n.installFunction=(a,_)=>se(a,_,!1),n.scopedInstallFunction=(a,_)=>se(a,_,!0),n.uninstallFunction=function(a){if(!a&&D!==a)return;const _=n.functionTable();m.freeFuncIndexes.push(a);const p=_.get(a);return _.set(a,null),p},n.peek=function(_,p="i8"){p.endsWith("*")&&(p=r);const T=m.memory&&m.heapSize===m.memory.buffer.byteLength?m:W(),V=Array.isArray(_)?[]:void 0;let Y;do{switch(V&&(_=arguments[0].shift()),p){case"i1":case"i8":Y=T.HEAP8[Number(_)>>0];break;case"i16":Y=T.HEAP16[Number(_)>>1];break;case"i32":Y=T.HEAP32[Number(_)>>2];break;case"float":case"f32":Y=T.HEAP32F[Number(_)>>2];break;case"double":case"f64":Y=Number(T.HEAP64F[Number(_)>>3]);break;case"i64":if(T.HEAP64){Y=P(T.HEAP64[Number(_)>>3]);break}default:i("Invalid type for peek():",p)}V&&V.push(Y)}while(V&&arguments[0].length);return V||Y},n.poke=function(a,_,p="i8"){p.endsWith("*")&&(p=r);const T=m.memory&&m.heapSize===m.memory.buffer.byteLength?m:W();for(const V of Array.isArray(a)?a:[a])switch(p){case"i1":case"i8":T.HEAP8[Number(V)>>0]=_;continue;case"i16":T.HEAP16[Number(V)>>1]=_;continue;case"i32":T.HEAP32[Number(V)>>2]=_;continue;case"float":case"f32":T.HEAP32F[Number(V)>>2]=_;continue;case"double":case"f64":T.HEAP64F[Number(V)>>3]=_;continue;case"i64":if(T.HEAP64){T.HEAP64[Number(V)>>3]=P(_);continue}default:i("Invalid type for poke(): "+p)}return this},n.peekPtr=(...a)=>n.peek(a.length===1?a[0]:a,r),n.pokePtr=(a,_=0)=>n.poke(a,_,r),n.peek8=(...a)=>n.peek(a.length===1?a[0]:a,"i8"),n.poke8=(a,_)=>n.poke(a,_,"i8"),n.peek16=(...a)=>n.peek(a.length===1?a[0]:a,"i16"),n.poke16=(a,_)=>n.poke(a,_,"i16"),n.peek32=(...a)=>n.peek(a.length===1?a[0]:a,"i32"),n.poke32=(a,_)=>n.poke(a,_,"i32"),n.peek64=(...a)=>n.peek(a.length===1?a[0]:a,"i64"),n.poke64=(a,_)=>n.poke(a,_,"i64"),n.peek32f=(...a)=>n.peek(a.length===1?a[0]:a,"f32"),n.poke32f=(a,_)=>n.poke(a,_,"f32"),n.peek64f=(...a)=>n.peek(a.length===1?a[0]:a,"f64"),n.poke64f=(a,_)=>n.poke(a,_,"f64"),n.getMemValue=n.peek,n.getPtrValue=n.peekPtr,n.setMemValue=n.poke,n.setPtrValue=n.pokePtr,n.isPtr32=a=>typeof a=="number"&&a>=0&&a===(a|0),n.isPtr64=a=>typeof a=="bigint"?a>=0:n.isPtr32(a),n.isPtr=c===4?n.isPtr32:n.isPtr64,n.cstrlen=function(a){if(!a||!n.isPtr(a))return null;a=Number(a);const _=W().HEAP8U;let p=a;for(;_[p]!==0;++p);return p-a};const q=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,E=a=>a.buffer instanceof q;n.isSharedTypedArray=E;const U=(a,_,p)=>(c===8&&(typeof _=="bigint"&&(_=Number(_)),typeof p=="bigint"&&(p=Number(p))),E(a)?a.slice(_,p):a.subarray(_,p));n.typedArrayPart=U;const Q=(a,_,p)=>m.utf8Decoder.decode(U(a,_,p));n.typedArrayToString=Q,n.cstrToJs=function(a){const _=n.cstrlen(a);return _?Q(W().HEAP8U,Number(a),Number(a)+_):_===null?_:""},n.jstrlen=function(a){if(typeof a!="string")return null;const _=a.length;let p=0;for(let T=0;T<_;++T){let V=a.charCodeAt(T);V>=55296&&V<=57343&&(V=65536+((V&1023)<<10)|a.charCodeAt(++T)&1023),V<=127?++p:V<=2047?p+=2:V<=65535?p+=3:p+=4}return p},n.jstrcpy=function(a,_,p=0,T=-1,V=!0){if((!_||!(_ instanceof Int8Array)&&!(_ instanceof Uint8Array))&&i("jstrcpy() target must be an Int8Array or Uint8Array."),T=Number(T),p=Number(p),T<0&&(T=_.length-p),!(T>0)||!(p>=0))return 0;let Y=0,j=a.length;const g=p,N=p+T-(V?1:0);for(;Y<j&&p<N;++Y){let G=a.charCodeAt(Y);if(G>=55296&&G<=57343&&(G=65536+((G&1023)<<10)|a.charCodeAt(++Y)&1023),G<=127){if(p>=N)break;_[p++]=G}else if(G<=2047){if(p+1>=N)break;_[p++]=192|G>>6,_[p++]=128|G&63}else if(G<=65535){if(p+2>=N)break;_[p++]=224|G>>12,_[p++]=128|G>>6&63,_[p++]=128|G&63}else{if(p+3>=N)break;_[p++]=240|G>>18,_[p++]=128|G>>12&63,_[p++]=128|G>>6&63,_[p++]=128|G&63}}return V&&(_[p++]=0),p-g},n.cstrncpy=function(a,_,p){if((!a||!_)&&i("cstrncpy() does not accept NULL strings."),p<0)p=n.cstrlen(strPtr)+1;else if(!(p>0))return 0;const T=n.heap8u();let V=0,Y;const j=Number(a),g=Number(_);for(;V<p&&(Y=T[g+V]);++V)T[j+V]=Y;return V<p&&(T[j+V++]=0),V},n.jstrToUintArray=(a,_=!1)=>m.utf8Encoder.encode(_?a+"\0":a);const I=(a,_)=>{(!(a.alloc instanceof Function)||!(a.dealloc instanceof Function))&&i("Object is missing alloc() and/or dealloc() function(s)","required by",_+"().")},L=function(a,_,p,T){if(I(n,T),typeof a!="string")return null;const V=m.utf8Encoder.encode(a),Y=p(V.length+1);let j=Y;try{const g=W().HEAP8U;return g.set(V,Number(Y)),g[$(Y,V.length)]=0,j=D,_?[Y,V.length]:Y}finally{j&&n.dealloc(j)}};n.allocCString=(a,_=!1)=>L(a,_,n.alloc,"allocCString()"),n.scopedAllocPush=function(){I(n,"scopedAllocPush");const a=[];return m.scopedAlloc.push(a),a},n.scopedAllocPop=function(a){I(n,"scopedAllocPop");const _=arguments.length?m.scopedAlloc.indexOf(a):m.scopedAlloc.length-1;_<0&&i("Invalid state object for scopedAllocPop()."),arguments.length===0&&(a=m.scopedAlloc[_]),m.scopedAlloc.splice(_,1);for(let p;p=a.pop();)n.functionEntry(p)?n.uninstallFunction(p):n.dealloc(p)},n.scopedAlloc=function(a){m.scopedAlloc.length||i("No scopedAllocPush() scope is active.");const _=Z(n.alloc(a));return m.scopedAlloc.pushPtr(_)},Object.defineProperty(n.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>m.scopedAlloc.length,set:()=>i("The 'active' property is read-only.")}),n.scopedAllocCString=(a,_=!1)=>L(a,_,n.scopedAlloc,"scopedAllocCString()");const f=function(a,_){const p=n[a?"scopedAlloc":"alloc"]((_.length+1)*n.ptr.size);let T=0;return _.forEach(V=>{n.pokePtr($(p,n.ptr.size*T++),n[a?"scopedAllocCString":"allocCString"](""+V))}),n.pokePtr($(p,n.ptr.size*T),0),p};n.scopedAllocMainArgv=a=>f(!0,a),n.allocMainArgv=a=>f(!1,a),n.cArgvToJs=(a,_)=>{const p=[];for(let T=0;T<a;++T){const V=n.peekPtr($(_,n.ptr.size*T));p.push(V?n.cstrToJs(V):null)}return p},n.scopedAllocCall=function(a){n.scopedAllocPush();try{return a()}finally{n.scopedAllocPop()}};const b=function(a,_,p){I(n,p);const T=_?"i64":r;let V=n[p](a*(_?8:c));if(n.poke(V,0,T),a===1)return V;const Y=[V];for(let j=1;j<a;++j)V=$(V,_?8:c),Y[j]=V,n.poke(V,0,T);return Y};n.allocPtr=(a=1,_=!0)=>b(a,_,"alloc"),n.scopedAllocPtr=(a=1,_=!0)=>b(a,_,"scopedAlloc"),n.xGet=function(a){return n.exports[a]||i("Cannot find exported symbol:",a)};const S=(a,_)=>i(a+"() requires",_,"argument(s).");n.xCall=function(a,..._){const p=a instanceof Function?a:n.xGet(a);return p instanceof Function||i("Exported symbol",a,"is not a function."),p.length!==_.length&&S(p===a?p.name:a,p.length),arguments.length===2&&Array.isArray(arguments[1])?p.apply(null,arguments[1]):p.apply(null,_)},m.xWrap=Object.create(null),m.xWrap.convert=Object.create(null),m.xWrap.convert.arg=new Map,m.xWrap.convert.result=new Map;const B=m.xWrap.convert.arg,ne=m.xWrap.convert.result,_e=Z;B.set("i64",P).set("i32",a=>a|0).set("i16",a=>(a|0)&65535).set("i8",a=>(a|0)&255).set("f32",a=>Number(a).valueOf()).set("float",B.get("f32")).set("f64",B.get("f32")).set("double",B.get("f64")).set("int",B.get("i32")).set("null",a=>a).set(null,B.get("null")).set("**",_e).set("*",_e),ne.set("*",_e).set("pointer",_e).set("number",a=>Number(a)).set("void",a=>{}).set(void 0,ne.get("void")).set("null",a=>a).set(null,ne.get("null"));for(const a of["i8","i16","i32","i64","int","f32","float","f64","double"])B.set(a+"*",_e),ne.set(a+"*",_e),ne.set(a,B.get(a)||i("Maintenance required: missing arg converter for",a));const ve=a=>typeof a=="string"?n.scopedAllocCString(a):Z(a);B.set("string",ve).set("utf8",ve),ne.set("string",a=>n.cstrToJs(a)).set("utf8",ne.get("string")).set("string:dealloc",a=>{try{return a?n.cstrToJs(a):null}finally{n.dealloc(a)}}).set("utf8:dealloc",ne.get("string:dealloc")).set("json",a=>JSON.parse(n.cstrToJs(a))).set("json:dealloc",a=>{try{return a?JSON.parse(n.cstrToJs(a)):null}finally{n.dealloc(a)}});const Ie=class{constructor(a){this.name=a.name||"unnamed adapter"}convertArg(a,_,p){i("AbstractArgAdapter must be subclassed.")}};B.FuncPtrAdapter=class gt extends Ie{constructor(_){super(_),B.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",_),this.name=_.name||"unnamed",this.signature=_.signature,_.contextKey instanceof Function&&(this.contextKey=_.contextKey,_.bindScope||(_.bindScope="context")),this.bindScope=_.bindScope||i("FuncPtrAdapter options requires a bindScope (explicit or implied)."),gt.bindScopes.indexOf(_.bindScope)<0&&i("Invalid options.bindScope ("+_.bindMod+") for FuncPtrAdapter. Expecting one of: ("+gt.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=_.callProxy instanceof Function?_.callProxy:void 0}contextKey(_,p){return this}contextMap(_){const p=this.__cmap||(this.__cmap=new Map);let T=p.get(_);return T===void 0&&p.set(_,T=[]),T}convertArg(_,p,T){let V=this.singleton;if(!V&&this.isContext&&(V=this.contextMap(this.contextKey(p,T))),V&&V.length===2&&V[0]===_)return V[1];if(_ instanceof Function){this.callProxy&&(_=this.callProxy(_));const Y=se(_,this.signature,this.isTransient);if(gt.debugFuncInstall&&gt.debugOut("FuncPtrAdapter installed",this,this.contextKey(p,T),"@"+Y,_),V){if(V[1]){gt.debugFuncInstall&&gt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(p,T),"@"+V[1],_);try{m.scopedAlloc.pushPtr(V[1])}catch{}}V[0]=arguments[0]||D,V[1]=Y}return Y}else if(n.isPtr(_)||_===null||_===void 0){if(V&&V[1]&&V[1]!==_){gt.debugFuncInstall&&gt.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(p,T),"@"+V[1],_);try{m.scopedAlloc.pushPtr(V[1])}catch{}V[0]=V[1]=_||D}return _||D}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},B.FuncPtrAdapter.warnOnUse=!1,B.FuncPtrAdapter.debugFuncInstall=!1,B.FuncPtrAdapter.debugOut=console.debug.bind(console),B.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const be=a=>B.get(a)||i("Argument adapter not found:",a),X=a=>ne.get(a)||i("Result adapter not found:",a);m.xWrap.convertArg=(a,..._)=>be(a)(..._),m.xWrap.convertArgNoCheck=(a,..._)=>B.get(a)(..._),m.xWrap.convertResult=(a,_)=>a===null?_:a?X(a)(_):void 0,m.xWrap.convertResultNoCheck=(a,_)=>a===null?_:a?ne.get(a)(_):void 0,n.xWrap=function a(_,p,...T){arguments.length===3&&Array.isArray(arguments[2])&&(T=arguments[2]),n.isPtr(_)&&(_=n.functionEntry(_)||i("Function pointer not found in WASM function table."));const V=_ instanceof Function,Y=V?_:n.xGet(_);if(V&&(_=Y.name||"unnamed function"),T.length!==Y.length&&S(_,Y.length),Y.length===0&&(p===null||p==="null"))return Y;X(p);for(const g of T)g instanceof Ie?B.set(g,(...N)=>g.convertArg(...N)):be(g);const j=m.xWrap;return Y.length===0?(...g)=>g.length?S(_,Y.length):j.convertResult(p,Y.call(null)):function(...g){g.length!==Y.length&&S(_,Y.length);const N=n.scopedAllocPush();try{let G=0;for(a.debug&&console.debug("xWrap() preparing: resultType ",p,"xf",Y,"argTypes",T,"args",g);G<g.length;++G)g[G]=j.convertArgNoCheck(T[G],g[G],g,G);return a.debug&&console.debug("xWrap() calling: resultType ",p,"xf",Y,"argTypes",T,"args",g),j.convertResultNoCheck(p,Y.apply(null,g))}finally{n.scopedAllocPop(N)}}};const w=function(a,_,p,T,V,Y){if(typeof p=="string"){if(_===1)return Y.get(p);if(_===2){if(T)T instanceof Function||i(V,"requires a function argument.");else return Y.delete(p),a;return Y.set(p,T),a}}i("Invalid arguments to",V)};return n.xWrap.resultAdapter=function a(_,p){return w(a,arguments.length,_,p,"resultAdapter()",ne)},n.xWrap.argAdapter=function a(_,p){return w(a,arguments.length,_,p,"argAdapter()",B)},n.xWrap.FuncPtrAdapter=B.FuncPtrAdapter,n.xCallWrapped=function(a,_,p,...T){return Array.isArray(arguments[3])&&(T=arguments[3]),n.xWrap(a,_,p||[]).apply(null,T||[])},n.xWrap.testConvertArg=m.xWrap.convertArg,n.xWrap.testConvertResult=m.xWrap.convertResult,n},globalThis.WhWasmUtilInstaller.yawl=(function(n){const i=()=>fetch(n.uri,{credentials:"same-origin"}),r=this,c=function(P){if(n.wasmUtilTarget){const R=(...D)=>{throw new Error(D.join(" "))},Z=n.wasmUtilTarget;if(Z.module=P.module,Z.instance=P.instance,Z.instance.exports.memory||(Z.memory=n?.imports?.env?.memory||R("Missing 'memory' object!")),!Z.alloc&&P.instance.exports.malloc){const D=P.instance.exports;Z.alloc=function($){return D.malloc($)||R("Allocation of",$,"bytes failed.")},Z.dealloc=function($){$&&D.free($)}}r(Z)}return P.config=n,n.onload&&n.onload(P),P};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(i(),n.imports||{}).then(c):()=>i().then(P=>P.arrayBuffer()).then(P=>WebAssembly.instantiate(P,n.imports||{})).then(c)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function s(n){const i=(...O)=>{throw new Error(O.join(" "))};{let O=n.heap;O instanceof WebAssembly.Memory?O=(function(){return new Uint8Array(this.buffer)}).bind(O):O instanceof Function||i("config.heap must be WebAssembly.Memory instance or","a function which returns one."),n.heap=O}["alloc","dealloc"].forEach(function(O){n[O]instanceof Function||i("Config option '"+O+"' must be a function.")});const r=s,c=n.heap,P=n.alloc,R=n.dealloc;n.realloc;const Z=n.log||console.debug.bind(console),D=n.memberPrefix||"",$=n.memberSuffix||"",m=globalThis.BigInt,W=globalThis.BigInt64Array,M=n.bigIntEnabled??!!W;let se;const q=n.pointerSize||n.ptrSize||(typeof(se=P(1))=="bigint"?8:4),E=n.pointerIR||n.ptrIR||(q===4?"i32":"i64");se&&(R(se),se=void 0),q!==4&&q!==8&&i("Invalid pointer size:",q),E!=="i32"&&E!=="i64"&&i("Invalid pointer representation:",E);const U=M&&m?O=>m(O||0):O=>i("BigInt support is disabled in this build."),Q=E=="i32"?Number:U,I=Q(0),L=function(...O){let K=I;for(let ee=0;ee<O.length;++ee)K+=Q(O[ee]);return K},f=function(...O){return L(this.pointer,...O)};r.debugFlags||(r.__makeDebugFlags=function(O=null){O&&O.__flags&&(O=O.__flags);const K=function ee(le){return arguments.length===0?ee.__flags:(le<0?(delete ee.__flags.getter,delete ee.__flags.setter,delete ee.__flags.alloc,delete ee.__flags.dealloc):(ee.__flags.getter=(1&le)!==0,ee.__flags.setter=(2&le)!==0,ee.__flags.alloc=(4&le)!==0,ee.__flags.dealloc=(8&le)!==0),ee._flags)};return Object.defineProperty(K,"__flags",{iterable:!1,writable:!1,value:Object.create(O)}),O||K(0),K},r.debugFlags=r.__makeDebugFlags());const b=!0,S=O=>O[1]==="(",B=O=>O==="p"||O==="P"||O==="s",ne=O=>O==="P",_e=O=>O?S(O)?"p":O[0]:void 0,ve=function(O){switch(_e(O)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return E;case"j":return"i64";case"f":return"float";case"d":return"double"}i("Unhandled signature IR:",O)},Ie=function(O){switch(_e(O)){case"c":case"C":return 1;case"i":return 4;case"p":case"P":case"s":return q;case"j":return 8;case"f":return 4;case"d":return 8}i("Unhandled signature sizeof:",O)},be=W?()=>!0:()=>i("BigInt64Array is not available."),X=function(O){switch(_e(O)){case"p":case"P":case"s":switch(q){case 4:return"getInt32";case 8:return be()&&"getBigInt64"}break;case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return be()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}i("Unhandled DataView getter for signature:",O)},w=function(O){switch(_e(O)){case"p":case"P":case"s":switch(q){case 4:return"setInt32";case 8:return be()&&"setBigInt64"}break;case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return be()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}i("Unhandled DataView setter for signature:",O)},a=function(O){switch(_e(O)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return U;case"p":case"P":case"s":switch(q){case 4:return Number;case 8:return U}break}i("Unhandled DataView set wrapper for signature:",O)},_=(O,K)=>O+"::"+K,p=function(O,K){return()=>i(_(O,K),"is read-only.")},T=function O(K,ee=!0){let le=O.map.get(K);return!le&&ee&&O.map.set(K,le=O.create(K)),le};T.map=new WeakMap,T.create=O=>Object.assign(Object.create(null),{o:O,p:void 0,ownsPointer:!1,zod:!1,xb:0});const V=O=>T.map.delete(O),Y=O=>typeof O=="number"&&O===(O|0)&&O>=0,g=q===4?Y:O=>typeof O=="bigint"&&O>=0||Y(O),N=O=>g(O)&&O>0,G=function(O,K,ee){const le=T(K,!1);if(le){if(V(K),!ee&&!(ee=le.p)){console.warn("Cannot(?) happen: __freeStruct() found no instanceInfo");return}if(Array.isArray(K.ondispose)){let ye;for(;ye=K.ondispose.pop();)try{ye instanceof Function?ye.call(K):ye instanceof st?ye.dispose():g(ye)&&R(ye)}catch(xe){console.warn("ondispose() for",O.structName,"@",ee,"threw. NOT propagating it.",xe)}}else if(K.ondispose instanceof Function)try{K.ondispose()}catch(ye){console.warn("ondispose() for",O.structName,"@",ee,"threw. NOT propagating it.",ye)}delete K.ondispose,O.debugFlags.__flags.dealloc&&Z("debug.dealloc:",le.ownsPointer?"":"EXTERNAL",O.structName,"instance:",O.structInfo.sizeof,"bytes @"+ee),le.ownsPointer&&((le.zod||O.structInfo.zeroOnDispose)&&c().fill(0,Number(ee),Number(ee)+O.structInfo.sizeof+le.xb),R(ee))}},oe=()=>({configurable:!1,writable:!1,iterable:!1}),y=O=>({...oe(),value:O}),x=function(K,ee,le){let ye;const xe=Ce=>{N(Ce)||i("Invalid pointer value",arguments[0],"for",K.structName,"constructor.")};arguments.length>=3?le&&typeof le=="object"?(ye=le,le=ye?.wrap):(xe(le),ye={wrap:le}):ye={};const We=!le;let Je=0,Ke=!1;if(le)xe(le),Ke=!!ye?.takeOwnership;else{const Ce=ye?.extraBytes??0;(Ce<0||Ce!==(Ce|0))&&i("Invalid extraBytes value:",ye?.extraBytes),Je=K.structInfo.sizeof+Ce,le=P(Je)||i("Allocation of",K.structName,"structure failed."),Ke=!0}try{ye?.debugFlags&&ee.debugFlags(ye.debugFlags),K.debugFlags.__flags.alloc&&Z("debug.alloc:",We?"":"EXTERNAL",K.structName,"instance:",K.structInfo.sizeof,"bytes @"+le),We&&c().fill(0,Number(le),Number(le)+Je);const Ce=T(ee);Ce.p=le,Ce.ownsPointer=Ke,Ce.xb=Je?Je-K.structInfo.sizeof:0,Ce.zod=!!ye?.zeroOnDispose,ye?.ondispose&&ye.ondispose!==le&&ee.addOnDispose(ye.ondispose)}catch(Ce){throw G(K,ee,le),Ce}},J=function O(K){return O.rxSig1??=/^[ipPsjfdcC]$/,O.rxSig2??=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/,O.rxSig1.test(K)||O.rxSig2.test(K)},ae=(function(O){let K=this.get(O);return K||(K=[Object.create(null),Object.create(null),Object.create(null)],this.set(O,K)),K}).bind(new WeakMap),re=function(O,K,ee,le){const ye=ae(O)[K];return arguments.length===3?ye[ee]:le?ye[ee]=le:delete ye[ee]},pe=function(O,...K){return re(this,0,O,...K)},we=function(O,K){J(K)&&i(O,"(",K,") collides with a data type signature.")},he=function(O,...K){return we("Setter adaptor",O),re(this,1,O,...K)},A=function(O,...K){return we("Struct adaptor",O),re(this,2,O,...K)},C=function(O,K){const ee=typeof K=="string"?re(O,2,K):K;return typeof ee!="object"&&i("Invalid struct mapping object. Arg =",K,JSON.stringify(ee)),ee},H=y(O=>D+O+$),ie=function(O,K,ee=!0){let le=O.members[K];if(!le&&(D||$)){for(const ye of Object.values(O.members))if(ye.key===K){le=ye;break}!le&&ee&&i(_(O.name||O.structName,K),"is not a mapped struct member.")}return le},ue=function O(K,ee,le=!1){O._||(O._=xe=>xe.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const ye=ie(K.structInfo,ee,!0);return le?O._(ye.signature):ye.signature},ge=y(function(){const O=[];for(const K of Object.keys(this.structInfo.members))O.push(this.memberKey(K));return O}),de=new TextDecoder("utf-8"),qe=new TextEncoder,Le=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,De=function(O,K,ee){return q===8&&(K=Number(K),ee=Number(ee)),de.decode(O.buffer instanceof Le?O.slice(K,ee):O.subarray(K,ee))},Oe=function(O,K,ee=!1){const le=ie(O.structInfo,K,ee);return le&&le.signature.length===1&&le.signature[0]==="s"?le:!1},Ge=function(O){O.signature!=="s"&&i("Invalid member type signature for C-string value:",JSON.stringify(O))},at=function(K,ee){const le=ie(K.structInfo,ee,!0);Ge(le);const ye=K[le.key];if(!ye)return null;let xe=ye;const We=c();for(;We[xe]!==0;++xe);return ye===xe?"":De(We,ye,xe)},kt=function(O,...K){O.ondispose?Array.isArray(O.ondispose)||(O.ondispose=[O.ondispose]):O.ondispose=[],O.ondispose.push(...K)},it=function(O){const K=qe.encode(O),ee=P(K.length+1);ee||i("Allocation error while duplicating string:",O);const le=c();return le.set(K,Number(ee)),le[L(ee,K.length)]=0,ee},Ht=function(O,K,ee){const le=ie(O.structInfo,K,!0);Ge(le);const ye=it(ee);return O[le.key]=ye,kt(O,ye),O},st=function(K,ee){arguments[2]!==y&&i("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:y(K),structInfo:y(ee)})};st.prototype=Object.create(null,{dispose:y(function(){G(this.constructor,this)}),lookupMember:y(function(O,K=!0){return ie(this.structInfo,O,K)}),memberToJsString:y(function(O){return at(this,O)}),memberIsString:y(function(O,K=!0){return Oe(this,O,K)}),memberKey:H,memberKeys:ge,memberSignature:y(function(O,K=!1){return ue(this,O,K)}),memoryDump:y(function(){const O=this.pointer;return O?new Uint8Array(c().slice(Number(O),Number(O)+this.structInfo.sizeof)):null}),extraBytes:{configurable:!1,enumerable:!1,get:function(){return T(this,!1)?.xb??0}},zeroOnDispose:{configurable:!1,enumerable:!1,get:function(){return T(this,!1)?.zod??!!this.structInfo.zeroOnDispose}},pointer:{configurable:!1,enumerable:!1,get:function(){return T(this,!1)?.p},set:()=>i("Cannot assign the 'pointer' property of a struct.")},setMemberCString:y(function(O,K){return Ht(this,O,K)})}),Object.assign(st.prototype,{addOnDispose:function(...O){return kt(this,...O),this}}),Object.defineProperties(st,{allocCString:y(it),isA:y(O=>O instanceof st),hasExternalPointer:y(O=>{const K=T(O,!1);return!!(K?.p&&!K?.ownsPointer)}),memberKey:H});const St=function(O){return O.get||(O.adaptGet?et.adaptGet(O.adaptGet):void 0)},on=function(O){return O.set||(O.adaptSet?et.adaptSet(O.adaptSet):void 0)},pr=function O(K,ee,le){const ye=O.innerStructs??=new Map,xe=K.memberKey(ee);le.signature!==void 0&&i("'signature' cannot be used on an embedded struct (",K.structName,".",xe,")."),on(le)&&i("'set' and 'adaptSet' are not permitted for nested struct members."),le.structName??=K.structName+"::"+ee,le.key=xe,le.name=ee,le.constructor=this.call(this,le.structName,le);const We=St(le),Je=Object.assign(Object.create(null),{configurable:!1,enumerable:!1,set:p(K.structName,xe),get:function(){const Ke=this.debugFlags.__flags,Ce=this.pointer,He=Ce+"."+xe;let Ee=ye.get(He);return Ke.getter&&Z("debug.getter: k =",He),Ee||(Ee=new le.constructor(L(Ce,le.offset)),ye.set(He,Ee),this.addOnDispose(()=>Ee.dispose()),Ee.addOnDispose(()=>ye.delete(He))),We&&(Ee=We.apply(this,[Ee,xe])),Ke.getter&&Z("debug.getter: result =",Ee),Ee}});Object.defineProperty(K.prototype,xe,Je)},hr=function O(K,ee,le){if(le=C(this,le),le.members)return pr.call(this,K,ee,le);if(!O.cache){O.cache={getters:{},setters:{},sw:{}};const He=["i","c","C","p","P","s","f","d","v()"];M&&He.push("j"),He.forEach(function(Ee){O.cache.getters[Ee]=X(Ee),O.cache.setters[Ee]=w(Ee),O.cache.sw[Ee]=a(Ee)}),O.sigCheck=function(Ee,Be,an,Wn){Object.prototype.hasOwnProperty.call(Ee,an)&&i(Ee.structName,"already has a property named",an+"."),J(Wn)||i("Malformed signature for",_(Ee.structName,Be)+":",Wn)}}const ye=K.memberKey(ee);O.sigCheck(K.prototype,ee,ye,le.signature),le.key=ye,le.name=ee;const xe=_e(le.signature),We=_(K.structName,ye),Je=K.debugFlags.__flags,Ke=St(le),Ce=Object.create(null);if(Ce.configurable=!1,Ce.enumerable=!1,Ce.get=function(){Je.getter&&Z("debug.getter:",O.cache.getters[xe],"for",ve(xe),We,"@",this.pointer,"+",le.offset,"sz",le.sizeof);let He=new DataView(c().buffer,Number(this.pointer)+le.offset,le.sizeof)[O.cache.getters[xe]](0,b);return Ke&&(He=Ke.apply(this,[ye,He])),Je.getter&&Z("debug.getter:",We,"result =",He),He},le.readOnly)Ce.set=p(K.prototype.structName,ye);else{const He=on(le);Ce.set=function(Ee){Je.setter&&Z("debug.setter:",O.cache.setters[xe],"for",ve(xe),We,"@",this.pointer,"+",le.offset,"sz",le.sizeof,Ee),this.pointer||i("Cannot set native property on a disposed",this.structName,"instance."),He&&(Ee=He.apply(this,[ye,Ee])),Ee==null?Ee=I:B(le.signature)&&!g(Ee)&&(ne(le.signature)&&Ee instanceof st?(Ee=Ee.pointer||I,Je.setter&&Z("debug.setter:",We,"resolved to",Ee)):i("Invalid value for pointer-type",We+".")),new DataView(c().buffer,Number(this.pointer)+le.offset,le.sizeof)[O.cache.setters[xe]](0,O.cache.sw[xe](Ee),b)}}Object.defineProperty(K.prototype,ye,Ce)},zn=function O(K,ee,le=Object.create(null)){const ye=function Ee(Be){this instanceof Ee||i("The",K,"constructor may only be called via 'new'."),x(Ee,this,...arguments)},xe=this,We=Ee=>typeof Ee=="string"&&J(Ee)?{signature:Ee}:C(xe,Ee);arguments.length===1?(ee=We(K),K=ee.structName||ee.name):arguments.length===2?(ee=We(ee),ee.name??=K):ee=We(ee),K??=ee.structName,K??=le.structName,K||i("One of 'name' or 'structName' are required."),ee.adapt&&(Object.keys(ee.adapt.struct||{}).forEach(Ee=>{A.call(O,Ee,ee.adapt.struct[Ee])}),Object.keys(ee.adapt.set||{}).forEach(Ee=>{he.call(O,Ee,ee.adapt.set[Ee])}),Object.keys(ee.adapt.get||{}).forEach(Ee=>{pe.call(O,Ee,ee.adapt.get[Ee])})),!ee.members&&!ee.sizeof&&(ee.sizeof=Ie(ee.signature));const Je=y(r.__makeDebugFlags(et.debugFlags));Object.defineProperties(ye,{debugFlags:Je,isA:y(Ee=>Ee instanceof ye),memberKey:H,memberKeys:ge,structInfo:y(ee),structName:y(K),ptrAdd:y(L)}),ye.prototype=new st(K,ee,y),Object.defineProperties(ye.prototype,{debugFlags:Je,constructor:y(ye),ptrAdd:y(f)});let Ke=!1,Ce=0;const He=!!ee.autoCalcSizeOffset;return He||ee.sizeof||i(K,"description is missing its sizeof property."),ee.offset??=0,Object.keys(ee.members||{}).forEach(Ee=>{let Be=We(ee.members[Ee]);!Be.members&&!Be.sizeof&&(Be.sizeof=Ie(Be.signature),Be.sizeof||i(_(K,Ee),"is missing a sizeof property.",Be)),Be.offset===void 0&&(He?Be.offset=Ce:i(_(K,Ee),"is missing its offset.",JSON.stringify(Be))),ee.members[Ee]=Be,(!Ke||Ke.offset<Be.offset)&&(Ke=Be);const an=!!Be.autoCalc;He&&(Be.autoCalcSizeOffset=!0),hr.call(xe,ye,Ee,Be),an?Be.autoCalcSizeOffset=!0:delete Be.autoCalcSizeOffset,Ce+=Be.sizeof}),Ke||i("No member property descriptions found."),ee.sizeof||(ee.sizeof=Ce),ee.sizeof===1?ee.signature==="c"||ee.signature==="C"||i("Unexpected sizeof==1 member",_(K,k),"with signature",ee.signature):(ee.sizeof%4!==0&&(console.warn("Invalid struct member description",ee),i(K,"sizeof is not aligned. sizeof="+ee.sizeof)),ee.offset%4!==0&&(console.warn("Invalid struct member description",ee),i(K,"offset is not aligned. offset="+ee.offset))),ee.sizeof<Ce&&(console.warn("Suspect struct description:",ee,"offset =",Ce),i("Mismatch in the calculated vs. the provided sizeof/offset info.","Expected sizeof",Ce,"but got",ee.sizeof,"for",ee)),delete ee.autoCalcSizeOffset,ye},et=function O(K,ee){return arguments.length==1?zn.call(O,K):zn.call(O,K,ee)};return et.StructType=st,et.config=n,et.allocCString=it,et.adaptGet=pe,et.adaptSet=he,et.adaptStruct=A,et.ptrAdd=L,et.debugFlags||(et.debugFlags=r.__makeDebugFlags(r.debugFlags)),et},globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...q)=>{throw new Error(q.join(" "))},i=s.capi,r=s.wasm,c=s.util;globalThis.WhWasmUtilInstaller(r),delete globalThis.WhWasmUtilInstaller;const P={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(q,E)=>q[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:q=>q[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new r.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:q=>{let E;return(U,Q,I,L)=>{try{const f=r.cArgvToJs(Q,I);return E||(E=r.cArgvToJs(Q,L)),q(f,E)|0}catch(f){return f.resultCode||i.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_next_stmt","sqlite3_stmt*",["sqlite3*","sqlite3_stmt*"]],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:q=>q[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(q,E)=>q[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:q=>q[0],callProxy:q=>(E,U,Q,I,L)=>{q(E,U,r.cstrToJs(Q),r.cstrToJs(I),L)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(r.exports.sqlite3_progress_handler&&P.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(q,E)=>q[0]}),"*"]]),r.exports.sqlite3_stmt_explain&&P.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),r.exports.sqlite3_set_authorizer&&P.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(q,E)=>q[0],callProxy:q=>(E,U,Q,I,L,f)=>{try{return Q=Q&&r.cstrToJs(Q),I=I&&r.cstrToJs(I),L=L&&r.cstrToJs(L),f=f&&r.cstrToJs(f),q(E,U,Q,I,L,f)|0}catch(b){return b.resultCode||i.SQLITE_ERROR}}}),"*"]]),r.exports.sqlite3_column_origin_name&&P.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),r.bigIntEnabled&&r.exports.sqlite3_declare_vtab&&P.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),r.bigIntEnabled&&r.exports.sqlite3_preupdate_hook&&P.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:q=>q[0],callProxy:q=>(E,U,Q,I,L,f,b)=>{q(E,U,Q,r.cstrToJs(I),r.cstrToJs(L),f,b)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),r.bigIntEnabled&&r.exports.sqlite3changegroup_add&&r.exports.sqlite3session_create&&r.exports.sqlite3_preupdate_hook){const q={signature:"i(ps)",callProxy:E=>(U,Q)=>{try{return E(U,r.cstrToJs(Q))|0}catch(I){return I.resultCode||i.SQLITE_ERROR}}};P.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...q}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...q}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...q}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...q}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xFilter",...q,contextKey:(E,U)=>E[0]}),"*"]])}s.StructBinder=globalThis.Jaccwabyt({heap:r.heap8u,alloc:r.alloc,dealloc:r.dealloc,bigIntEnabled:r.bigIntEnabled,pointerIR:r.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const q=r.xWrap.argAdapter("string");r.xWrap.argAdapter("string:flexible",I=>q(c.flexibleString(I))),r.xWrap.argAdapter("string:static",(function(I){return r.isPtr(I)?I:(I=""+I,this[I]||(this[I]=r.allocCString(I)))}).bind(Object.create(null)));const E=r.xWrap.argAdapter("*"),U=function(){};r.xWrap.argAdapter("sqlite3_filename",E)("sqlite3_context*",E)("sqlite3_value*",E)("void*",E)("sqlite3_changegroup*",E)("sqlite3_changeset_iter*",E)("sqlite3_session*",E)("sqlite3_stmt*",I=>E(I instanceof(s?.oo1?.Stmt||U)?I.pointer:I))("sqlite3*",I=>E(I instanceof(s?.oo1?.DB||U)?I.pointer:I))("sqlite3_vfs*",I=>typeof I=="string"?i.sqlite3_vfs_find(I)||s.SQLite3Error.toss(i.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",I):E(I instanceof(i.sqlite3_vfs||U)?I.pointer:I)),r.exports.sqlite3_declare_vtab&&r.xWrap.argAdapter("sqlite3_index_info*",I=>E(I instanceof(i.sqlite3_index_info||U)?I.pointer:I))("sqlite3_module*",I=>E(I instanceof(i.sqlite3_module||U)?I.pointer:I));const Q=r.xWrap.resultAdapter("*");r.xWrap.resultAdapter("sqlite3*",Q)("sqlite3_context*",Q)("sqlite3_stmt*",Q)("sqlite3_value*",Q)("sqlite3_vfs*",Q)("void*",Q);for(const I of P.core)i[I[0]]=r.xWrap.apply(null,I);for(const I of P.wasmInternal)c[I[0]]=r.xWrap.apply(null,I);for(const I of P.int64)i[I[0]]=r.bigIntEnabled?r.xWrap.apply(null,I):()=>n(I[0]+"() is unavailable due to lack","of BigInt support in this build.");delete P.core,delete P.int64,delete P.wasmInternal,c.sqlite3__wasm_db_error=function(I,L,f){return I?(L instanceof s.WasmAllocError?(L=i.SQLITE_NOMEM,f=0):L instanceof Error&&(f=f||""+L,L=L.resultCode||i.SQLITE_ERROR),i.sqlite3_set_errmsg(I,L,f)||L):i.SQLITE_MISUSE}}{const q=r.xCall("sqlite3__wasm_enum_json");q||n("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),r.ctype=JSON.parse(r.cstrToJs(q));const E=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];r.bigIntEnabled&&E.push("serialize","session","vtab");for(const I of E)for(const L of Object.entries(r.ctype[I]))i[L[0]]=L[1];r.functionEntry(i.SQLITE_WASM_DEALLOC)||n("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+i.SQLITE_WASM_DEALLOC+").");const U=Object.create(null);for(const I of Object.entries(r.ctype.resultCodes))U[I[1]]=I[0];i.sqlite3_js_rc_str=I=>U[I];const Q=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_index_info:!r.bigIntEnabled,sqlite3_index_constraint:!r.bigIntEnabled,sqlite3_index_orderby:!r.bigIntEnabled,sqlite3_index_constraint_usage:!r.bigIntEnabled});for(const I of r.ctype.structs)Q[I.name]||(i[I.name]=s.StructBinder(I));if(i.sqlite3_index_info){for(const I of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])i.sqlite3_index_info[I]=i[I],delete i[I];i.sqlite3_vtab_config=r.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const R=(q,E,U)=>c.sqlite3__wasm_db_error(q,i.SQLITE_MISUSE,E+"() requires "+U+" argument"+(U===1?"":"s")+"."),Z=q=>c.sqlite3__wasm_db_error(q,i.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),D=q=>r.xWrap.argAdapter("sqlite3*")(q),$=q=>r.isPtr(q)?r.cstrToJs(q):q,m=(function(q,E){q=D(q);let U=this.dbMap.get(q);if(E)!U&&E>0&&this.dbMap.set(q,U=Object.create(null));else return this.dbMap.delete(q),U;return U}).bind(Object.assign(Object.create(null),{dbMap:new Map}));m.addCollation=function(q,E){const U=m(q,1);U.collation||(U.collation=new Set),U.collation.add($(E).toLowerCase())},m._addUDF=function(q,E,U,Q){E=$(E).toLowerCase();let I=Q.get(E);I||Q.set(E,I=new Set),I.add(U<0?-1:U)},m.addFunction=function(q,E,U){const Q=m(q,1);Q.udf||(Q.udf=new Map),this._addUDF(q,E,U,Q.udf)},r.exports.sqlite3_create_window_function&&(m.addWindowFunc=function(q,E,U){const Q=m(q,1);Q.wudf||(Q.wudf=new Map),this._addUDF(q,E,U,Q.wudf)}),m.cleanup=function(q){q=D(q);for(const Q of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[I,L]=Q;if(!r.exports[I])continue;const f=[q];f.length=L;try{i[I](...f)}catch(b){s.config.warn("close-time call of",I+"(",f,") threw:",b)}}const E=m(q,0);if(!E)return;if(E.collation){for(const Q of E.collation)try{i.sqlite3_create_collation_v2(q,Q,i.SQLITE_UTF8,0,0,0)}catch{}delete E.collation}let U;for(U=0;U<2;++U){const Q=U?E.wudf:E.udf;if(!Q)continue;const I=U?i.sqlite3_create_window_function:i.sqlite3_create_function_v2;for(const L of Q){const f=L[0],b=L[1],S=[q,f,0,i.SQLITE_UTF8,0,0,0,0,0];U&&S.push(0);for(const B of b)try{S[2]=B,I.apply(null,S)}catch{}b.clear()}Q.clear()}delete E.udf,delete E.wudf};{const q=r.xWrap("sqlite3_close_v2","int","sqlite3*");i.sqlite3_close_v2=function(E){if(arguments.length!==1)return R(E,"sqlite3_close_v2",1);if(E)try{m.cleanup(E)}catch{}return q(E)}}if(i.sqlite3session_create){const q=r.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);i.sqlite3session_delete=function(E){if(arguments.length!==1)return R(pDb,"sqlite3session_delete",1);E&&i.sqlite3session_table_filter(E,0,0),q(E)}}{const q=(U,Q)=>"argv["+Q+"]:"+U[0]+":"+r.cstrToJs(U[1]).toLowerCase(),E=r.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new r.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:q}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:q})]);i.sqlite3_create_collation_v2=function(U,Q,I,L,f,b){if(arguments.length!==6)return R(U,"sqlite3_create_collation_v2",6);if((I&15)===0)I|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(I&15))return Z(U);try{const S=E(U,Q,I,L,f,b);return S===0&&f instanceof Function&&m.addCollation(U,Q),S}catch(S){return c.sqlite3__wasm_db_error(U,S)}},i.sqlite3_create_collation=(U,Q,I,L,f)=>arguments.length===5?i.sqlite3_create_collation_v2(U,Q,I,L,f,0):R(U,"sqlite3_create_collation",5)}{const q=function(I,L){return I[0]+":"+(I[2]<0?-1:I[2])+":"+L+":"+r.cstrToJs(I[1]).toLowerCase()},E=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:q,callProxy:I=>(L,f,b)=>{try{I(L,...i.sqlite3_values_to_js(f,b))}catch(S){i.sqlite3_result_error_js(L,S)}}},xFinalAndValue:{signature:"v(p)",contextKey:q,callProxy:I=>L=>{try{i.sqlite3_result_js(L,I(L))}catch(f){i.sqlite3_result_error_js(L,f)}}},xFunc:{signature:"v(pip)",contextKey:q,callProxy:I=>(L,f,b)=>{try{i.sqlite3_result_js(L,I(L,...i.sqlite3_values_to_js(f,b)))}catch(S){i.sqlite3_result_error_js(L,S)}}},xDestroy:{signature:"v(p)",contextKey:q,callProxy:I=>L=>{try{I(L)}catch(f){console.error("UDF xDestroy method threw:",f)}}}}),U=r.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xFunc",...E.xFunc}),new r.xWrap.FuncPtrAdapter({name:"xStep",...E.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...E.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...E.xDestroy})]),Q=r.exports.sqlite3_create_window_function?r.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xStep",...E.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...E.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xValue",...E.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xInverse",...E.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...E.xDestroy})]):void 0;i.sqlite3_create_function_v2=function I(L,f,b,S,B,ne,_e,ve,Ie){if(I.length!==arguments.length)return R(L,"sqlite3_create_function_v2",I.length);if((S&15)===0)S|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(S&15))return Z(L);try{const be=U(L,f,b,S,B,ne,_e,ve,Ie);return be===0&&(ne instanceof Function||_e instanceof Function||ve instanceof Function||Ie instanceof Function)&&m.addFunction(L,f,b),be}catch(be){return console.error("sqlite3_create_function_v2() setup threw:",be),c.sqlite3__wasm_db_error(L,be,"Creation of UDF threw: "+be)}},i.sqlite3_create_function=function I(L,f,b,S,B,ne,_e,ve){return I.length===arguments.length?i.sqlite3_create_function_v2(L,f,b,S,B,ne,_e,ve,0):R(L,"sqlite3_create_function",I.length)},Q?i.sqlite3_create_window_function=function I(L,f,b,S,B,ne,_e,ve,Ie,be){if(I.length!==arguments.length)return R(L,"sqlite3_create_window_function",I.length);if((S&15)===0)S|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(S&15))return Z(L);try{const X=Q(L,f,b,S,B,ne,_e,ve,Ie,be);return X===0&&(ne instanceof Function||_e instanceof Function||ve instanceof Function||Ie instanceof Function||be instanceof Function)&&m.addWindowFunc(L,f,b),X}catch(X){return console.error("sqlite3_create_window_function() setup threw:",X),c.sqlite3__wasm_db_error(L,X,"Creation of UDF threw: "+X)}}:delete i.sqlite3_create_window_function,i.sqlite3_create_function_v2.udfSetResult=i.sqlite3_create_function.udfSetResult=i.sqlite3_result_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetResult=i.sqlite3_result_js),i.sqlite3_create_function_v2.udfConvertArgs=i.sqlite3_create_function.udfConvertArgs=i.sqlite3_values_to_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfConvertArgs=i.sqlite3_values_to_js),i.sqlite3_create_function_v2.udfSetError=i.sqlite3_create_function.udfSetError=i.sqlite3_result_error_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetError=i.sqlite3_result_error_js)}{const q=(U,Q)=>(typeof U=="string"?Q=-1:c.isSQLableTypedArray(U)?(Q=U.byteLength,U=r.typedArrayToString(U instanceof ArrayBuffer?new Uint8Array(U):U)):Array.isArray(U)&&(U=U.join(""),Q=-1),[U,Q]),E={basic:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};i.sqlite3_prepare_v3=function U(Q,I,L,f,b,S){if(U.length!==arguments.length)return R(Q,"sqlite3_prepare_v3",U.length);const[B,ne]=q(I,Number(L));switch(typeof B){case"string":return E.basic(Q,B,ne,f,b,null);case typeof r.ptr.null:return E.full(Q,r.ptr.coerce(B),ne,f,b,S);default:return c.sqlite3__wasm_db_error(Q,i.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof B)}},i.sqlite3_prepare_v2=function U(Q,I,L,f,b){return U.length===arguments.length?i.sqlite3_prepare_v3(Q,I,L,0,f,b):R(Q,"sqlite3_prepare_v2",U.length)}}{const q=r.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),E=r.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);i.sqlite3_bind_text=function U(Q,I,L,f,b){if(U.length!==arguments.length)return R(i.sqlite3_db_handle(Q),"sqlite3_bind_text",U.length);if(r.isPtr(L)||L===null)return q(Q,I,L,f,b);L instanceof ArrayBuffer?L=new Uint8Array(L):Array.isArray(pMem)&&(L=pMem.join(""));let S,B;try{if(c.isSQLableTypedArray(L))S=r.allocFromTypedArray(L),B=L.byteLength;else if(typeof L=="string")[S,B]=r.allocCString(L);else return c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return q(Q,I,S,B,i.SQLITE_WASM_DEALLOC)}catch(ne){return r.dealloc(S),c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),ne)}},i.sqlite3_bind_blob=function U(Q,I,L,f,b){if(U.length!==arguments.length)return R(i.sqlite3_db_handle(Q),"sqlite3_bind_blob",U.length);if(r.isPtr(L)||L===null)return E(Q,I,L,f,b);L instanceof ArrayBuffer?L=new Uint8Array(L):Array.isArray(L)&&(L=L.join(""));let S,B;try{if(c.isBindableTypedArray(L))S=r.allocFromTypedArray(L),B=f>=0?f:L.byteLength;else if(typeof L=="string")[S,B]=r.allocCString(L);else return c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return E(Q,I,S,B,i.SQLITE_WASM_DEALLOC)}catch(ne){return r.dealloc(S),c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),ne)}}}if(!i.sqlite3_column_text){const q=r.xWrap.argAdapter("sqlite3_stmt*"),E=r.xWrap.argAdapter("int"),U=r.xWrap.argAdapter("sqlite3_value*"),Q=(I,L)=>r.typedArrayToString(r.heap8u(),Number(I),Number(I)+L);i.sqlite3_column_text=function(I,L){const f=q(I),b=E(L),S=r.exports.sqlite3_column_text(f,b);return S?Q(S,r.exports.sqlite3_column_bytes(f,b)):null},i.sqlite3_value_text=function(I){const L=U(I),f=r.exports.sqlite3_value_text(L);return f?Q(f,r.exports.sqlite3_value_bytes(L)):null}}i.sqlite3_config=function(q,...E){if(arguments.length<2)return i.SQLITE_MISUSE;switch(q){case i.SQLITE_CONFIG_COVERING_INDEX_SCAN:case i.SQLITE_CONFIG_MEMSTATUS:case i.SQLITE_CONFIG_SMALL_MALLOC:case i.SQLITE_CONFIG_SORTERREF_SIZE:case i.SQLITE_CONFIG_STMTJRNL_SPILL:case i.SQLITE_CONFIG_URI:return r.exports.sqlite3__wasm_config_i(q,E[0]);case i.SQLITE_CONFIG_LOOKASIDE:return r.exports.sqlite3__wasm_config_ii(q,E[0],E[1]);case i.SQLITE_CONFIG_MEMDB_MAXSIZE:return r.exports.sqlite3__wasm_config_j(q,E[0]);case i.SQLITE_CONFIG_GETMALLOC:case i.SQLITE_CONFIG_GETMUTEX:case i.SQLITE_CONFIG_GETPCACHE2:case i.SQLITE_CONFIG_GETPCACHE:case i.SQLITE_CONFIG_HEAP:case i.SQLITE_CONFIG_LOG:case i.SQLITE_CONFIG_MALLOC:case i.SQLITE_CONFIG_MMAP_SIZE:case i.SQLITE_CONFIG_MULTITHREAD:case i.SQLITE_CONFIG_MUTEX:case i.SQLITE_CONFIG_PAGECACHE:case i.SQLITE_CONFIG_PCACHE2:case i.SQLITE_CONFIG_PCACHE:case i.SQLITE_CONFIG_PCACHE_HDRSZ:case i.SQLITE_CONFIG_PMASZ:case i.SQLITE_CONFIG_SERIALIZED:case i.SQLITE_CONFIG_SINGLETHREAD:case i.SQLITE_CONFIG_SQLLOG:case i.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return i.SQLITE_NOTFOUND}};{const q=new Set;i.sqlite3_auto_extension=function(E){if(E instanceof Function)E=r.installFunction("i(ppp)",E);else if(arguments.length!==1||!r.isPtr(E))return i.SQLITE_MISUSE;const U=r.exports.sqlite3_auto_extension(E);return E!==arguments[0]&&(U===0?q.add(E):r.uninstallFunction(E)),U},i.sqlite3_cancel_auto_extension=function(E){return!E||arguments.length!==1||!r.isPtr(E)?0:r.exports.sqlite3_cancel_auto_extension(E)},i.sqlite3_reset_auto_extension=function(){r.exports.sqlite3_reset_auto_extension();for(const E of q)r.uninstallFunction(E);q.clear()}}r.xWrap.FuncPtrAdapter.warnOnUse=!0;const W=s.StructBinder,M=function q(E,U,Q,I=q.installMethodArgcCheck){if(E instanceof W.StructType?!(Q instanceof Function)&&!r.isPtr(Q)&&n("Usage error: expecting a Function or WASM pointer to one."):n("Usage error: target object is-not-a StructType."),arguments.length===1)return(S,B)=>q(E,S,B,I);q.argcProxy||(q.argcProxy=function(S,B,ne,_e){return function(...ve){return ne.length!==arguments.length&&n("Argument mismatch for",S.structInfo.name+"::"+B+": Native signature is:",_e),ne.apply(this,ve)}},q.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((S,B)=>{if(r.isPtr(S))try{r.uninstallFunction(S)}catch{}}),delete this.ondispose.__removeFuncList)});const L=E.memberSignature(U);L.length<2&&n("Member",U,"does not have a function pointer signature:",L);const f=E.memberKey(U),b=I&&!r.isPtr(Q)?q.argcProxy(E,f,Q,L):Q;if(r.isPtr(b))b&&!r.functionEntry(b)&&n("Pointer",b,"is not a WASM function table entry."),E[f]=b;else{const S=r.installFunction(b,L);E[f]=S,(!E.ondispose||!E.ondispose.__removeFuncList)&&(E.addOnDispose("ondispose.__removeFuncList handler",q.removeFuncList),E.ondispose.__removeFuncList=[]),E.ondispose.__removeFuncList.push(f,S)}return(S,B)=>q(E,S,B,I)};M.installMethodArgcCheck=!1;const se=function(q,E,U=M.installMethodArgcCheck){const Q=new Map;for(const I of Object.keys(E)){const L=E[I],f=Q.get(L);if(f){const b=q.memberKey(I);q[b]=q[q.memberKey(f)]}else M(q,I,L,U),Q.set(L,I)}return q};W.StructType.prototype.installMethod=function(E,U,Q=M.installMethodArgcCheck){return arguments.length<3&&E&&typeof E=="object"?se(this,...arguments):M(this,...arguments)},W.StructType.prototype.installMethods=function(q,E=M.installMethodArgcCheck){return se(this,q,E)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...w)=>{throw new s.SQLite3Error(...w)},i=s.capi,r=s.wasm,c=s.util,P=function(w){return(...a)=>w("sqlite3.oo1:",...a)};s.__isUnderTest?P(console.debug.bind(console)):P(s.config.debug),s.__isUnderTest?P(console.warn.bind(console)):P(s.config.warn),s.__isUnderTest?P(console.error.bind(console)):P(s.config.error);const R=new WeakMap,Z=new Set,D=new WeakMap,$=(w,a,_)=>{const p=Object.getOwnPropertyDescriptor(w,a);return p?p.value:_},m=function(w,a){return a&&(w instanceof q&&(w=w.pointer),n(a,"sqlite3 result code",a+":",w?i.sqlite3_errmsg(w):i.sqlite3_errstr(a))),arguments[0]},W=r.installFunction("i(ippp)",(function(w,a,_,p){i.SQLITE_TRACE_STMT===w&&console.log("SQL TRACE #"+ ++this.counter,"via sqlite3@"+a+"["+i.sqlite3_db_filename(a,null)+"]",r.cstrToJs(p))}).bind({counter:0})),M=Object.create(null),se=function w(...a){const _=w.normalizeArgs(...a);let p;if(p=_["sqlite3*"])_["sqlite3*:takeOwnership"]||Z.add(this),this.filename=i.sqlite3_db_filename(p,"main");else{let T=_.filename,V=_.vfs,Y=_.flags;(typeof T!="string"&&!r.isPtr(T)||typeof Y!="string"||V&&typeof V!="string"&&!r.isPtr(V))&&(s.config.error("Invalid DB ctor args",_,arguments),n("Invalid arguments for DB constructor:",arguments,"opts:",_));let j=0;Y.indexOf("c")>=0&&(j|=i.SQLITE_OPEN_CREATE|i.SQLITE_OPEN_READWRITE),Y.indexOf("w")>=0&&(j|=i.SQLITE_OPEN_READWRITE),j===0&&(j|=i.SQLITE_OPEN_READONLY),j|=i.SQLITE_OPEN_EXRESCODE;const g=r.pstack.pointer;try{const N=r.pstack.allocPtr();let G=i.sqlite3_open_v2(T,N,j,V||r.ptr.null);p=r.peekPtr(N),m(p,G),i.sqlite3_extended_result_codes(p,1),Y.indexOf("t")>=0&&i.sqlite3_trace_v2(p,i.SQLITE_TRACE_STMT,W,p)}catch(N){throw p&&i.sqlite3_close_v2(p),N}finally{r.pstack.restore(g)}this.filename=r.isPtr(T)?r.cstrToJs(T):T}if(R.set(this,p),D.set(this,Object.create(null)),!_["sqlite3*"])try{const T=M[i.sqlite3_js_db_vfs(p)||n("Internal error: cannot get VFS for new db handle.")];T&&(T instanceof Function?T(this,s):m(p,i.sqlite3_exec(p,T,0,0,0)))}catch(T){throw this.close(),T}};se.setVfsPostOpenCallback=function(w,a){a instanceof Function||n("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),M[w]=a},se.normalizeArgs=function(w=":memory:",a="c",_=null){const p={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(p,arguments[0]),p.flags===void 0&&(p.flags="c"),p.vfs===void 0&&(p.vfs=null),p.filename===void 0&&(p.filename=":memory:")):(p.filename=w,p.flags=a,p.vfs=_),p};const q=function(...w){se.apply(this,w)};q.dbCtorHelper=se;const E={null:1,number:2,string:3,boolean:4,blob:5};r.bigIntEnabled&&(E.bigint=E.number);const U=function(){E!==arguments[2]&&n(i.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],R.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&Z.add(this)},Q=function(w){return w.pointer||n("DB has been closed."),w},I=function(w,a){return(a!==(a|0)||a<0||a>=w.columnCount)&&n("Column index",a,"is out of range."),w},L=function(w,a){const _=Object.create(null);switch(_.opt=Object.create(null),a.length){case 1:typeof a[0]=="string"||c.isSQLableTypedArray(a[0])||Array.isArray(a[0])?_.sql=a[0]:a[0]&&typeof a[0]=="object"&&(_.opt=a[0],_.sql=_.opt.sql);break;case 2:_.sql=a[0],_.opt=a[1];break;default:n("Invalid argument count for exec().")}_.sql=c.flexibleString(_.sql),typeof _.sql!="string"&&n("Missing SQL argument or unsupported SQL value type.");const p=_.opt;switch(p.returnValue){case"resultRows":p.resultRows||(p.resultRows=[]),_.returnVal=()=>p.resultRows;break;case"saveSql":p.saveSql||(p.saveSql=[]),_.returnVal=()=>p.saveSql;break;case void 0:case"this":_.returnVal=()=>w;break;default:n("Invalid returnValue value:",p.returnValue)}if(!p.callback&&!p.returnValue&&p.rowMode!==void 0&&(p.resultRows||(p.resultRows=[]),_.returnVal=()=>p.resultRows),p.callback||p.resultRows)switch(p.rowMode===void 0?"array":p.rowMode){case"object":_.cbArg=(T,V)=>{V.columnNames||(V.columnNames=T.getColumnNames([]));const Y=T.get([]),j=Object.create(null);for(const g in V.columnNames)j[V.columnNames[g]]=Y[g];return j};break;case"array":_.cbArg=T=>T.get([]);break;case"stmt":Array.isArray(p.resultRows)&&n("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),_.cbArg=T=>T;break;default:if(c.isInt32(p.rowMode)){_.cbArg=T=>T.get(p.rowMode);break}else if(typeof p.rowMode=="string"&&p.rowMode.length>1&&p.rowMode[0]==="$"){const T=p.rowMode.substr(1);_.cbArg=V=>{const Y=V.get(Object.create(null))[T];return Y===void 0?n(i.SQLITE_NOTFOUND,"exec(): unknown result column:",T):Y};break}n("Invalid rowMode:",p.rowMode)}return _},f=(w,a,_,...p)=>{const T=w.prepare(a);try{const V=T.bind(_).step()?T.get(...p):void 0;return T.reset(),V}finally{T.finalize()}},b=(w,a,_,p)=>w.exec({sql:a,bind:_,rowMode:p,returnValue:"resultRows"});q.checkRc=(w,a)=>m(w,a),q.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return Q(this)},close:function(){const w=this.pointer;if(w){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(D.get(this)).forEach((a,_)=>{if(_&&_.pointer)try{_.finalize()}catch{}}),R.delete(this),D.delete(this),Z.delete(this)||i.sqlite3_close_v2(w),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(w=!1,a=!1){const _=Q(this).pointer;return w?a?i.sqlite3_total_changes64(_):i.sqlite3_total_changes(_):a?i.sqlite3_changes64(_):i.sqlite3_changes(_)},dbFilename:function(w="main"){return i.sqlite3_db_filename(Q(this).pointer,w)},dbName:function(w=0){return i.sqlite3_db_name(Q(this).pointer,w)},dbVfsName:function(w=0){let a;const _=i.sqlite3_js_db_vfs(Q(this).pointer,w);if(_){const p=new i.sqlite3_vfs(_);try{a=r.cstrToJs(p.$zName)}finally{p.dispose()}}return a},prepare:function(w){Q(this);const a=r.pstack.pointer;let _,p;try{_=r.pstack.alloc(8),q.checkRc(this,i.sqlite3_prepare_v2(this.pointer,w,-1,_,null)),p=r.peekPtr(_)}finally{r.pstack.restore(a)}p||n("Cannot prepare empty SQL.");const T=new U(this,p,E);return D.get(this)[p]=T,T},exec:function(){Q(this);const w=L(this,arguments);if(!w.sql)return n("exec() requires an SQL string.");const a=w.opt,_=a.callback,p=Array.isArray(a.resultRows)?a.resultRows:void 0;let T,V=a.bind,Y=!!(w.cbArg||a.columnNames||p);const j=r.scopedAllocPush(),g=Array.isArray(a.saveSql)?a.saveSql:void 0;try{const N=c.isSQLableTypedArray(w.sql);let G=N?w.sql.byteLength:r.jstrlen(w.sql);const oe=r.scopedAlloc(2*r.ptr.size+(G+1)),y=r.ptr.add(oe,r.ptr.size);let x=r.ptr.add(y,r.ptr.size);const J=r.ptr.add(x,G);for(N?r.heap8().set(w.sql,x):r.jstrcpy(w.sql,r.heap8(),x,G,!1),r.poke8(r.ptr.add(x,G),0);x&&r.peek8(x);){r.pokePtr([oe,y],0),q.checkRc(this,i.sqlite3_prepare_v3(this.pointer,x,G,0,oe,y));const ae=r.peekPtr(oe);if(x=r.peekPtr(y),G=Number(r.ptr.add(J,-x)),!!ae){if(g&&g.push(i.sqlite3_sql(ae).trim()),T=new U(this,ae,E),V&&T.parameterCount&&(T.bind(V),V=null),Y&&T.columnCount){let re=Array.isArray(a.columnNames)?0:1;if(Y=!1,w.cbArg||p){const pe=Object.create(null);for(;T.step();ve.delete(T)){re++===0&&T.getColumnNames(pe.columnNames=a.columnNames||[]),ve.add(T);const we=w.cbArg(T,pe);if(p&&p.push(we),_&&_.call(a,we,T)===!1)break}ve.delete(T)}re===0&&T.getColumnNames(a.columnNames)}else T.step();T.reset().finalize(),T=null}}}finally{T&&(ve.delete(T),T.finalize()),r.scopedAllocPop(j)}return w.returnVal()},createFunction:function(a,_,p){const T=pe=>pe instanceof Function;switch(arguments.length){case 1:p=a,a=p.name,_=p.xFunc||0;break;case 2:T(_)||(p=_,_=p.xFunc||0);break}p||(p={}),typeof a!="string"&&n("Invalid arguments: missing function name.");let V=p.xStep||0,Y=p.xFinal||0;const j=p.xValue||0,g=p.xInverse||0;let N;T(_)?(N=!1,(T(V)||T(Y))&&n("Ambiguous arguments: scalar or aggregate?"),V=Y=null):T(V)?(T(Y)||n("Missing xFinal() callback for aggregate or window UDF."),_=null):T(Y)?n("Missing xStep() callback for aggregate or window UDF."):n("Missing function-type properties."),N===!1?(T(j)||T(g))&&n("xValue and xInverse are not permitted for non-window UDFs."):T(j)?(T(g)||n("xInverse must be provided if xValue is."),N=!0):T(g)&&n("xValue must be provided if xInverse is.");const G=p.pApp;G!=null&&!r.isPtr(G)&&n("Invalid value for pApp property. Must be a legal WASM pointer value.");const oe=p.xDestroy||0;oe&&!T(oe)&&n("xDestroy property must be a function.");let y=0;$(p,"deterministic")&&(y|=i.SQLITE_DETERMINISTIC),$(p,"directOnly")&&(y|=i.SQLITE_DIRECTONLY),$(p,"innocuous")&&(y|=i.SQLITE_INNOCUOUS),a=a.toLowerCase();const x=_||V,J=$(p,"arity"),ae=typeof J=="number"?J:x.length?x.length-1:0;let re;return N?re=i.sqlite3_create_window_function(this.pointer,a,ae,i.SQLITE_UTF8|y,G||0,V,Y,j,g,oe):re=i.sqlite3_create_function_v2(this.pointer,a,ae,i.SQLITE_UTF8|y,G||0,_,V,Y,oe),q.checkRc(this,re),this},selectValue:function(w,a,_){return f(this,w,a,0,_)},selectValues:function(w,a,_){const p=this.prepare(w),T=[];try{for(p.bind(a);p.step();)T.push(p.get(0,_));p.reset()}finally{p.finalize()}return T},selectArray:function(w,a){return f(this,w,a,[])},selectObject:function(w,a){return f(this,w,a,{})},selectArrays:function(w,a){return b(this,w,a,"array")},selectObjects:function(w,a){return b(this,w,a,"object")},openStatementCount:function(){return this.pointer?Object.keys(D.get(this)).length:0},transaction:function(w){let a="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&n(i.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),a+=" "+arguments[0],w=arguments[1]),Q(this).exec(a);try{const _=w(this);return this.exec("COMMIT"),_}catch(_){throw this.exec("ROLLBACK"),_}},savepoint:function(w){Q(this).exec("SAVEPOINT oo1");try{const a=w(this);return this.exec("RELEASE oo1"),a}catch(a){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),a}},checkRc:function(w){return m(this,w)}},q.wrapHandle=function(w,a=!1){if(!w||!r.isPtr(w))throw new s.SQLite3Error(i.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new q({"sqlite3*":w,"sqlite3*:takeOwnership":!!a})};const S=function(w){return w.pointer||n("Stmt has been closed."),w},B=function(w){let a=E[w==null?"null":typeof w];switch(a){case E.boolean:case E.null:case E.number:case E.string:return a;case E.bigint:return r.bigIntEnabled?a:void 0;default:return c.isBindableTypedArray(w)?E.blob:void 0}},ne=function(w){return B(w)||n("Unsupported bind() argument type:",typeof w)},_e=function(w,a){const _=typeof a=="number"?a:i.sqlite3_bind_parameter_index(w.pointer,a);return _===0||!c.isInt32(_)?n("Invalid bind() parameter name: "+a):(_<1||_>w.parameterCount)&&n("Bind index",a,"is out of range."),_},ve=new Set,Ie=new Set,be=function(w,a){return ve.has(w)&&n("Operation is illegal when statement is locked:",a),w},X=function w(a,_,p,T){be(S(a),"bind()"),w._||(w._tooBigInt=Y=>n("BigInt value is too big to store without precision loss:",Y),w._={string:function(Y,j,g,N){const[G,oe]=r.allocCString(g,!0);return(N?i.sqlite3_bind_blob:i.sqlite3_bind_text)(Y.pointer,j,G,oe,i.SQLITE_WASM_DEALLOC)}}),ne(T),_=_e(a,_);let V=0;switch(T==null?E.null:p){case E.null:V=i.sqlite3_bind_null(a.pointer,_);break;case E.string:V=w._.string(a,_,T,!1);break;case E.number:{let Y;c.isInt32(T)?Y=i.sqlite3_bind_int:typeof T=="bigint"?c.bigIntFits64(T)?r.bigIntEnabled?Y=i.sqlite3_bind_int64:c.bigIntFitsDouble(T)?(T=Number(T),Y=i.sqlite3_bind_double):w._tooBigInt(T):w._tooBigInt(T):(T=Number(T),r.bigIntEnabled&&Number.isInteger(T)?Y=i.sqlite3_bind_int64:Y=i.sqlite3_bind_double),V=Y(a.pointer,_,T);break}case E.boolean:V=i.sqlite3_bind_int(a.pointer,_,T?1:0);break;case E.blob:{if(typeof T=="string"){V=w._.string(a,_,T,!0);break}else T instanceof ArrayBuffer?T=new Uint8Array(T):c.isBindableTypedArray(T)||n("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const Y=r.alloc(T.byteLength||1);r.heap8().set(T.byteLength?T:[0],Number(Y)),V=i.sqlite3_bind_blob(a.pointer,_,Y,T.byteLength,i.SQLITE_WASM_DEALLOC);break}default:s.config.warn("Unsupported bind() argument type:",T),n("Unsupported bind() argument type: "+typeof T)}return V&&q.checkRc(a.db.pointer,V),a};U.prototype={finalize:function(){const w=this.pointer;if(w){be(this,"finalize()");const a=Z.delete(this)?0:i.sqlite3_finalize(w);return delete D.get(this.db)[w],R.delete(this),ve.delete(this),Ie.delete(this),delete this.parameterCount,delete this.db,a}},clearBindings:function(){return be(S(this),"clearBindings()"),i.sqlite3_clear_bindings(this.pointer),Ie.delete(this),this},reset:function(w){be(this,"reset()"),w&&this.clearBindings();const a=i.sqlite3_reset(S(this).pointer);return Ie.delete(this),m(this.db,a),this},bind:function(){S(this);let w,a;switch(arguments.length){case 1:w=1,a=arguments[0];break;case 2:w=arguments[0],a=arguments[1];break;default:n("Invalid bind() arguments.")}return a===void 0?this:(this.parameterCount||n("This statement has no bindable parameters."),Ie.delete(this),a===null?X(this,w,E.null,a):Array.isArray(a)?(arguments.length!==1&&n("When binding an array, an index argument is not permitted."),a.forEach((_,p)=>X(this,p+1,ne(_),_)),this):(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),typeof a=="object"&&!c.isBindableTypedArray(a)?(arguments.length!==1&&n("When binding an object, an index argument is not permitted."),Object.keys(a).forEach(_=>X(this,_,ne(a[_]),a[_])),this):X(this,w,ne(a),a)))},bindAsBlob:function(w,a){S(this),arguments.length===1&&(a=w,w=1);const _=ne(a);return E.string!==_&&E.blob!==_&&E.null!==_&&n("Invalid value type for bindAsBlob()"),X(this,w,E.blob,a)},step:function(){be(this,"step()");const w=i.sqlite3_step(S(this).pointer);switch(w){case i.SQLITE_DONE:return Ie.delete(this),!1;case i.SQLITE_ROW:return Ie.add(this),!0;default:Ie.delete(this),s.config.warn("sqlite3_step() rc=",w,i.sqlite3_js_rc_str(w),"SQL =",i.sqlite3_sql(this.pointer)),q.checkRc(this.db.pointer,w)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const w=this.step();return this.reset(),w}finally{try{this.finalize()}catch{}}},get:function(w,a){if(Ie.has(S(this))||n("Stmt.step() has not (recently) returned true."),Array.isArray(w)){let _=0;const p=this.columnCount;for(;_<p;)w[_]=this.get(_++);return w}else if(w&&typeof w=="object"){let _=0;const p=this.columnCount;for(;_<p;)w[i.sqlite3_column_name(this.pointer,_)]=this.get(_++);return w}switch(I(this,w),a===void 0?i.sqlite3_column_type(this.pointer,w):a){case i.SQLITE_NULL:return null;case i.SQLITE_INTEGER:if(r.bigIntEnabled){const _=i.sqlite3_column_int64(this.pointer,w);return _>=Number.MIN_SAFE_INTEGER&&_<=Number.MAX_SAFE_INTEGER?Number(_).valueOf():_}else{const _=i.sqlite3_column_double(this.pointer,w);return(_>Number.MAX_SAFE_INTEGER||_<Number.MIN_SAFE_INTEGER)&&n("Integer is out of range for JS integer range: "+_),c.isInt32(_)?_|0:_}case i.SQLITE_FLOAT:return i.sqlite3_column_double(this.pointer,w);case i.SQLITE_TEXT:return i.sqlite3_column_text(this.pointer,w);case i.SQLITE_BLOB:{const _=i.sqlite3_column_bytes(this.pointer,w),p=i.sqlite3_column_blob(this.pointer,w),T=new Uint8Array(_);return _&&(T.set(r.heap8u().slice(Number(p),Number(p)+_),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(T.buffer)),T}default:n("Don't know how to translate","type of result column #"+w+".")}n("Not reached.")},getInt:function(w){return this.get(w,i.SQLITE_INTEGER)},getFloat:function(w){return this.get(w,i.SQLITE_FLOAT)},getString:function(w){return this.get(w,i.SQLITE_TEXT)},getBlob:function(w){return this.get(w,i.SQLITE_BLOB)},getJSON:function(w){const a=this.get(w,i.SQLITE_STRING);return a===null?a:JSON.parse(a)},getColumnName:function(w){return i.sqlite3_column_name(I(S(this),w).pointer,w)},getColumnNames:function(w=[]){I(S(this),0);const a=this.columnCount;for(let _=0;_<a;++_)w.push(i.sqlite3_column_name(this.pointer,_));return w},getParamIndex:function(w){return S(this).parameterCount?i.sqlite3_bind_parameter_index(this.pointer,w):void 0},getParamName:function(w){return S(this).parameterCount?i.sqlite3_bind_parameter_name(this.pointer,w):void 0},isBusy:function(){return i.sqlite3_stmt_busy(S(this))!==0},isReadOnly:function(){return i.sqlite3_stmt_readonly(S(this))!==0}};{const w={enumerable:!0,get:function(){return R.get(this)},set:()=>n("The pointer property is read-only.")};Object.defineProperty(U.prototype,"pointer",w),Object.defineProperty(q.prototype,"pointer",w)}Object.defineProperty(U.prototype,"columnCount",{enumerable:!1,get:function(){return i.sqlite3_column_count(this.pointer)},set:()=>n("The columnCount property is read-only.")}),Object.defineProperty(U.prototype,"parameterCount",{enumerable:!1,get:function(){return i.sqlite3_bind_parameter_count(this.pointer)},set:()=>n("The parameterCount property is read-only.")}),U.wrapHandle=function(w,a,_=!1){if(!(w instanceof q)||!w.pointer)throw new s.SQLite3Error(s.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!a||!r.isPtr(a))throw new s.SQLite3Error(s.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new U(w,a,E,!!_)},s.oo1={DB:q,Stmt:U}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util;s.initWorker1API=(function(){const i=(...W)=>{throw new Error(W.join(" "))};globalThis.WorkerGlobalScope instanceof Function||i("initWorker1API() must be run from a Worker thread.");const r=this.sqlite3||i("Missing this.sqlite3 object."),c=r.oo1.DB,P=function(W){let M=R.idMap.get(W);return M||(M="db#"+ ++R.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),R.idMap.set(W,M),M)},R={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(W){const M=new c(W);return this.dbs[P(M)]=M,this.dbList.indexOf(M)<0&&this.dbList.push(M),M},close:function(W,M){if(W){delete this.dbs[P(W)];const se=W.filename,q=n.sqlite3__wasm_db_vfs(W.pointer,0);W.close();const E=this.dbList.indexOf(W);E>=0&&this.dbList.splice(E,1),M&&se&&q&&n.sqlite3__wasm_vfs_unlink(q,se)}},post:function(W,M){M&&M.length?(globalThis.postMessage(W,Array.from(M)),M.length=0):globalThis.postMessage(W)},dbs:Object.create(null),getDb:function(W,M=!0){return this.dbs[W]||(M?i("Unknown (or closed) DB ID:",W):void 0)}},Z=function(W=R.dbList[0]){return W&&W.pointer?W:i("DB is not opened.")},D=function(W,M=!0){const se=R.getDb(W.dbId,!1)||R.dbList[0];return M?Z(se):se},$=function(){return R.dbList[0]&&P(R.dbList[0])},m={open:function(W){const M=Object.create(null),se=W.args||Object.create(null);se.simulateError&&i("Throwing because of simulateError flag.");const q=Object.create(null);M.vfs=se.vfs,M.filename=se.filename||"";const E=R.open(M);return q.filename=E.filename,q.persistent=!!r.capi.sqlite3_js_db_uses_vfs(E.pointer,"opfs"),q.dbId=P(E),q.vfs=E.dbVfsName(),q},close:function(W){const M=D(W,!1),se={filename:M&&M.filename};if(M){const q=W.args&&typeof W.args=="object"?!!W.args.unlink:!1;R.close(M,q)}return se},exec:function(W){const M=typeof W.args=="string"?{sql:W.args}:W.args||Object.create(null);M.rowMode==="stmt"?i("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):M.sql||i("'exec' requires input SQL.");const se=D(W);(M.callback||Array.isArray(M.resultRows))&&(se._blobXfer=R.xfer);const q=M.callback;let E=0;const U=!!M.columnNames;typeof q=="string"&&(U||(M.columnNames=[]),M.callback=function(Q,I){R.post({type:q,columnNames:M.columnNames,rowNumber:++E,row:Q},R.xfer)});try{const Q=M.countChanges?se.changes(!0,M.countChanges===64):void 0;se.exec(M),Q!==void 0&&(M.changeCount=se.changes(!0,M.countChanges===64)-Q);const I=M.lastInsertRowId?r.capi.sqlite3_last_insert_rowid(se):void 0;I!==void 0&&(M.lastInsertRowId=I),M.callback instanceof Function&&(M.callback=q,R.post({type:q,columnNames:M.columnNames,rowNumber:null,row:void 0}))}finally{delete se._blobXfer,M.callback&&(M.callback=q)}return M},"config-get":function(){const W=Object.create(null),M=r.config;return["bigIntEnabled"].forEach(function(se){Object.getOwnPropertyDescriptor(M,se)&&(W[se]=M[se])}),W.version=r.version,W.vfsList=r.capi.sqlite3_js_vfs_list(),W},export:function(W){const M=D(W),se={byteArray:r.capi.sqlite3_js_db_export(M.pointer),filename:M.filename,mimetype:"application/x-sqlite3"};return R.xfer.push(se.byteArray.buffer),se},toss:function(W){i("Testing worker exception")}};globalThis.onmessage=async function(W){W=W.data;let M,se=W.dbId,q=W.type;const E=performance.now();try{m.hasOwnProperty(q)&&m[q]instanceof Function?M=await m[q](W):i("Unknown db worker message type:",W.type)}catch(U){q="error",M={operation:W.type,message:U.message,errorClass:U.name,input:W},U.stack&&(M.stack=typeof U.stack=="string"?U.stack.split(/\n\s*/):U.stack)}se||(se=M.dbId||$()),R.post({type:q,dbId:se,messageId:W.messageId,workerReceivedTime:E,workerRespondTime:performance.now(),departureTime:W.departureTime,result:M},R.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:s})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.wasm,i=s.capi,r=s.util.toss3,c=Object.create(null);s.vfs=c,i.sqlite3_vfs.prototype.registerVfs=function(P=!1){this instanceof s.capi.sqlite3_vfs||r("Expecting a sqlite3_vfs-type argument.");const R=i.sqlite3_vfs_register(this,P?1:0);return R&&r("sqlite3_vfs_register(",this,") failed with rc",R),this.pointer!==i.sqlite3_vfs_find(this.$zName)&&r("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},c.installVfs=function(P){let R=0;const Z=["io","vfs"];for(const D of Z){const $=P[D];$&&(++R,$.struct.installMethods($.methods,!!$.applyArgcCheck),D==="vfs"&&(!$.struct.$zName&&typeof $.name=="string"&&$.struct.addOnDispose($.struct.$zName=n.allocCString($.name)),$.struct.registerVfs(!!$.asDefault)))}return R||r("Misuse: installVfs() options object requires at least","one of:",Z),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){if(!s.wasm.exports.sqlite3_declare_vtab)return;const n=s.wasm,i=s.capi,r=s.util.toss3,c=Object.create(null);s.vtab=c;const P=i.sqlite3_index_info;P.prototype.nthConstraint=function(D,$=!1){if(D<0||D>=this.$nConstraint)return!1;const m=n.ptr.add(this.$aConstraint,P.sqlite3_index_constraint.structInfo.sizeof*D);return $?m:new P.sqlite3_index_constraint(m)},P.prototype.nthConstraintUsage=function(D,$=!1){if(D<0||D>=this.$nConstraint)return!1;const m=n.ptr.add(this.$aConstraintUsage,P.sqlite3_index_constraint_usage.structInfo.sizeof*D);return $?m:new P.sqlite3_index_constraint_usage(m)},P.prototype.nthOrderBy=function(D,$=!1){if(D<0||D>=this.$nOrderBy)return!1;const m=n.ptr.add(this.$aOrderBy,P.sqlite3_index_orderby.structInfo.sizeof*D);return $?m:new P.sqlite3_index_orderby(m)};const R=function(D,$){return(function(m,W=!1){if(arguments.length===0&&(m=new $),m instanceof $)return this.set(m.pointer,m),m;n.isPtr(m)||s.SQLite3Error.toss("Invalid argument to",D+"()");let M=this.get(m);return W&&this.delete(m),M}).bind(new Map)},Z=function(D,$){const m=R(D,$);return Object.assign(Object.create(null),{StructType:$,create:W=>{const M=m();return n.pokePtr(W,M.pointer),M},get:W=>m(W),unget:W=>m(W,!0),dispose:W=>m(W,!0)?.dispose?.()})};c.xVtab=Z("xVtab",i.sqlite3_vtab),c.xCursor=Z("xCursor",i.sqlite3_vtab_cursor),c.xIndexInfo=D=>new i.sqlite3_index_info(D),c.xError=function D($,m,W){if(D.errorReporter instanceof Function)try{D.errorReporter("sqlite3_module::"+$+"(): "+m.message)}catch{}let M;return m instanceof s.WasmAllocError?M=i.SQLITE_NOMEM:arguments.length>2?M=W:m instanceof s.SQLite3Error&&(M=m.resultCode),M||i.SQLITE_ERROR},c.xError.errorReporter=s.config.error.bind(s.config),c.xRowid=(D,$)=>n.poke(D,$,"i64"),c.setupModule=function(D){let $=!1;const m=this instanceof i.sqlite3_module?this:D.struct||($=new i.sqlite3_module);try{const W=D.methods||r("Missing 'methods' object.");for(const M of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const se=M[0],q=M[1];W[se]===!0?W[se]=W[q]:W[q]===!0&&(W[q]=W[se])}if(D.catchExceptions){const M=function(E,U){return["xConnect","xCreate"].indexOf(E)>=0?function(Q,I,L,f,b,S){try{return U(...arguments)||0}catch(B){return B instanceof s.WasmAllocError||(n.dealloc(n.peekPtr(S)),n.pokePtr(S,n.allocCString(B.message))),c.xError(E,B)}}:function(...Q){try{return U(...Q)||0}catch(I){return c.xError(E,I)}}},se=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],q=Object.create(null);for(const E of se){const U=W[E];if(U instanceof Function)E==="xConnect"&&W.xCreate===U?q[E]=W.xCreate:E==="xCreate"&&W.xConnect===U?q[E]=W.xConnect:q[E]=M(E,U);else continue}m.installMethods(q,!1)}else m.installMethods(W,!!D.applyArgcCheck);if(m.$iVersion===0){let M;typeof D.iVersion=="number"?M=D.iVersion:m.$xIntegrity?M=4:m.$xShadowName?M=3:m.$xSavePoint||m.$xRelease||m.$xRollbackTo?M=2:M=1,m.$iVersion=M}}catch(W){throw $&&$.dispose(),W}return m},i.sqlite3_module.prototype.setupModule=function(D){return c.setupModule.call(this,D)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.capi,i=n.sqlite3_kvvfs_methods,r=n.KVVfsFile,c=s.capi.sqlite3_vfs_find("kvvfs");if(delete n.sqlite3_kvvfs_methods,delete n.KVVfsFile,!c)return;const P=s.util,R=s.wasm,Z=P.toss3,D=(A,C)=>Object.prototype.hasOwnProperty.call(A,C),$=new i(R.exports.sqlite3__wasm_kvvfs_methods());P.assert(32<=$.$nKeySize,"unexpected kvvfsMethods.$nKeySize: "+$.$nKeySize);const m=Object.assign(Object.create(null),{rxJournalSuffix:/-journal$/,zKeyJrnl:R.allocCString("jrnl"),zKeySz:R.allocCString("sz"),keySize:$.$nKeySize,buffer:Object.assign(Object.create(null),{n:$.$nBufferSize,pool:Object.create(null)})});m.memBuffer=(A=0)=>m.buffer.pool[A]??=R.alloc(m.buffer.n),m.memBufferFree=A=>{const C=m.buffer.pool[A];C&&(R.dealloc(C),delete m.buffer.pool[A])};const W=()=>{},M=s.__isUnderTest?(...A)=>s.config.debug("kvvfs:",...A):W,se=(...A)=>s.config.warn("kvvfs:",...A),q=(...A)=>s.config.error("kvvfs:",...A);class E{#e;#r;#a(){return this.#r??=Object.keys(this.#e)}constructor(){this.clear()}key(C){const z=this.#a();return C<z.length?z[C]:null}getItem(C){return this.#e[C]??null}setItem(C,z){D(this.#e,C)||(this.#r=null),this.#e[C]=""+z}removeItem(C){delete this.#e[C]&&(this.#r=null)}clear(){this.#e=Object.create(null),this.#r=null}get length(){return this.#a().length}}const U=A=>A==="local"||A==="session",Q=A=>U(A)?"kvvfs-"+A+"-":"",I=function(A,C=!1){if(U(A))return;const z=new Blob([A]).size;z||Z(n.SQLITE_MISUSE,"Empty name is not permitted.");let H=m.keySize-1;m.rxJournalSuffix.test(A)?C||Z(n.SQLITE_MISUSE,"Storage names may not have a '-journal' suffix."):["-wal","-shm"].filter(ue=>A.endsWith(ue)).length?Z(n.SQLITE_MISUSE,"Storage names may not have a -wal or -shm suffix."):H-=8,z>H&&Z(n.SQLITE_RANGE,"Storage name is too long. Limit =",H);let ie;for(ie=0;ie<z;++ie){const ue=A.codePointAt(ie);ue<32&&Z(n.SQLITE_RANGE,"Illegal character ("+ue+"d) in storage name:",A)}},L=(A,C=void 0)=>Object.assign(Object.create(null),{jzClass:A,refc:1,deleteAtRefc0:!1,storage:C||new E,keyPrefix:Q(A),files:[],listeners:void 0}),f=s.kvvfs=Object.create(null);s.__isUnderTest&&(f.log=Object.assign(Object.create(null),{xOpen:!1,xClose:!1,xWrite:!1,xRead:!1,xSync:!1,xAccess:!1,xFileControl:!1,xRcrdRead:!1,xRcrdWrite:!1,xRcrdDelete:!1}));const b=function(A){const C=m.rxJournalSuffix.test(A.jzClass)?A.jzClass.replace(m.rxJournalSuffix,""):A.jzClass+"-journal";f?.log?.xClose&&M("cleaning up storage handles [",A.jzClass,C,"]",A),delete m.storagePool[A.jzClass],delete m.storagePool[C],s.__isUnderTest||(delete A.storage,delete A.refc)},S=A=>m.storagePool[A.jzClass]=m.storagePool[A.jzClass+"-journal"]=A,B=".";m.storagePool=Object.assign(Object.create(null),{[B]:L(B)}),globalThis.Storage&&(globalThis.localStorage instanceof globalThis.Storage&&(m.storagePool.local=L("local",globalThis.localStorage)),globalThis.sessionStorage instanceof globalThis.Storage&&(m.storagePool.session=L("session",globalThis.sessionStorage))),m.builtinStorageNames=Object.keys(m.storagePool);const ne=A=>m.builtinStorageNames.indexOf(A)>-1;for(const A of Object.keys(m.storagePool)){const C=m.storagePool[A];m.storagePool[A+"-journal"]=C}m.setError=(A=void 0,C=n.SQLITE_ERROR)=>A?(m.lastError=A,A.resultCode|0||C):(delete m.lastError,0),m.popError=()=>{const A=m.lastError;return delete m.lastError,A};const _e=A=>{se("kvvfs.listener handler threw:",A)},ve=R.exports.sqlite3__wasm_kvvfs_decode,Ie=R.exports.sqlite3__wasm_kvvfs_encode,be=async function(A,C,...z){try{C.keyPrefix&&z[0]&&(z[0]=z[0].replace(C.keyPrefix,""));let H,ie,ue,ge;for(const de of C.listeners){const qe=Object.create(null);qe.storageName=C.jzClass,qe.type=A,de.decodePages;const Le=de.events[A];if(Le){if(!de.includeJournal&&z[0]==="jrnl")continue;if(A==="write"&&de.decodePages&&+z[0]>0){if(qe.data=[z[0]],ge?.[z[0]]){qe.data[1]=ge[z[0]];continue}H??=new TextEncoder("utf-8"),ie??=m.memBuffer(10),ue??=m.memBuffer(11);const De=H.encode(z[1]),Oe=R.heap8u();Oe.set(De,Number(ie)),Oe[R.ptr.addn(ie,De.length)]=0;const Ge=ve(ie,ue,m.buffer.n);if(Ge>0)ge??=Object.create(null),ge[z[0]]=qe.data[1]=Oe.slice(Number(ue),R.ptr.addn(ue,Ge));else continue}else qe.data=z.length?z.length===1?z[0]:z:void 0;try{Le(qe)?.catch?.(_e)}catch(De){se("notifyListeners [",C.jzClass,"]",A,De)}}}}catch(H){_e(H)}},X=A=>typeof A=="string"?m.storagePool[A]:m.storagePool[R.cstrToJs(A)],w=R.exports.sqlite3__wasm_kvvfsMakeKey,a=(A,C,z)=>C&&A.keyPrefix?w(C,z):z,_=(A,C,z)=>R.cstrToJs(a(A,C,z)),p=A=>+A.storage.getItem(A.keyPrefix+"sz"),T=new Map,V={vfs:Object.create(null),ioDb:Object.create(null),ioJrnl:Object.create(null)},Y=new n.sqlite3_vfs($.$pVfs),j=new n.sqlite3_io_methods($.$pIoDb),g=new n.sqlite3_io_methods($.$pIoJrnl),N=Object.create(null),G=Object.assign(Object.create(null),{pFileHandles:T,cache:m,storageForZClass:X,KVVfsStorage:E,disablePageSizeChange:!0});f.log&&(f.internal=G);const oe={recordHandler:{xRcrdRead:(A,C,z,H)=>{try{const ie=R.cstrToJs(A),ue=X(ie);if(!ue)return-1;const ge=_(ue,A,C);f?.log?.xRcrdRead&&se("xRcrdRead",ie,ge,H,ue);const de=ue.storage.getItem(ge);if(de===null)return-1;const qe=de.length;if(H<=0)return qe;if(H===1)return R.poke(z,0),qe;H+1<qe&&Z(n.SQLITE_RANGE,"xRcrdRead()",ie,ge,"input buffer is too small: need",qe,"but have",H);const Le=m.memBuffer(0),De=R.heap8();let Oe;for(Oe=0;Oe<qe;++Oe)De[R.ptr.add(Le,Oe)]=de.codePointAt(Oe)&255;return De.copyWithin(Number(z),Number(Le),R.ptr.addn(Le,Oe)),De[R.ptr.add(z,qe)]=0,H}catch(ie){return q("kvrecordRead()",ie),m.setError(ie),-2}},xRcrdWrite:(A,C,z)=>{try{const H=X(A),ie=_(H,A,C),ue=R.cstrToJs(z);return f?.log?.xRcrdWrite&&se("xRcrdWrite",ie,H),H.storage.setItem(ie,ue),H.listeners&&be("write",H,ie,ue),0}catch(H){return q("kvrecordWrite()",H),m.setError(H,n.SQLITE_IOERR)}},xRcrdDelete:(A,C)=>{try{const z=X(A),H=_(z,A,C);return f?.log?.xRcrdDelete&&se("xRcrdDelete",H,z),z.storage.removeItem(H),z.listeners&&be("delete",z,H),0}catch(z){return q("kvrecordDelete()",z),m.setError(z,n.SQLITE_IOERR)}}},vfs:{xOpen:function(A,C,z,H,ie){m.popError();let ue;try{C||(ue=R.allocCString(""+z+"."+(Math.random()*1e5|0)),C=ue);const ge=R.cstrToJs(C);f?.log?.xOpen&&M("xOpen",ge,"flags =",H),I(ge,!0),H&(n.SQLITE_OPEN_MAIN_DB|n.SQLITE_OPEN_TEMP_DB|n.SQLITE_OPEN_TRANSIENT_DB)&&m.rxJournalSuffix.test(ge)&&Z(n.SQLITE_ERROR,"DB files may not have a '-journal' suffix.");let de=X(ge);!de&&!(H&n.SQLITE_OPEN_CREATE)&&Z(n.SQLITE_ERROR,"Storage not found:",ge);const qe=V.vfs.xOpen(A,C,z,H,ie);if(qe)return qe;let Le=!!(n.SQLITE_OPEN_DELETEONCLOSE&H);R.isPtr(arguments[1])&&n.sqlite3_uri_boolean(C,"delete-on-close",0)&&(Le=!0);const De=new r(z);if(P.assert(De.$zClass,"Missing f.$zClass"),De.addOnDispose(ue),ue=void 0,de)++de.refc,de.files.push(De),R.poke32(ie,H);else{R.poke32(ie,H|n.SQLITE_OPEN_CREATE),P.assert(!De.$isJournal,"Opening a journal before its db? "+ge);const Oe=ge.replace(m.rxJournalSuffix,"");de=L(Oe),S(de),de.files.push(De),de.deleteAtRefc0=Le,f?.log?.xOpen&&M("xOpen installed storage handle [",Oe,Oe+"-journal","]",de)}return T.set(z,{store:de,file:De,jzClass:ge}),de.listeners&&be("open",de,de.files.length),0}catch(ge){return se("xOpen:",ge),m.setError(ge)}finally{ue&&R.dealloc(ue)}},xDelete:function(A,C,z){m.popError();try{const H=R.cstrToJs(C);return m.rxJournalSuffix.test(H)&&N.xRcrdDelete(C,m.zKeyJrnl),0}catch(H){return se("xDelete",H),m.setError(H)}},xAccess:function(A,C,z,H){m.popError();try{const ie=X(C),ue=ie?.jzClass||R.cstrToJs(C);if(f?.log?.xAccess&&M("xAccess",ue,"flags =",z,"*pResOut =",R.peek32(H),"store =",ie),!ie)try{I(ue)}catch{return R.poke32(H,0),0}if(ie){const ge=ie.keyPrefix+(m.rxJournalSuffix.test(ue)?"jrnl":"1"),de=ie.storage.getItem(ge)?0:1;R.poke32(H,de)}else R.poke32(H,0);return 0}catch(ie){return q("xAccess",ie),m.setError(ie)}},xRandomness:function(A,C,z){const H=R.heap8u();let ie=0;const ue=Number(z);for(;ie<C;++ie)H[ue+ie]=Math.random()*255e3&255;return C},xGetLastError:function(A,C,z){const H=m.popError();if(M("xGetLastError",H),H){const ie=R.scopedAllocPush();try{const[ue,ge]=R.scopedAllocCString(H.message,!0);return R.cstrncpy(z,ue,C),ge>C&&R.poke8(R.ptr.add(z,C,-1),0),M("set xGetLastError",H.message),H.resultCode|0||n.SQLITE_IOERR}catch{return n.SQLITE_NOMEM}finally{R.scopedAllocPop(ie)}}return 0}},ioDb:{xClose:function(A){m.popError();try{const C=T.get(A);if(f?.log?.xClose&&M("xClose",A,C),C){T.delete(A);const z=C.store;z.files=z.files.filter(H=>H!==C.file),--z.refc<=0&&z.deleteAtRefc0&&b(z),V.ioDb.xClose(A),C.file.dispose(),z.listeners&&be("close",z,z.files.length)}return 0}catch(C){return q("xClose",C),m.setError(C)}},xFileControl:function(A,C,z){m.popError();try{const H=T.get(A);if(P.assert(H,"Missing KVVfsFile handle"),f?.log?.xFileControl&&M("xFileControl",H,"op =",C),C===n.SQLITE_FCNTL_PRAGMA&&G.disablePageSizeChange){const ue=R.peekPtr(R.ptr.add(z,R.ptr.size));if(R.cstrToJs(ue)==="page_size"){f?.log?.xFileControl&&M("xFileControl pragma",R.cstrToJs(ue));const ge=R.peekPtr(R.ptr.add(z,2*R.ptr.size));if(ge)return f?.log?.xFileControl&&se("xFileControl pragma",H,"NOT setting page size to",R.cstrToJs(ge)),H.file.$szPage=-1,0;if(H.file.$szPage>0)return f?.log?.xFileControl&&se("xFileControl",H,"getting page size",H.file.$szPage),R.pokePtr(z,R.allocCString(""+H.file.$szPage)),0}}const ie=V.ioDb.xFileControl(A,C,z);return ie==0&&n.SQLITE_FCNTL_SYNC===C&&H.store.listeners&&be("sync",H.store,!1),ie}catch(H){return q("xFileControl",H),m.setError(H)}},xSync:function(A,C){m.popError();try{const z=T.get(A);f?.log?.xSync&&M("xSync",z),P.assert(z,"Missing KVVfsFile handle");const H=V.ioDb.xSync(A,C);return H==0&&z.store.listeners&&be("sync",z.store,!0),H}catch(z){return q("xSync",z),m.setError(z)}},xRead:function(A,C,z,H){m.popError();try{if(f?.log?.xRead){const ie=T.get(A);P.assert(ie,"Missing KVVfsFile handle"),M("xRead",z,H,ie)}return V.ioDb.xRead(A,C,z,H)}catch(ie){return q("xRead",ie),m.setError(ie)}},xWrite:function(A,C,z,H){m.popError();try{if(f?.log?.xWrite){const ie=T.get(A);P.assert(ie,"Missing KVVfsFile handle"),M("xWrite",z,H,ie)}return V.ioDb.xWrite(A,C,z,H)}catch(ie){return q("xWrite",ie),m.setError(ie)}}},ioJrnl:{xClose:!0}};M("pVfs and friends",Y,j,g,$,n.sqlite3_file.structInfo,r.structInfo);try{P.assert(m.buffer.n>1024*129,"Heap buffer is not large enough");for(const A of Object.entries(oe.recordHandler)){const C=A[0],z=A[1];N[C]=z,$[$.memberKey(C)]=R.installFunction($.memberSignature(C),z)}for(const A of Object.entries(oe.vfs)){const C=A[0],z=A[1],H=Y.memberKey(C),ie=Y.structInfo.members[C]||P.toss("Missing pVfs.structInfo[",C,"]");V.vfs[C]=R.functionEntry(Y[H]),Y[H]=R.installFunction(ie.signature,z)}for(const A of Object.entries(oe.ioDb)){const C=A[0],z=A[1],H=j.memberKey(C);V.ioDb[C]=R.functionEntry(j[H])||P.toss("Missing native pIoDb[",H,"]"),j[H]=R.installFunction(j.memberSignature(C),z)}for(const A of Object.entries(oe.ioJrnl)){const C=A[0],z=A[1],H=g.memberKey(C);V.ioJrnl[C]=R.functionEntry(g[H])||P.toss("Missing native pIoJrnl[",H,"]"),z===!0?g[H]=j[H]||P.toss("Missing copied pIoDb[",H,"]"):g[H]=R.installFunction(g.memberSignature(C),z)}}finally{$.dispose(),Y.dispose(),j.dispose(),g.dispose()}const y=function A(C){if(C==="")return A("local")+A("session");const z=X(C);if(!z)return 0;z.files.length&&(globalThis.localStorage===z.storage||globalThis.sessionStorage===z.storage||Z(n.SQLITE_ACCESS,"Cannot clear in-use database storage."));const H=z.storage,ie=[];let ue,ge=H.length;for(ue=0;ue<ge;++ue){const de=H.key(ue);(!z.keyPrefix||de.startsWith(z.keyPrefix))&&ie.push(de)}return ie.forEach(de=>H.removeItem(de)),ie.length},x=function A(C){if(C==="")return A("local")+A("session");const z=X(C);if(!z)return 0;const H=z.storage;let ie,ue=0;for(ie=0;ie<H.length;++ie){const ge=H.key(ie);(!z.keyPrefix||ge.startsWith(z.keyPrefix))&&(ue+=ge.length,ue+=H.getItem(ge).length)}return ue*2},J=function(...C){let z;C.length===1&&typeof C[0]=="object"?z=C[0]:C.length&&(z=Object.assign(Object.create(null),{name:C[0]}));const H=z?X(z.name):null;H||Z(n.SQLITE_NOTFOUND,"There is no kvvfs storage named",z?.name);const ie=H.storage,ue=Object.assign(Object.create(null),{name:H.jzClass,timestamp:Date.now(),pages:[]}),ge=Object.create(null),de=H.keyPrefix,qe=de?/^kvvfs-[^-]+-(\w+)/:void 0;let Le=0,De=ie.length;for(;Le<De;++Le){const Oe=ie.key(Le);if(!de||Oe.startsWith(de)){let Ge=(de?qe.exec(Oe):void 0)?.[1]??Oe;switch(Ge){case"jrnl":z.includeJournal&&(ue.journal=ie.getItem(Oe));break;case"sz":ue.size=+ie.getItem(Oe);break;default:if(Ge=+Ge,(!P.isInt32(Ge)||Ge<=0)&&Z(n.SQLITE_RANGE,"Malformed kvvfs key: "+Oe),z.decodePages){const at=ie.getItem(Oe),kt=at.length,it=m.memBuffer(0),Ht=m.memBuffer(1),st=R.heap8u();let St=0;for(;St<kt;++St)st[R.ptr.add(it,St)]=at.codePointAt(St)&255;st[R.ptr.add(it,St)]=0;const on=ve(it,Ht,m.buffer.n);ge[Ge]=st.slice(Number(Ht),R.ptr.addn(Ht,on))}else ge[Ge]=ie.getItem(Oe);break}}}return z.decodePages&&m.memBufferFree(1),Object.keys(ge).map(Oe=>+Oe).sort().forEach(Oe=>ue.pages.push(ge[Oe])),ue},ae=function(A,C=!1){!A?.timestamp||!A.name||A.size===void 0||!Array.isArray(A.pages)?Z(n.SQLITE_MISUSE,"Malformed export object."):(!A.size||A.size!==(A.size|0)||A.size>=2147483647)&&Z(n.SQLITE_RANGE,"Invalid db size: "+A.size),I(A.name);let z=X(A.name);const H=!z;z?(C?!z.files||!z.jzClass?Z(n.SQLITE_ERROR,"Internal storage object",A.name,"seems to be malformed."):z.files.length&&Z(n.SQLITE_IOERR_ACCESS,"Cannot import db storage while it is in use."):Z(n.SQLITE_ACCESS,"Storage '"+A.name+"' already exists and","overwrite was not specified."),y(A.name)):z=L(A.name);const ie=Q(A.name);let ue;try{const ge=z.storage;ge.setItem(ie+"sz",A.size),A.journal&&ge.setItem(ie+"jrnl",A.journal),A.pages[0]instanceof Uint8Array?A.pages.forEach((de,qe)=>{const Le=de.length;ue??=m.memBuffer(1);const De=m.memBuffer(0),Oe=R.heap8u();Oe.set(de,Number(De)),Oe[R.ptr.addn(De,Le)]=0;const Ge=Ie(De,Le,ue);P.assert(Ge<m.buffer.n,"Impossibly long output - possibly smashed the heap"),P.assert(R.peek8(R.ptr.add(ue,Ge))===0,"Expecting NUL-terminated encoded output");const at=R.cstrToJs(ue);ge.setItem(ie+(qe+1),at)}):A.pages[0]&&A.pages.forEach((de,qe)=>ge.setItem(ie+(qe+1),de)),H&&S(z)}catch{if(!H)try{y(A.name)}catch{}}finally{ue&&m.memBufferFree(1)}return this},re=function(A){let C=X(A);if(C){++C.refc;return}I(A),S(L(A))},pe=function(A){const C=X(A);return!C||U(C.jzClass)||ne(C.jzClass)||m.rxJournalSuffix.test(A)?!1:C.refc>C.files.length||C.files.length===0?(--C.refc<=0&&b(C),!0):!1},we=function(A){(!A||typeof A!="object")&&Z(n.SQLITE_MISUSE,"Expecting a listener object.");let C=X(A.storage);C||(A.storage&&A.reserve?(re(A.storage),C=X(A.storage),P.assert(C,"Unexpectedly cannot fetch reserved storage "+A.storage)):Z(n.SQLITE_NOTFOUND,"No such storage:",A.storage)),A.events&&(C.listeners??=[]).push(A)},he=function(A){const C=X(A?.storage);if(C?.listeners&&A.events){const z=C.listeners.length;C.listeners=C.listeners.filter(ie=>ie!==A);const H=z>C.listeners.length;return C.listeners.length||(C.listeners=void 0),H}return!1};if(s.kvvfs.reserve=re,s.kvvfs.import=ae,s.kvvfs.export=J,s.kvvfs.unlink=pe,s.kvvfs.listen=we,s.kvvfs.unlisten=he,s.kvvfs.exists=A=>!!X(A),s.kvvfs.estimateSize=x,s.kvvfs.clear=y,globalThis.Storage&&(n.sqlite3_js_kvvfs_size=(A="")=>x(A),n.sqlite3_js_kvvfs_clear=(A="")=>y(A)),s.oo1?.DB){const A=s.oo1.DB;s.oo1.JsStorageDb=function(z=s.oo1.JsStorageDb.defaultStorageName){const H=A.dbCtorHelper.normalizeArgs(...arguments);switch(H.vfs="kvvfs",H.filename){case":sessionStorage:":H.filename="session";break;case":localStorage:":H.filename="local";break}const ie=/(file:(\/\/)?)([^?]+)/.exec(H.filename);I(ie?ie[3]:H.filename),A.dbCtorHelper.call(this,H)},s.oo1.JsStorageDb.defaultStorageName=m.storagePool.session?"session":B;const C=s.oo1.JsStorageDb;C.prototype=Object.create(A.prototype),C.clearStorage=y,C.prototype.clearStorage=function(){return C.clearStorage(this.affirmOpen().dbFilename(),!0)},C.storageSize=x,C.prototype.storageSize=function(){return C.storageSize(this.affirmOpen().dbFilename(),!0)}}if(s.__isUnderTest&&s.vtab){const A=Object.assign(Object.create(null),{rowid:{type:"INTEGER"},name:{type:"TEXT"},nRef:{type:"INTEGER"},nOpen:{type:"INTEGER"},isTransient:{type:"INTEGER"},dbSize:{type:"INTEGER"}});Object.keys(A).forEach((ge,de)=>A[ge].colId=de);const C=s.vtab,z=Object.assign(Object.create(null),{row:function(){return m.storagePool[this.names[this.rowid]]}});Object.assign(Object.create(z),{rowid:0,names:Object.keys(m.storagePool).filter(ge=>!m.rxJournalSuffix.test(ge))});const H=function(ge,de){const qe=ge instanceof n.sqlite3_vtab_cursor?ge:C.xCursor.get(ge);return(de||!qe.vTabState)&&(qe.vTabState=Object.assign(Object.create(z),{rowid:0,names:Object.keys(m.storagePool).filter(Le=>!m.rxJournalSuffix.test(Le))})),qe.vTabState},ie=()=>{},ue=function ge(){return ge.mod??=new s.capi.sqlite3_module().setupModule({catchExceptions:!0,methods:{xConnect:function(de,qe,Le,De,Oe,Ge){try{const at=[];Object.keys(A).forEach(it=>{at.push(it+" "+A[it].type)});const kt=n.sqlite3_declare_vtab(de,"CREATE TABLE ignored("+at.join(",")+")");if(kt===0){const it=C.xVtab.create(Oe);P.assert(it===C.xVtab.get(R.peekPtr(Oe)),"output pointer check failed")}return kt}catch(at){return C.xErrror("xConnect",at,n.SQLITE_ERROR)}},xCreate:R.ptr.null,xDisconnect:function(de){return C.xVtab.dispose(de),0},xOpen:function(de,qe){return C.xCursor.create(qe),0},xClose:function(de){const qe=C.xCursor.unget(de);return delete qe.vTabState,qe.dispose(),0},xNext:function(de){const qe=C.xCursor.get(de);return++H(qe).rowid,0},xColumn:function(de,qe,Le){const De=H(de),Oe=De.row();switch(P.assert(Oe,"Unexpected xColumn call"),Le){case A.rowid.colId:n.sqlite3_result_int(qe,De.rowid);break;case A.name.colId:n.sqlite3_result_text(qe,Oe.jzClass,-1,n.SQLITE_TRANSIENT);break;case A.nRef.colId:n.sqlite3_result_int(qe,Oe.refc);break;case A.nOpen.colId:n.sqlite3_result_int(qe,Oe.files.length);break;case A.isTransient.colId:n.sqlite3_result_int(qe,!!Oe.deleteAtRefc0);break;case A.dbSize.colId:n.sqlite3_result_int(qe,p(Oe));break;default:return n.sqlite3_result_error(qe,"Invalid column id: "+Le),n.SQLITE_RANGE}return 0},xRowid:function(de,qe){const Le=H(de);return C.xRowid(qe,Le.rowid),0},xEof:function(de){const qe=H(de);return ie("xEof?="+!qe.row(),...arguments),!qe.row()},xFilter:function(de,qe,Le,De,Oe){return H(de,!0),0},xBestIndex:function(de,qe){const Le=new n.sqlite3_index_info(qe);return Le.$estimatedRows=m.storagePool.size,Le.$estimatedCost=1,Le.dispose(),0}}})};s.kvvfs.create_module=function(ge,de="sqlite_kvvfs"){return n.sqlite3_create_module(ge,de,ue(),R.ptr.null)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=function i(r){if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory)return Promise.reject(new Error("Missing required OPFS APIs."));(!r||typeof r!="object")&&(r=Object.create(null));const c=new URL(globalThis.location.href).searchParams;return c.has("opfs-disable")?Promise.resolve(s):(r.verbose===void 0&&(r.verbose=c.has("opfs-verbose")?+c.get("opfs-verbose")||2:1),r.sanityChecks===void 0&&(r.sanityChecks=c.has("opfs-sanity-check")),r.proxyUri===void 0&&(r.proxyUri=i.defaultProxyUri),typeof r.proxyUri=="function"&&(r.proxyUri=r.proxyUri()),new Promise(function(P,R){const Z=[s.config.error,s.config.warn,s.config.log],D=(y,...x)=>{r.verbose>y&&Z[y]("OPFS syncer:",...x)},$=(...y)=>D(2,...y),m=(...y)=>D(1,...y),W=(...y)=>D(0,...y),M=s.util.toss,se=s.capi,q=s.util,E=s.wasm,U=se.sqlite3_vfs,Q=se.sqlite3_file,I=se.sqlite3_io_methods,L=Object.create(null),f=()=>globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory;L.metrics={dump:function(){let y,x=0,J=0,ae=0;for(y in X.opIds){const re=w[y];x+=re.count,J+=re.time,ae+=re.wait,re.avgTime=re.count&&re.time?re.time/re.count:0,re.avgWait=re.count&&re.wait?re.wait/re.count:0}s.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",w,`
Total of`,x,"op(s) for",J,"ms (incl. "+ae+" ms of waiting on the async side)"),s.config.log("Serialization metrics:",w.s11n),ve.postMessage({type:"opfs-async-metrics"})},reset:function(){let y;const x=ae=>ae.count=ae.time=ae.wait=0;for(y in X.opIds)x(w[y]=Object.create(null));let J=w.s11n=Object.create(null);J=J.serialize=Object.create(null),J.count=J.time=0,J=w.s11n.deserialize=Object.create(null),J.count=J.time=0}};const b=new I,S=new U().addOnDispose(()=>b.dispose());let B;const ne=y=>(B=!0,S.dispose(),R(y)),_e=()=>(B=!1,P(s)),ve=new Worker(new URL(""+new URL("sqlite3-opfs-async-proxy--d6widYe.js",import.meta.url).href,import.meta.url));setTimeout(()=>{B===void 0&&ne(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),ve._originalOnError=ve.onerror,ve.onerror=function(y){W("Error initializing OPFS asyncer:",y),ne(new Error("Loading OPFS async Worker failed for unknown reasons."))};const Ie=se.sqlite3_vfs_find(null),be=Ie?new U(Ie):null;b.$iVersion=1,S.$iVersion=2,S.$szOsFile=se.sqlite3_file.structInfo.sizeof,S.$mxPathname=1024,S.$zName=E.allocCString("opfs"),S.$xDlOpen=S.$xDlError=S.$xDlSym=S.$xDlClose=null,S.addOnDispose("$zName",S.$zName,"cleanup default VFS wrapper",()=>be?be.dispose():null);const X=Object.create(null);X.verbose=r.verbose,X.littleEndian=(()=>{const y=new ArrayBuffer(2);return new DataView(y).setInt16(0,256,!0),new Int16Array(y)[0]===256})(),X.asyncIdleWaitTime=150,X.asyncS11nExceptions=1,X.fileBufferSize=65536,X.sabS11nOffset=X.fileBufferSize,X.sabS11nSize=S.$mxPathname*2,X.sabIO=new SharedArrayBuffer(X.fileBufferSize+X.sabS11nSize),X.opIds=Object.create(null);const w=Object.create(null);{let y=0;X.opIds.whichOp=y++,X.opIds.rc=y++,X.opIds.xAccess=y++,X.opIds.xClose=y++,X.opIds.xDelete=y++,X.opIds.xDeleteNoWait=y++,X.opIds.xFileSize=y++,X.opIds.xLock=y++,X.opIds.xOpen=y++,X.opIds.xRead=y++,X.opIds.xSleep=y++,X.opIds.xSync=y++,X.opIds.xTruncate=y++,X.opIds.xUnlock=y++,X.opIds.xWrite=y++,X.opIds.mkdir=y++,X.opIds["opfs-async-metrics"]=y++,X.opIds["opfs-async-shutdown"]=y++,X.opIds.retry=y++,X.sabOP=new SharedArrayBuffer(y*4),L.metrics.reset()}X.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(y=>{(X.sq3Codes[y]=se[y])===void 0&&M("Maintenance required: not found:",y)}),X.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const a=(y,...x)=>{const J=X.opIds[y]||M("Invalid op ID:",y);X.s11n.serialize(...x),Atomics.store(X.sabOPView,X.opIds.rc,-1),Atomics.store(X.sabOPView,X.opIds.whichOp,J),Atomics.notify(X.sabOPView,X.opIds.whichOp);const ae=performance.now();for(;Atomics.wait(X.sabOPView,X.opIds.rc,-1)!=="not-equal";);const re=Atomics.load(X.sabOPView,X.opIds.rc);if(w[y].wait+=performance.now()-ae,re&&X.asyncS11nExceptions){const pe=X.s11n.deserialize();pe&&W(y+"() async error:",...pe)}return re};L.debug={asyncShutdown:()=>{m("Shutting down OPFS async listener. The OPFS VFS will no longer work."),a("opfs-async-shutdown")},asyncRestart:()=>{m("Attempting to restart OPFS VFS async listener. Might work, might not."),ve.postMessage({type:"opfs-async-restart"})}};const _=()=>{if(X.s11n)return X.s11n;const y=new TextDecoder,x=new TextEncoder("utf-8"),J=new Uint8Array(X.sabIO,X.sabS11nOffset,X.sabS11nSize),ae=new DataView(X.sabIO,X.sabS11nOffset,X.sabS11nSize);X.s11n=Object.create(null);const re=Object.create(null);re.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},re.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},re.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},re.string={id:4};const pe=he=>re[typeof he]||M("Maintenance required: this value type cannot be serialized.",he),we=he=>{switch(he){case re.number.id:return re.number;case re.bigint.id:return re.bigint;case re.boolean.id:return re.boolean;case re.string.id:return re.string;default:M("Invalid type ID:",he)}};return X.s11n.deserialize=function(he=!1){++w.s11n.deserialize.count;const A=performance.now(),C=J[0],z=C?[]:null;if(C){const H=[];let ie=1,ue,ge,de;for(ue=0;ue<C;++ue,++ie)H.push(we(J[ie]));for(ue=0;ue<C;++ue){const qe=H[ue];qe.getter?(de=ae[qe.getter](ie,X.littleEndian),ie+=qe.size):(ge=ae.getInt32(ie,X.littleEndian),ie+=4,de=y.decode(J.slice(ie,ie+ge)),ie+=ge),z.push(de)}}return he&&(J[0]=0),w.s11n.deserialize.time+=performance.now()-A,z},X.s11n.serialize=function(...he){const A=performance.now();if(++w.s11n.serialize.count,he.length){const C=[];let z=0,H=1;for(J[0]=he.length&255;z<he.length;++z,++H)C.push(pe(he[z])),J[H]=C[z].id;for(z=0;z<he.length;++z){const ie=C[z];if(ie.setter)ae[ie.setter](H,he[z],X.littleEndian),H+=ie.size;else{const ue=x.encode(he[z]);ae.setInt32(H,ue.byteLength,X.littleEndian),H+=4,J.set(ue,H),H+=ue.byteLength}}}else J[0]=0;w.s11n.serialize.time+=performance.now()-A},X.s11n},p=function y(x=16){y._chars||(y._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",y._n=y._chars.length);const J=[];let ae=0;for(;ae<x;++ae){const re=Math.random()*(y._n*64)%y._n|0;J[ae]=y._chars[re]}return J.join("")},T=Object.create(null),V=Object.create(null);V.op=void 0,V.start=void 0;const Y=y=>{V.start=performance.now(),V.op=y,++w[y].count},j=()=>w[V.op].time+=performance.now()-V.start,g={xCheckReservedLock:function(y,x){return E.poke(x,0,"i32"),0},xClose:function(y){Y("xClose");let x=0;const J=T[y];return J&&(delete T[y],x=a("xClose",y),J.sq3File&&J.sq3File.dispose()),j(),x},xDeviceCharacteristics:function(y){return se.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(y,x,J){return se.SQLITE_NOTFOUND},xFileSize:function(y,x){Y("xFileSize");let J=a("xFileSize",y);if(J==0)try{const ae=X.s11n.deserialize()[0];E.poke(x,ae,"i64")}catch(ae){W("Unexpected error reading xFileSize() result:",ae),J=X.sq3Codes.SQLITE_IOERR}return j(),J},xLock:function(y,x){Y("xLock");const J=T[y];let ae=0;return J.lockType?J.lockType=x:(ae=a("xLock",y,x),ae===0&&(J.lockType=x)),j(),ae},xRead:function(y,x,J,ae){Y("xRead");const re=T[y];let pe;try{pe=a("xRead",y,J,Number(ae)),(pe===0||se.SQLITE_IOERR_SHORT_READ===pe)&&E.heap8u().set(re.sabView.subarray(0,J),Number(x))}catch(we){W("xRead(",arguments,") failed:",we,re),pe=se.SQLITE_IOERR_READ}return j(),pe},xSync:function(y,x){Y("xSync"),++w.xSync.count;const J=a("xSync",y,x);return j(),J},xTruncate:function(y,x){Y("xTruncate");const J=a("xTruncate",y,Number(x));return j(),J},xUnlock:function(y,x){Y("xUnlock");const J=T[y];let ae=0;return se.SQLITE_LOCK_NONE===x&&J.lockType&&(ae=a("xUnlock",y,x)),ae===0&&(J.lockType=x),j(),ae},xWrite:function(y,x,J,ae){Y("xWrite");const re=T[y];let pe;try{re.sabView.set(E.heap8u().subarray(Number(x),Number(x)+J)),pe=a("xWrite",y,J,Number(ae))}catch(we){W("xWrite(",arguments,") failed:",we,re),pe=se.SQLITE_IOERR_WRITE}return j(),pe}},N={xAccess:function(y,x,J,ae){Y("xAccess");const re=a("xAccess",E.cstrToJs(x));return E.poke(ae,re?0:1,"i32"),j(),0},xCurrentTime:function(y,x){return E.poke(x,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(y,x){return E.poke(x,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(y,x,J){Y("xDelete");const ae=a("xDelete",E.cstrToJs(x),J,!1);return j(),ae},xFullPathname:function(y,x,J,ae){return E.cstrncpy(ae,x,J)<J?0:se.SQLITE_CANTOPEN},xGetLastError:function(y,x,J){return m("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(x,J,ae,re,pe){Y("xOpen");let we=0;J===0?J=p():E.isPtr(J)&&(se.sqlite3_uri_boolean(J,"opfs-unlock-asap",0)&&(we|=X.opfsFlags.OPFS_UNLOCK_ASAP),se.sqlite3_uri_boolean(J,"delete-before-open",0)&&(we|=X.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),J=E.cstrToJs(J));const he=Object.create(null);he.fid=ae,he.filename=J,he.sab=new SharedArrayBuffer(X.fileBufferSize),he.flags=re,he.readOnly=!(se.SQLITE_OPEN_CREATE&re)&&!!(re&se.SQLITE_OPEN_READONLY);const A=a("xOpen",ae,J,re,we);return A||(he.readOnly&&E.poke(pe,se.SQLITE_OPEN_READONLY,"i32"),T[ae]=he,he.sabView=X.sabFileBufView,he.sq3File=new Q(ae),he.sq3File.$pMethods=b.pointer,he.lockType=se.SQLITE_LOCK_NONE),j(),A}};be&&(S.$xRandomness=be.$xRandomness,S.$xSleep=be.$xSleep),S.$xRandomness||(N.xRandomness=function(y,x,J){const ae=E.heap8u();let re=0;const pe=Number(J);for(;re<x;++re)ae[pe+re]=Math.random()*255e3&255;return re}),S.$xSleep||(N.xSleep=function(y,x){return Atomics.wait(X.sabOPView,X.opIds.xSleep,0,x),0}),L.getResolvedPath=function(y,x){const J=new URL(y,"file://irrelevant").pathname;return x?J.split("/").filter(ae=>!!ae):J},L.getDirForFilename=async function(x,J=!1){const ae=L.getResolvedPath(x,!0),re=ae.pop();let pe=L.rootDirectory;for(const we of ae)we&&(pe=await pe.getDirectoryHandle(we,{create:!!J}));return[pe,re]},L.mkdir=async function(y){try{return await L.getDirForFilename(y+"/filepart",!0),!0}catch{return!1}},L.entryExists=async function(y){try{const[x,J]=await L.getDirForFilename(y);return await x.getFileHandle(J),!0}catch{return!1}},L.randomFilename=p,L.treeList=async function(){const y=async function J(ae,re){re.name=ae.name,re.dirs=[],re.files=[];for await(const pe of ae.values())if(pe.kind==="directory"){const we=Object.create(null);re.dirs.push(we),await J(pe,we)}else re.files.push(pe.name)},x=Object.create(null);return await y(L.rootDirectory,x),x},L.rmfr=async function(){const y=L.rootDirectory,x={recurse:!0};for await(const J of y.values())y.removeEntry(J.name,x)},L.unlink=async function(y,x=!1,J=!1){try{const[ae,re]=await L.getDirForFilename(y,!1);return await ae.removeEntry(re,{recursive:x}),!0}catch(ae){if(J)throw new Error("unlink(",arguments[0],") failed: "+ae.message,{cause:ae});return!1}},L.traverse=async function(y){const x={recursive:!0,directory:L.rootDirectory};typeof y=="function"&&(y={callback:y}),y=Object.assign(x,y||{}),(async function J(ae,re){for await(const pe of ae.values()){if(y.callback(pe,ae,re)===!1)return!1;if(y.recursive&&pe.kind==="directory"&&await J(pe,re+1)===!1)break}})(y.directory,0)};const G=async function(y,x){const[J,ae]=await L.getDirForFilename(y,!0);let re=await(await J.getFileHandle(ae,{create:!0})).createSyncAccessHandle(),pe=0,we,he=!1;try{for(re.truncate(0);(we=await x())!==void 0;)we instanceof ArrayBuffer&&(we=new Uint8Array(we)),!he&&pe===0&&we.byteLength>=15&&(q.affirmDbHeader(we),he=!0),re.write(we,{at:pe}),pe+=we.byteLength;if((pe<512||pe%512!==0)&&M("Input size",pe,"is not correct for an SQLite database."),!he){const A=new Uint8Array(20);re.read(A,{at:0}),q.affirmDbHeader(A)}return re.write(new Uint8Array([1,1]),{at:18}),pe}catch(A){throw await re.close(),re=void 0,await J.removeEntry(ae).catch(()=>{}),A}finally{re&&await re.close()}};if(L.importDb=async function(y,x){if(x instanceof Function)return G(y,x);x instanceof ArrayBuffer&&(x=new Uint8Array(x)),q.affirmIsDb(x);const J=x.byteLength,[ae,re]=await L.getDirForFilename(y,!0);let pe,we=0;try{return pe=await(await ae.getFileHandle(re,{create:!0})).createSyncAccessHandle(),pe.truncate(0),we=pe.write(x,{at:0}),we!=J&&M("Expected to write "+J+" bytes but wrote "+we+"."),pe.write(new Uint8Array([1,1]),{at:18}),we}catch(he){throw pe&&(await pe.close(),pe=void 0),await ae.removeEntry(re).catch(()=>{}),he}finally{pe&&await pe.close()}},s.oo1){const y=function(...x){const J=s.oo1.DB.dbCtorHelper.normalizeArgs(...x);J.vfs=S.$zName,s.oo1.DB.dbCtorHelper.call(this,J)};y.prototype=Object.create(s.oo1.DB.prototype),s.oo1.OpfsDb=y,y.importDb=L.importDb,s.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(S.pointer,function(x,J){J.capi.sqlite3_busy_timeout(x,1e4)})}const oe=function(){const y=E.scopedAllocPush(),x=new Q;try{const J=x.pointer,ae=se.SQLITE_OPEN_CREATE|se.SQLITE_OPEN_READWRITE|se.SQLITE_OPEN_MAIN_DB,re=E.scopedAlloc(8),pe="/sanity/check/file"+p(8),we=E.scopedAllocCString(pe);let he;if(X.s11n.serialize("This is  string."),he=X.s11n.deserialize(),$("deserialize() says:",he),he[0]!=="This is  string."&&M("String d13n error."),N.xAccess(S.pointer,we,0,re),he=E.peek(re,"i32"),$("xAccess(",pe,") exists ?=",he),he=N.xOpen(S.pointer,we,J,ae,re),$("open rc =",he,"state.sabOPView[xOpen] =",X.sabOPView[X.opIds.xOpen]),he!==0){W("open failed with code",he);return}N.xAccess(S.pointer,we,0,re),he=E.peek(re,"i32"),he||M("xAccess() failed to detect file."),he=g.xSync(x.pointer,0),he&&M("sync failed w/ rc",he),he=g.xTruncate(x.pointer,1024),he&&M("truncate failed w/ rc",he),E.poke(re,0,"i64"),he=g.xFileSize(x.pointer,re),he&&M("xFileSize failed w/ rc",he),$("xFileSize says:",E.peek(re,"i64")),he=g.xWrite(x.pointer,we,10,1),he&&M("xWrite() failed!");const A=E.scopedAlloc(16);he=g.xRead(x.pointer,A,6,2),E.poke(A+6,0);let C=E.cstrToJs(A);$("xRead() got:",C),C!=="sanity"&&M("Unexpected xRead() value."),N.xSleep&&($("xSleep()ing before close()ing..."),N.xSleep(S.pointer,2e3),$("waking up from xSleep()")),he=g.xClose(J),$("xClose rc =",he,"sabOPView =",X.sabOPView),$("Deleting file:",pe),N.xDelete(S.pointer,we,4660),N.xAccess(S.pointer,we,0,re),he=E.peek(re,"i32"),he&&M("Expecting 0 from xAccess(",pe,") after xDelete()."),m("End of OPFS sanity checks.")}finally{x.dispose(),E.scopedAllocPop(y)}};ve.onmessage=function({data:y}){switch(y.type){case"opfs-unavailable":ne(new Error(y.payload.join(" ")));break;case"opfs-async-loaded":ve.postMessage({type:"opfs-async-init",args:X});break;case"opfs-async-inited":if(B===!0)break;try{s.vfs.installVfs({io:{struct:b,methods:g},vfs:{struct:S,methods:N}}),X.sabOPView=new Int32Array(X.sabOP),X.sabFileBufView=new Uint8Array(X.sabIO,0,X.fileBufferSize),X.sabS11nView=new Uint8Array(X.sabIO,X.sabS11nOffset,X.sabS11nSize),_(),r.sanityChecks&&(m("Running sanity checks because of opfs-sanity-check URL arg..."),oe()),f()?navigator.storage.getDirectory().then(x=>{ve.onerror=ve._originalOnError,delete ve._originalOnError,s.opfs=L,L.rootDirectory=x,$("End of OPFS sqlite3_vfs setup.",S),_e()}).catch(ne):_e()}catch(x){W(x),ne(x)}break;default:{const x="Unexpected message from the OPFS async worker: "+JSON.stringify(y);W(x),ne(new Error(x));break}}}}))};n.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async i=>{try{let r=n.defaultProxyUri;return i?.scriptInfo?.sqlite3Dir&&(n.defaultProxyUri=i.scriptInfo.sqlite3Dir+r),n().catch(c=>{i.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",c.message)})}catch(r){return i.config.error("installOpfsVfs() exception:",r),Promise.reject(r)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util.toss,i=s.util.toss3,r=Object.create(null),c=s.capi,P=s.util,R=s.wasm,Z=4096,D=512,$=4,m=8,W=D+$,M=D,se=W,q=Z,E=c.SQLITE_OPEN_MAIN_DB|c.SQLITE_OPEN_MAIN_JOURNAL|c.SQLITE_OPEN_SUPER_JOURNAL|c.SQLITE_OPEN_WAL,U=c.SQLITE_OPEN_MEMORY,Q=".opaque",I=()=>Math.random().toString(36).slice(2),L=new TextDecoder,f=new TextEncoder,b=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),S=[s.config.error,s.config.warn,s.config.log];s.config.log;const B=s.config.warn;s.config.error;const ne=new Map,_e=j=>ne.get(j),ve=(j,g)=>{g?ne.set(j,g):ne.delete(j)},Ie=new Map,be=j=>Ie.get(j),X=(j,g)=>{g?Ie.set(j,g):Ie.delete(j)},w={xCheckReservedLock:function(j,g){const N=be(j);return N.log("xCheckReservedLock"),N.storeErr(),R.poke32(g,1),0},xClose:function(j){const g=be(j);g.storeErr();const N=g.getOFileForS3File(j);if(N)try{g.log(`xClose ${N.path}`),g.mapS3FileToOFile(j,!1),N.sah.flush(),N.flags&c.SQLITE_OPEN_DELETEONCLOSE&&g.deletePath(N.path)}catch(G){return g.storeErr(G,c.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(j){return c.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(j,g,N){return c.SQLITE_NOTFOUND},xFileSize:function(j,g){const N=be(j);N.log("xFileSize");const G=N.getOFileForS3File(j).sah.getSize()-q;return R.poke64(g,BigInt(G)),0},xLock:function(j,g){const N=be(j);N.log(`xLock ${g}`),N.storeErr();const G=N.getOFileForS3File(j);return G.lockType=g,0},xRead:function(j,g,N,G){const oe=be(j);oe.storeErr();const y=oe.getOFileForS3File(j);oe.log(`xRead ${y.path} ${N} @ ${G}`);try{const x=y.sah.read(R.heap8u().subarray(Number(g),Number(g)+N),{at:q+Number(G)});return x<N?(R.heap8u().fill(0,Number(g)+x,Number(g)+N),c.SQLITE_IOERR_SHORT_READ):0}catch(x){return oe.storeErr(x,c.SQLITE_IOERR)}},xSectorSize:function(j){return Z},xSync:function(j,g){const N=be(j);N.log(`xSync ${g}`),N.storeErr();const G=N.getOFileForS3File(j);try{return G.sah.flush(),0}catch(oe){return N.storeErr(oe,c.SQLITE_IOERR)}},xTruncate:function(j,g){const N=be(j);N.log(`xTruncate ${g}`),N.storeErr();const G=N.getOFileForS3File(j);try{return G.sah.truncate(q+Number(g)),0}catch(oe){return N.storeErr(oe,c.SQLITE_IOERR)}},xUnlock:function(j,g){const N=be(j);N.log("xUnlock");const G=N.getOFileForS3File(j);return G.lockType=g,0},xWrite:function(j,g,N,G){const oe=be(j);oe.storeErr();const y=oe.getOFileForS3File(j);oe.log(`xWrite ${y.path} ${N} ${G}`);try{return N===y.sah.write(R.heap8u().subarray(Number(g),Number(g)+N),{at:q+Number(G)})?0:n("Unknown write() failure.")}catch(x){return oe.storeErr(x,c.SQLITE_IOERR)}}},a=new c.sqlite3_io_methods;a.$iVersion=1,s.vfs.installVfs({io:{struct:a,methods:w}});const _={xAccess:function(j,g,N,G){const oe=_e(j);oe.storeErr();try{const y=oe.getPath(g);R.poke32(G,oe.hasFilename(y)?1:0)}catch{R.poke32(G,0)}return 0},xCurrentTime:function(j,g){return R.poke(g,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(j,g){return R.poke(g,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(j,g,N){const G=_e(j);G.log(`xDelete ${R.cstrToJs(g)}`),G.storeErr();try{return G.deletePath(G.getPath(g)),0}catch(oe){return G.storeErr(oe),c.SQLITE_IOERR_DELETE}},xFullPathname:function(j,g,N,G){return R.cstrncpy(G,g,N)<N?0:c.SQLITE_CANTOPEN},xGetLastError:function(j,g,N){const G=_e(j),oe=G.popErr();if(G.log(`xGetLastError ${g} e =`,oe),oe){const y=R.scopedAllocPush();try{const[x,J]=R.scopedAllocCString(oe.message,!0);R.cstrncpy(N,x,g),J>g&&R.poke8(R.ptr.add(N,g,-1),0)}catch{return c.SQLITE_NOMEM}finally{R.scopedAllocPop(y)}}return oe?oe.sqlite3Rc||c.SQLITE_IOERR:0},xOpen:function(g,N,G,oe,y){const x=_e(g);try{oe&=~U,x.log(`xOpen ${R.cstrToJs(N)} ${oe}`);const J=N&&R.peek8(N)?x.getPath(N):I();let ae=x.getSAHForPath(J);!ae&&oe&c.SQLITE_OPEN_CREATE&&(x.getFileCount()<x.getCapacity()?(ae=x.nextAvailableSAH(),x.setAssociatedPath(ae,J,oe)):n("SAH pool is full. Cannot create file",J)),ae||n("file not found:",J);const re={path:J,flags:oe,sah:ae};x.mapS3FileToOFile(G,re),re.lockType=c.SQLITE_LOCK_NONE;const pe=new c.sqlite3_file(G);return pe.$pMethods=a.pointer,pe.dispose(),R.poke32(y,oe),0}catch(J){return x.storeErr(J),c.SQLITE_CANTOPEN}}},p=function(j){s.capi.sqlite3_vfs_find(j)&&i("VFS name is already registered:",j);const g=new c.sqlite3_vfs,N=c.sqlite3_vfs_find(null),G=N?new c.sqlite3_vfs(N):null;return g.$iVersion=2,g.$szOsFile=c.sqlite3_file.structInfo.sizeof,g.$mxPathname=D,g.addOnDispose(g.$zName=R.allocCString(j),()=>ve(g.pointer,0)),G&&(g.$xRandomness=G.$xRandomness,g.$xSleep=G.$xSleep,G.dispose()),!g.$xRandomness&&!_.xRandomness&&(_.xRandomness=function(oe,y,x){const J=R.heap8u();let ae=0;const re=Number(x);for(;ae<y;++ae)J[re+ae]=Math.random()*255e3&255;return ae}),!g.$xSleep&&!_.xSleep&&(_.xSleep=(oe,y)=>0),s.vfs.installVfs({vfs:{struct:g,methods:_}}),g};class T{vfsDir;#e;#r;#a;#i=new Map;#t=new Map;#s=new Set;#l=new Map;#n=new Uint8Array(W);#c;#o;#u;constructor(g=Object.create(null)){this.#u=g.verbosity??b.verbosity,this.vfsName=g.name||b.name,this.#o=p(this.vfsName),ve(this.#o.pointer,this),this.vfsDir=g.directory||"."+this.vfsName,this.#c=new DataView(this.#n.buffer,this.#n.byteOffset),this.isReady=this.reset(!!(g.clearOnInit??b.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(g.initialCapacity||b.initialCapacity)})}#_(g,...N){this.#u>g&&S[g](this.vfsName+":",...N)}log(...g){this.#_(2,...g)}warn(...g){this.#_(1,...g)}error(...g){this.#_(0,...g)}getVfs(){return this.#o}getCapacity(){return this.#i.size}getFileCount(){return this.#t.size}getFileNames(){const g=[];for(const N of this.#t.keys())g.push(N);return g}async addCapacity(g){for(let N=0;N<g;++N){const G=I(),oe=await(await this.#r.getFileHandle(G,{create:!0})).createSyncAccessHandle();this.#i.set(oe,G),this.setAssociatedPath(oe,"",0)}return this.getCapacity()}async reduceCapacity(g){let N=0;for(const G of Array.from(this.#s)){if(N===g||this.getFileCount()===this.getCapacity())break;const oe=this.#i.get(G);G.close(),await this.#r.removeEntry(oe),this.#i.delete(G),this.#s.delete(G),++N}return N}releaseAccessHandles(){for(const g of this.#i.keys())g.close();this.#i.clear(),this.#t.clear(),this.#s.clear()}async acquireAccessHandles(g=!1){const N=[];for await(const[G,oe]of this.#r)oe.kind==="file"&&N.push([G,oe]);return Promise.all(N.map(async([G,oe])=>{try{const y=await oe.createSyncAccessHandle();if(this.#i.set(y,G),g)y.truncate(q),this.setAssociatedPath(y,"",0);else{const x=this.getAssociatedPath(y);x?this.#t.set(x,y):this.#s.add(y)}}catch(y){throw this.storeErr(y),this.releaseAccessHandles(),y}}))}getAssociatedPath(g){g.read(this.#n,{at:0});const N=this.#c.getUint32(M);if(this.#n[0]&&(N&c.SQLITE_OPEN_DELETEONCLOSE||(N&E)===0))return B(`Removing file with unexpected flags ${N.toString(16)}`,this.#n),this.setAssociatedPath(g,"",0),"";const G=new Uint32Array(m/4);g.read(G,{at:se});const oe=this.computeDigest(this.#n,N);if(G.every((y,x)=>y===oe[x])){const y=this.#n.findIndex(x=>x===0);return y===0&&g.truncate(q),y?L.decode(this.#n.subarray(0,y)):""}else return B("Disassociating file with bad digest."),this.setAssociatedPath(g,"",0),""}setAssociatedPath(g,N,G){const oe=f.encodeInto(N,this.#n);D<=oe.written+1&&n("Path too long:",N),N&&G&&(G|=U),this.#n.fill(0,oe.written,D),this.#c.setUint32(M,G);const y=this.computeDigest(this.#n,G);g.write(this.#n,{at:0}),g.write(y,{at:se}),g.flush(),N?(this.#t.set(N,g),this.#s.delete(g)):(g.truncate(q),this.#s.add(g))}computeDigest(g,N){if(N&U){let G=3735928559,oe=1103547991;for(const y of g)G=Math.imul(G^y,2654435761),oe=Math.imul(oe^y,104729);return new Uint32Array([G>>>0,oe>>>0])}else return new Uint32Array([0,0])}async reset(g){await this.isReady;let N=await navigator.storage.getDirectory(),G;for(const oe of this.vfsDir.split("/"))oe&&(G=N,N=await N.getDirectoryHandle(oe,{create:!0}));return this.#e=N,this.#a=G,this.#r=await this.#e.getDirectoryHandle(Q,{create:!0}),this.releaseAccessHandles(),this.acquireAccessHandles(g)}getPath(g){return R.isPtr(g)&&(g=R.cstrToJs(g)),(g instanceof URL?g:new URL(g,"file://localhost/")).pathname}deletePath(g){const N=this.#t.get(g);return N&&(this.#t.delete(g),this.setAssociatedPath(N,"",0)),!!N}storeErr(g,N){return g&&(g.sqlite3Rc=N||c.SQLITE_IOERR,this.error(g)),this.$error=g,N}popErr(){const g=this.$error;return this.$error=void 0,g}nextAvailableSAH(){const[g]=this.#s.keys();return g}getOFileForS3File(g){return this.#l.get(g)}mapS3FileToOFile(g,N){N?(this.#l.set(g,N),X(g,this)):(this.#l.delete(g),X(g,!1))}hasFilename(g){return this.#t.has(g)}getSAHForPath(g){return this.#t.get(g)}async removeVfs(){if(!this.#o.pointer||!this.#r)return!1;c.sqlite3_vfs_unregister(this.#o.pointer),this.#o.dispose(),delete r[this.vfsName];try{this.releaseAccessHandles(),await this.#e.removeEntry(Q,{recursive:!0}),this.#r=void 0,await this.#a.removeEntry(this.#e.name,{recursive:!0}),this.#e=this.#a=void 0}catch(g){s.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",g)}return!0}pauseVfs(){return this.#l.size>0&&s.SQLite3Error.toss(c.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),this.#i.size>0&&(c.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return this.#i.size===0}async unpauseVfs(){return this.#i.size===0?this.acquireAccessHandles(!1).then(()=>c.sqlite3_vfs_register(this.#o,0),this):this}exportFile(g){const N=this.#t.get(g)||n("File not found:",g),G=N.getSize()-q,oe=new Uint8Array(G>0?G:0);if(G>0){const y=N.read(oe,{at:q});y!=G&&n("Expected to read "+G+" bytes but read "+y+".")}return oe}async importDbChunked(g,N){const G=this.#t.get(g)||this.nextAvailableSAH()||n("No available handles to import to.");G.truncate(0);let oe=0,y,x=!1;try{for(;(y=await N())!==void 0;)y instanceof ArrayBuffer&&(y=new Uint8Array(y)),!x&&oe===0&&y.byteLength>=15&&(P.affirmDbHeader(y),x=!0),G.write(y,{at:q+oe}),oe+=y.byteLength;if((oe<512||oe%512!==0)&&n("Input size",oe,"is not correct for an SQLite database."),!x){const J=new Uint8Array(20);G.read(J,{at:0}),P.affirmDbHeader(J)}G.write(new Uint8Array([1,1]),{at:q+18})}catch(J){throw this.setAssociatedPath(G,"",0),J}return this.setAssociatedPath(G,g,c.SQLITE_OPEN_MAIN_DB),oe}importDb(g,N){if(N instanceof ArrayBuffer)N=new Uint8Array(N);else if(N instanceof Function)return this.importDbChunked(g,N);const G=this.#t.get(g)||this.nextAvailableSAH()||n("No available handles to import to."),oe=N.byteLength;(oe<512||oe%512!=0)&&n("Byte array size is invalid for an SQLite db.");const y="SQLite format 3";for(let J=0;J<15;++J)y.charCodeAt(J)!==N[J]&&n("Input does not contain an SQLite database header.");const x=G.write(N,{at:q});return x!=oe?(this.setAssociatedPath(G,"",0),n("Expected to write "+oe+" bytes but wrote "+x+".")):(G.write(new Uint8Array([1,1]),{at:q+18}),this.setAssociatedPath(G,g,c.SQLITE_OPEN_MAIN_DB)),x}}class V{#e;constructor(g){this.#e=g,this.vfsName=g.vfsName}async addCapacity(g){return this.#e.addCapacity(g)}async reduceCapacity(g){return this.#e.reduceCapacity(g)}getCapacity(){return this.#e.getCapacity(this.#e)}getFileCount(){return this.#e.getFileCount()}getFileNames(){return this.#e.getFileNames()}async reserveMinimumCapacity(g){const N=this.#e.getCapacity();return N<g?this.#e.addCapacity(g-N):N}exportFile(g){return this.#e.exportFile(g)}importDb(g,N){return this.#e.importDb(g,N)}async wipeFiles(){return this.#e.reset(!0)}unlink(g){return this.#e.deletePath(g)}async removeVfs(){return this.#e.removeVfs()}pauseVfs(){return this.#e.pauseVfs(),this}async unpauseVfs(){return this.#e.unpauseVfs().then(()=>this)}isPaused(){return this.#e.isPaused()}}const Y=async()=>{const j=await navigator.storage.getDirectory(),g=".opfs-sahpool-sync-check-"+I(),N=(await(await j.getFileHandle(g,{create:!0})).createSyncAccessHandle()).close();return await N,await j.removeEntry(g),N?.then&&n("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};s.installOpfsSAHPoolVfs=async function(j=Object.create(null)){j=Object.assign(Object.create(null),b,j||{});const g=j.name;if(j.$testThrowPhase1)throw j.$testThrowPhase1;if(r[g])try{return await r[g]}catch(N){if(j.forceReinitIfPreviouslyFailed)delete r[g];else throw N}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory?r[g]=Promise.reject(new Error("Missing required OPFS APIs.")):r[g]=Y().then(async function(){if(j.$testThrowPhase2)throw j.$testThrowPhase2;const N=new T(j);return N.isReady.then(async()=>{const G=new V(N);if(s.oo1){const oe=s.oo1,y=N.getVfs(),x=function(...J){const ae=oe.DB.dbCtorHelper.normalizeArgs(...J);ae.vfs=y.$zName,oe.DB.dbCtorHelper.call(this,ae)};x.prototype=Object.create(oe.DB.prototype),G.OpfsSAHPoolDb=x}return N.log("VFS initialized."),G}).catch(async G=>{throw await N.removeVfs().catch(()=>{}),G})}).catch(N=>r[g]=Promise.reject(N))}});try{const s=Object.assign(Object.create(null),{memory:typeof ot<"u"?ot:t.wasmMemory,exports:typeof xt<"u"?xt:Object.prototype.hasOwnProperty.call(t,"wasmExports")?t.wasmExports:t.asm},globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{});e.debugModule("Bootstrapping lib config",s);const n=globalThis.sqlite3ApiBootstrap(s);return delete globalThis.sqlite3ApiBootstrap,n}catch(s){throw console.error("sqlite3ApiBootstrap() error:",s),s}},Qt?me=u:me=new Promise((e,t)=>{ct=e,_t=t}),me}xn=(function(){const Xe=xn;if(!Xe)throw new Error("Expecting sqlite3InitModule to be defined by the Emscripten build.");const me=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:globalThis?.document?.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:globalThis?.location?.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(me.debugModule=me.urlParams.has("sqlite3.debugModule")?(...Ue)=>console.warn("sqlite3.debugModule:",...Ue):()=>{},me.urlParams.has("sqlite3.dir"))me.sqlite3Dir=me.urlParams.get("sqlite3.dir")+"/";else if(me.moduleScript){const Ue=me.moduleScript.src.split("/");Ue.pop(),me.sqlite3Dir=Ue.join("/")+"/"}const u=globalThis.sqlite3InitModule=function Ue(...Ye){return me.emscriptenLocateFile=Ye[0]?.locateFile,me.emscriptenInstantiateWasm=Ye[0]?.instantiateWasm,Xe(...Ye).then(je=>{me.debugModule("sqlite3InitModule() sIMS =",me),me.debugModule("sqlite3InitModule() EmscriptenModule =",je);const Ze=je.runSQLite3PostLoadInit(me,je,!!Ue.__isUnderTest);return me.debugModule("sqlite3InitModule() sqlite3 =",Ze),Ze}).catch(je=>{throw console.error("Exception loading sqlite3 module:",je),je})};if(u.ready=Xe.ready,me.moduleScript){let Ue=me.moduleScript.src.split("/");Ue.pop(),me.scriptDir=Ue.join("/")+"/"}return me.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",me),u})();var mr=xn;globalThis.sqlite3Worker1Promiser=function Xe(me=Xe.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const te=me;me=Object.assign(Object.create(null),Xe.defaultConfig),me.onready=te}else me=Object.assign(Object.create(null),Xe.defaultConfig,me);const u=Object.create(null),Ue=function(){},Ye=me.onerror||Ue,je=me.debug||Ue,Ze=me.generateMessageId?void 0:Object.create(null),vt=me.generateMessageId||function(te){return te.type+"#"+(Ze[te.type]=(Ze[te.type]||0)+1)},Rt=(...te)=>{throw new Error(te.join(" "))};me.worker||(me.worker=Xe.defaultConfig.worker),typeof me.worker=="function"&&(me.worker=me.worker());let tt,fe;return me.worker.onmessage=function(te){te=te.data,je("worker1.onmessage",te);let Me=u[te.messageId];if(!Me){if(te&&te.type==="sqlite3-api"&&te.result==="worker1-ready"){me.onready&&me.onready(fe);return}if(Me=u[te.type],Me&&Me.onrow){Me.onrow(te);return}me.onunhandled?me.onunhandled(arguments[0]):Ye("sqlite3Worker1Promiser() unhandled worker message:",te);return}switch(delete u[te.messageId],te.type){case"error":Me.reject(te);return;case"open":tt||(tt=te.dbId);break;case"close":te.dbId===tt&&(tt=void 0);break}try{Me.resolve(te)}catch(ze){Me.reject(ze)}},fe=function(){let te;arguments.length===1?te=arguments[0]:arguments.length===2?(te=Object.create(null),te.type=arguments[0],te.args=arguments[1],te.dbId=te.args.dbId):Rt("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!te.dbId&&te.type!=="open"&&(te.dbId=tt),te.messageId=vt(te),te.departureTime=performance.now();const Me=Object.create(null);Me.message=te;let ze;te.type==="exec"&&te.args&&(typeof te.args.callback=="function"?(ze=te.messageId+":row",Me.onrow=te.args.callback,te.args.callback=ze,u[ze]=Me):typeof te.args.callback=="string"&&Rt("exec callback may not be a string when using the Promise interface."));let lt=new Promise(function(ct,_t){Me.resolve=ct,Me.reject=_t,u[te.messageId]=Me,je("Posting",te.type,"message to Worker dbId="+(tt||"default")+":",te),me.worker.postMessage(te)});return ze&&(lt=lt.finally(()=>delete u[ze])),lt}};globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL(""+new URL("sqlite3-worker1-slji4pXB.js",import.meta.url).href,import.meta.url),{type:"module"})},onerror:(...Xe)=>console.error("sqlite3Worker1Promiser():",...Xe)};globalThis.sqlite3Worker1Promiser.v2=(function Xe(me=Xe.defaultConfig){let u;typeof me=="function"?(u=me,me={}):typeof me?.onready=="function"&&(u=me.onready,delete me.onready);const Ue=Object.create(null);me=Object.assign(me||Object.create(null),{onready:async function(je){try{u&&await u(je),Ue.resolve(je)}catch(Ze){Ue.reject(Ze)}}});const Ye=new Promise(function(je,Ze){Ue.resolve=je,Ue.reject=Ze});try{this.original(me)}catch(je){Ue.reject(je)}return Ye}).bind({original:sqlite3Worker1Promiser});globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig;sqlite3Worker1Promiser.v2;delete globalThis.sqlite3Worker1Promiser;var gr=mr;await(async()=>{if(!await new Promise(me=>{navigator.locks.request("habitat-db",{ifAvailable:!0},u=>u?(me(!0),new Promise(()=>{})):(me(!1),Promise.resolve()))})){self.postMessage({type:"LOCK_UNAVAILABLE"});return}try{let me=function(){const d=[];Ve.exec({sql:"PRAGMA user_version",rowMode:"object",callback:ce=>d.push({...ce})});let h=d[0]?.user_version??0;const F={};for(let ce=h+1;ce in F;ce++){for(const Se of F[ce])Ve.exec(Se);Ve.exec(`PRAGMA user_version = ${ce}`),h=ce}h===0&&Ve.exec("PRAGMA user_version = 10")},u=function(){const d=[{key:"checkin_template:morning_checkin",apply:()=>{const F=Nt({title:"Morning Check-in",schedule_type:"DAILY",days_active:null}),ce=[{template_id:F.id,prompt:"How did you sleep?",response_type:"SCALE",display_order:0},{template_id:F.id,prompt:"How is your energy level right now?",response_type:"SCALE",display_order:1},{template_id:F.id,prompt:"What's your main intention for today?",response_type:"TEXT",display_order:2},{template_id:F.id,prompt:"Are you feeling anxious or stressed?",response_type:"BOOLEAN",display_order:3}];for(const Se of ce)Ft(Se)}},{key:"checkin_template:evening_reflection",apply:()=>{const F=Nt({title:"Evening Reflection",schedule_type:"DAILY",days_active:null}),ce=[{template_id:F.id,prompt:"Overall mood today (110)?",response_type:"SCALE",display_order:0},{template_id:F.id,prompt:"What went well today?",response_type:"TEXT",display_order:1},{template_id:F.id,prompt:"What could have gone better?",response_type:"TEXT",display_order:2},{template_id:F.id,prompt:"Did you complete your main intention?",response_type:"BOOLEAN",display_order:3}];for(const Se of ce)Ft(Se)}},{key:"checkin_template:weekly_review",apply:()=>{const F=Nt({title:"Weekly Review",schedule_type:"WEEKLY",days_active:[0]}),ce=[{template_id:F.id,prompt:"How would you rate this week overall (110)?",response_type:"SCALE",display_order:0},{template_id:F.id,prompt:"What were your biggest wins?",response_type:"TEXT",display_order:1},{template_id:F.id,prompt:"Which habit are you most proud of?",response_type:"TEXT",display_order:2},{template_id:F.id,prompt:"What will you focus on next week?",response_type:"TEXT",display_order:3}];for(const Se of ce)Ft(Se)}}],h=new Date().toISOString();for(const{key:F,apply:ce}of d)fe("SELECT key FROM applied_defaults WHERE key = ?",[F]).length===0&&(ce(),te("INSERT INTO applied_defaults (key, applied_at) VALUES (?,?)",[F,h]))},Ue=function(){const d=ht.wasm,h=ht.capi,F=d.pstack.pointer;try{const ce=d.pstack.alloc(8),Se=h.sqlite3_serialize(Ve.pointer,"main",ce,0);if(!Se)throw new Error("sqlite3_serialize returned null");const Te=Number(d.peek(ce,"i64")),Re=new Uint8Array(Te);return Re.set(d.heap8u().subarray(Se,Se+Te)),h.sqlite3_free(Se),Re}finally{d.pstack.restore(F)}},Ye=function(d){const h=d.habits?fe("SELECT * FROM habits ORDER BY created_at ASC").map(Me):[],F=d.completions?Gt():[],ce=d.habit_logs?fe("SELECT * FROM habit_logs ORDER BY logged_at ASC").map(ct):[],Se=d.habit_schedules?fe("SELECT * FROM habit_schedules").map(lt):[],Te=d.reminders?l():[],Re=d.checkin_templates?ft():[],Ot=d.checkin_questions?fe("SELECT * FROM checkin_questions ORDER BY template_id, display_order").map(ut):[],mt=d.checkin_responses?fe("SELECT * FROM checkin_responses ORDER BY logged_date ASC").map(Et):[],rt=d.checkin_reminders?sn():[],Nn=d.scribbles?tn():[],Fn=d.checkin_entries?fe("SELECT * FROM checkin_entries ORDER BY entry_date ASC").map(yt):[];return{version:1,exported_at:new Date().toISOString(),habits:h,completions:F,habit_logs:ce,habit_schedules:Se,reminders:Te,checkin_templates:Re,checkin_questions:Ot,checkin_responses:mt,checkin_reminders:rt,scribbles:Nn,checkin_entries:Fn}},je=function(d){for(const h of d.habits??[])te(`INSERT OR IGNORE INTO habits
         (id, name, description, color, icon, frequency, created_at, archived_at, tags, annotations, type, target_value, paused_until)
       VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)`,[h.id,h.name,h.description,h.color,h.icon,h.frequency,h.created_at,h.archived_at??null,JSON.stringify(h.tags??[]),JSON.stringify(h.annotations??{}),h.type??"BOOLEAN",h.target_value??1,h.paused_until??null]);for(const h of d.completions??[])te(`INSERT OR IGNORE INTO completions (id, habit_id, date, completed_at, notes, tags, annotations)
       VALUES (?,?,?,?,?,?,?)`,[h.id,h.habit_id,h.date,h.completed_at,h.notes??"",JSON.stringify(h.tags??[]),JSON.stringify(h.annotations??{})]);for(const h of d.habit_logs??[])te(`INSERT OR IGNORE INTO habit_logs (id, habit_id, date, logged_at, value, notes)
       VALUES (?,?,?,?,?,?)`,[h.id,h.habit_id,h.date,h.logged_at,h.value,h.notes??""]);for(const h of d.habit_schedules??[])te(`INSERT OR IGNORE INTO habit_schedules
         (id, habit_id, schedule_type, frequency_count, days_of_week, due_time, start_date, end_date)
       VALUES (?,?,?,?,?,?,?,?)`,[h.id,h.habit_id,h.schedule_type??"DAILY",h.frequency_count??null,h.days_of_week!=null?JSON.stringify(h.days_of_week):null,h.due_time??null,h.start_date??null,h.end_date??null]);for(const h of d.reminders??[])te("INSERT OR IGNORE INTO reminders (id, habit_id, trigger_time, days_active) VALUES (?,?,?,?)",[h.id,h.habit_id,h.trigger_time,h.days_active!=null?JSON.stringify(h.days_active):null])},Ze=function(d){for(const h of d.checkin_templates??[])te("INSERT OR IGNORE INTO checkin_templates (id, title, schedule_type, days_active) VALUES (?,?,?,?)",[h.id,h.title,h.schedule_type??"DAILY",h.days_active!=null?JSON.stringify(h.days_active):null]);for(const h of d.checkin_questions??[])te(`INSERT OR IGNORE INTO checkin_questions (id, template_id, prompt, response_type, display_order)
       VALUES (?,?,?,?,?)`,[h.id,h.template_id,h.prompt,h.response_type??"TEXT",h.display_order??0]);for(const h of d.checkin_responses??[])te(`INSERT OR IGNORE INTO checkin_responses (id, question_id, logged_date, value_numeric, value_text)
       VALUES (?,?,?,?,?)`,[h.id,h.question_id,h.logged_date,h.value_numeric??null,h.value_text??null]);for(const h of d.checkin_reminders??[])te("INSERT OR IGNORE INTO checkin_reminders (id, template_id, trigger_time, days_active) VALUES (?,?,?,?)",[h.id,h.template_id,h.trigger_time,h.days_active!=null?JSON.stringify(h.days_active):null])},vt=function(d){for(const h of d.scribbles??[])te(`INSERT OR IGNORE INTO scribbles (id, title, content, tags, annotations, created_at, updated_at)
       VALUES (?,?,?,?,?,?,?)`,[h.id,h.title??"",h.content??"",JSON.stringify(h.tags??[]),JSON.stringify(h.annotations??{}),h.created_at,h.updated_at]);for(const h of d.checkin_entries??[])te(`INSERT OR IGNORE INTO checkin_entries (id, entry_date, content, created_at, updated_at)
       VALUES (?,?,?,?,?)`,[h.id,h.entry_date,h.content??"",h.created_at,h.updated_at])},Rt=function(d){te("BEGIN");try{return je(d),Ze(d),vt(d),te("COMMIT"),null}catch(h){throw te("ROLLBACK"),h}},tt=function(d){if(d.version===1)return Rt(d);throw new Error(`Unsupported export version: ${String(d.version)}`)},fe=function(d,h){const F=[];return Ve.exec({sql:d,...h!==void 0&&{bind:h},rowMode:"object",callback:ce=>F.push({...ce})}),F},te=function(d,h){Ve.exec({sql:d,...h!==void 0&&{bind:h}})},Me=function(d){return{id:d.id,name:d.name,description:d.description,color:d.color,icon:d.icon,frequency:d.frequency,created_at:d.created_at,archived_at:d.archived_at??null,tags:JSON.parse(d.tags??"[]"),annotations:JSON.parse(d.annotations??"{}"),type:d.type??"BOOLEAN",target_value:d.target_value??1,paused_until:d.paused_until??null}},ze=function(d){const h=Me(d),F=d.sched_id;return F?{...h,schedule:{id:F,habit_id:h.id,schedule_type:d.schedule_type??"DAILY",frequency_count:d.frequency_count!=null?d.frequency_count:null,days_of_week:d.days_of_week!=null?JSON.parse(d.days_of_week):null,due_time:d.due_time??null,start_date:d.start_date??null,end_date:d.end_date??null}}:{...h,schedule:null}},lt=function(d){return{id:d.id,habit_id:d.habit_id,schedule_type:d.schedule_type??"DAILY",frequency_count:d.frequency_count!=null?d.frequency_count:null,days_of_week:d.days_of_week!=null?JSON.parse(d.days_of_week):null,due_time:d.due_time??null,start_date:d.start_date??null,end_date:d.end_date??null}},ct=function(d){return{id:d.id,habit_id:d.habit_id,date:d.date,logged_at:d.logged_at,value:d.value,notes:d.notes??""}},_t=function(d){return{id:d.id,habit_id:d.habit_id,date:d.date,completed_at:d.completed_at,notes:d.notes,tags:JSON.parse(d.tags??"[]"),annotations:JSON.parse(d.annotations??"{}")}},$e=function(){return fe(`${wt} WHERE h.archived_at IS NULL ORDER BY h.created_at ASC`).map(ze)},dt=function(d){const h=crypto.randomUUID(),F=crypto.randomUUID(),ce=new Date().toISOString();return te(`INSERT INTO habits
       (id, name, description, color, icon, frequency, created_at, tags, annotations,
        type, target_value, paused_until)
     VALUES (?,?,?,?,?,?,?,?,?,?,?,?)`,[h,d.name,d.description,d.color,d.icon,d.frequency,ce,JSON.stringify(d.tags??[]),JSON.stringify(d.annotations??{}),d.type??"BOOLEAN",d.target_value??1,d.paused_until??null]),te(`INSERT INTO habit_schedules
       (id, habit_id, schedule_type, frequency_count, days_of_week, due_time, start_date, end_date)
     VALUES (?,?,?,?,?,?,?,?)`,[F,h,"DAILY",null,null,null,ce.slice(0,10),null]),ze(fe(`${wt} WHERE h.id = ?`,[h])[0])},Tt=function(d){const{id:h,...F}=d,ce=[],Se=["name","description","color","icon","frequency","type","target_value"];for(const Te of Se)Te in F&&ce.push([Te,F[Te]]);if("paused_until"in F&&ce.push(["paused_until",F.paused_until??null]),"tags"in F&&ce.push(["tags",JSON.stringify(F.tags??[])]),"annotations"in F&&ce.push(["annotations",JSON.stringify(F.annotations??{})]),ce.length>0){const Te=ce.map(([Re])=>`${Re} = ?`).join(", ");te(`UPDATE habits SET ${Te} WHERE id = ?`,[...ce.map(([,Re])=>Re),h])}return ze(fe(`${wt} WHERE h.id = ?`,[h])[0])},Ne=function(d){return te("UPDATE habits SET archived_at = ? WHERE id = ?",[new Date().toISOString(),d]),null},Pe=function(d){return te("DELETE FROM habits WHERE id = ?",[d]),null},Qe=function(d){return fe("SELECT * FROM completions WHERE date = ? ORDER BY completed_at ASC",[d]).map(_t)},Qt=function(d,h,F){return fe("SELECT * FROM completions WHERE habit_id = ? AND date >= ? AND date <= ? ORDER BY date ASC",[d,h,F]).map(_t)},Vt=function(d,h){return fe("SELECT * FROM completions WHERE date >= ? AND date <= ? ORDER BY date ASC",[d,h]).map(_t)},ln=function(d,h,F=[],ce={}){if(fe("SELECT * FROM completions WHERE habit_id = ? AND date = ?",[d,h]).length>0)return te("DELETE FROM completions WHERE habit_id = ? AND date = ?",[d,h]),null;const Te=crypto.randomUUID(),Re=new Date().toISOString();return te(`INSERT INTO completions (id, habit_id, date, completed_at, notes, tags, annotations)
     VALUES (?,?,?,?,?,?,?)`,[Te,d,h,Re,"",JSON.stringify(F),JSON.stringify(ce)]),_t(fe("SELECT * FROM completions WHERE id = ?",[Te])[0])},cn=function(){return fe(`${wt} WHERE h.archived_at IS NOT NULL ORDER BY h.archived_at DESC`).map(ze)},Gt=function(){return fe("SELECT * FROM completions ORDER BY date DESC").map(_t)},_n=function(){return te("DELETE FROM habits"),null},nt=function(){return te("DELETE FROM checkin_entries"),null},Dt=function(){return te("DELETE FROM checkin_templates"),null},un=function(){return te("DELETE FROM scribbles"),null},fn=function(){return te("DELETE FROM applied_defaults"),null},dn=function(d){return fe("SELECT 1 FROM applied_defaults WHERE key = ?",[d]).length>0},pn=function(d){return te("INSERT OR IGNORE INTO applied_defaults (key, applied_at) VALUES (?, ?)",[d,new Date().toISOString()]),null},hn=function(){return fe("PRAGMA integrity_check").map(d=>String(d.integrity_check??""))},mn=function(){const h=fe("PRAGMA user_version")[0]?.user_version??0,F=fe("SELECT name, sql FROM sqlite_master WHERE type = 'table' ORDER BY name"),ce=fe("SELECT name, tbl_name, sql FROM sqlite_master WHERE type = 'index' AND sql IS NOT NULL ORDER BY tbl_name, name");return{userVersion:h,tables:F.map(Se=>({name:String(Se.name),sql:String(Se.sql??"")})),indices:ce.map(Se=>({name:String(Se.name),tbl_name:String(Se.tbl_name),sql:String(Se.sql??"")}))}},Mt=function(d){if(d.length===0)return{current:0,longest:0};const h=new Date().toISOString().slice(0,10);let F=0,ce=h;for(const mt of d)if(mt===ce){F++;const rt=new Date(ce);rt.setDate(rt.getDate()-1),ce=rt.toISOString().slice(0,10)}else if(mt<ce)break;const Se=[...d].reverse();let Te=0,Re=0,Ot=null;for(const mt of Se){if(Ot===null)Re=1;else{const rt=new Date(Ot);rt.setDate(rt.getDate()+1),Re=mt===rt.toISOString().slice(0,10)?Re+1:1}Te=Math.max(Te,Re),Ot=mt}return{current:F,longest:Te}},Xt=function(d){const h=fe("SELECT type, target_value FROM habits WHERE id = ?",[d])[0];if(!h)return{current:0,longest:0};const F=h.type??"BOOLEAN",ce=h.target_value??1;if(F==="BOOLEAN"){const Te=fe("SELECT date FROM completions WHERE habit_id = ? ORDER BY date DESC",[d]).map(Re=>Re.date);return Mt(Te)}if(F==="NUMERIC"){const Te=fe("SELECT date FROM habit_logs WHERE habit_id = ? GROUP BY date HAVING SUM(value) >= ? ORDER BY date DESC",[d,ce]).map(Re=>Re.date);return Mt(Te)}const Se=fe("SELECT date FROM habit_logs WHERE habit_id = ? GROUP BY date HAVING SUM(value) < ? ORDER BY date DESC",[d,ce]).map(Te=>Te.date);return Mt(Se)},Jt=function(d){return fe("SELECT * FROM habit_logs WHERE date = ? ORDER BY logged_at ASC",[d]).map(ct)},gn=function(d,h,F){return fe("SELECT * FROM habit_logs WHERE habit_id = ? AND date >= ? AND date <= ? ORDER BY date ASC",[d,h,F]).map(ct)},$t=function(d,h){return fe("SELECT * FROM habit_logs WHERE date >= ? AND date <= ? ORDER BY date ASC",[d,h]).map(ct)},bn=function(d,h,F,ce=""){const Se=crypto.randomUUID(),Te=new Date().toISOString();return te("INSERT INTO habit_logs (id, habit_id, date, logged_at, value, notes) VALUES (?,?,?,?,?,?)",[Se,d,h,Te,F,ce]),ct(fe("SELECT * FROM habit_logs WHERE id = ?",[Se])[0])},ot=function(d){return te("DELETE FROM habit_logs WHERE id = ?",[d]),null},Fe=function(d){const h=fe("SELECT * FROM habit_schedules WHERE habit_id = ?",[d]);return h.length>0?lt(h[0]):null},yn=function(d){const{id:h,...F}=d,ce=[],Se=["schedule_type","frequency_count","due_time","start_date","end_date"];for(const Te of Se)Te in F&&ce.push([Te,F[Te]??null]);if("days_of_week"in F&&ce.push(["days_of_week",F.days_of_week!=null?JSON.stringify(F.days_of_week):null]),ce.length>0){const Te=ce.map(([Re])=>`${Re} = ?`).join(", ");te(`UPDATE habit_schedules SET ${Te} WHERE id = ?`,[...ce.map(([,Re])=>Re),h])}return lt(fe("SELECT * FROM habit_schedules WHERE id = ?",[h])[0])},Kt=function(d,h){return te("UPDATE habits SET paused_until = ? WHERE id = ?",[h,d]),ze(fe(`${wt} WHERE h.id = ?`,[d])[0])},bt=function(d){return te("UPDATE habits SET paused_until = ? WHERE archived_at IS NULL",[d]),null},yt=function(d){return{id:d.id,entry_date:d.entry_date,content:d.content??"",created_at:d.created_at,updated_at:d.updated_at}},At=function(d){return{id:d.id,title:d.title,schedule_type:d.schedule_type??"DAILY",days_active:d.days_active!=null?JSON.parse(d.days_active):null}},ut=function(d){return{id:d.id,template_id:d.template_id,prompt:d.prompt,response_type:d.response_type??"TEXT",display_order:d.display_order??0}},Et=function(d){return{id:d.id,question_id:d.question_id,logged_date:d.logged_date,value_numeric:d.value_numeric!=null?d.value_numeric:null,value_text:d.value_text!=null?d.value_text:null}},Lt=function(d){const h=fe("SELECT * FROM checkin_entries WHERE entry_date = ?",[d]);return h.length>0?yt(h[0]):null},Yt=function(d,h){const F=new Date().toISOString(),ce=fe("SELECT id FROM checkin_entries WHERE entry_date = ?",[d]);if(ce.length>0){const Te=ce[0].id;return te("UPDATE checkin_entries SET content = ?, updated_at = ? WHERE id = ?",[h,F,Te]),yt(fe("SELECT * FROM checkin_entries WHERE id = ?",[Te])[0])}const Se=crypto.randomUUID();return te("INSERT INTO checkin_entries (id, entry_date, content, created_at, updated_at) VALUES (?,?,?,?,?)",[Se,d,h,F,F]),yt(fe("SELECT * FROM checkin_entries WHERE id = ?",[Se])[0])},Ut=function(d){return te("DELETE FROM checkin_entries WHERE id = ?",[d]),null},En=function(d,h){return fe("SELECT * FROM checkin_entries WHERE entry_date >= ? AND entry_date <= ? ORDER BY entry_date DESC",[d,h]).map(yt)},ft=function(){return fe("SELECT * FROM checkin_templates ORDER BY title ASC").map(At)},Nt=function(d){const h=crypto.randomUUID();return te("INSERT INTO checkin_templates (id, title, schedule_type, days_active) VALUES (?,?,?,?)",[h,d.title,d.schedule_type??"DAILY",d.days_active!=null?JSON.stringify(d.days_active):null]),At(fe("SELECT * FROM checkin_templates WHERE id = ?",[h])[0])},Zt=function(d){const{id:h,...F}=d,ce=[];if("title"in F&&ce.push(["title",F.title]),"schedule_type"in F&&ce.push(["schedule_type",F.schedule_type]),"days_active"in F&&ce.push(["days_active",F.days_active!=null?JSON.stringify(F.days_active):null]),ce.length>0){const Se=ce.map(([Te])=>`${Te} = ?`).join(", ");te(`UPDATE checkin_templates SET ${Se} WHERE id = ?`,[...ce.map(([,Te])=>Te),h])}return At(fe("SELECT * FROM checkin_templates WHERE id = ?",[h])[0])},en=function(d){return te("DELETE FROM checkin_templates WHERE id = ?",[d]),null},Ae=function(d){return fe("SELECT * FROM checkin_questions WHERE template_id = ? ORDER BY display_order ASC",[d]).map(ut)},Ft=function(d){const h=crypto.randomUUID();return te("INSERT INTO checkin_questions (id, template_id, prompt, response_type, display_order) VALUES (?,?,?,?,?)",[h,d.template_id,d.prompt,d.response_type??"TEXT",d.display_order??0]),ut(fe("SELECT * FROM checkin_questions WHERE id = ?",[h])[0])},jt=function(d){const{id:h,...F}=d,ce=[];if("prompt"in F&&ce.push(["prompt",F.prompt]),"response_type"in F&&ce.push(["response_type",F.response_type]),"display_order"in F&&ce.push(["display_order",F.display_order]),ce.length>0){const Se=ce.map(([Te])=>`${Te} = ?`).join(", ");te(`UPDATE checkin_questions SET ${Se} WHERE id = ?`,[...ce.map(([,Te])=>Te),h])}return ut(fe("SELECT * FROM checkin_questions WHERE id = ?",[h])[0])},qn=function(d){return te("DELETE FROM checkin_questions WHERE id = ?",[d]),null},Sn=function(d,h){return fe(`SELECT cr.* FROM checkin_responses cr
     JOIN checkin_questions cq ON cq.id = cr.question_id
     WHERE cq.template_id = ? AND cr.logged_date = ?
     ORDER BY cq.display_order ASC`,[d,h]).map(Et)},pt=function(d,h,F,ce){const Se=fe("SELECT id FROM checkin_responses WHERE question_id = ? AND logged_date = ?",[d,h]);if(Se.length>0){const Re=Se[0].id;return te("UPDATE checkin_responses SET value_numeric = ?, value_text = ? WHERE id = ?",[F,ce,Re]),Et(fe("SELECT * FROM checkin_responses WHERE id = ?",[Re])[0])}const Te=crypto.randomUUID();return te("INSERT INTO checkin_responses (id, question_id, logged_date, value_numeric, value_text) VALUES (?,?,?,?,?)",[Te,d,h,F,ce]),Et(fe("SELECT * FROM checkin_responses WHERE id = ?",[Te])[0])},It=function(d){return te("DELETE FROM checkin_responses WHERE id = ?",[d]),null},Ct=function(d){return{id:d.id,title:d.title??"",content:d.content??"",tags:JSON.parse(d.tags??"[]"),annotations:JSON.parse(d.annotations??"{}"),created_at:d.created_at,updated_at:d.updated_at}},tn=function(){return fe("SELECT * FROM scribbles ORDER BY updated_at DESC").map(Ct)},nn=function(d){const h=crypto.randomUUID(),F=new Date().toISOString();return te(`INSERT INTO scribbles (id, title, content, tags, annotations, created_at, updated_at)
     VALUES (?,?,?,?,?,?,?)`,[h,d.title??"",d.content??"",JSON.stringify(d.tags??[]),JSON.stringify(d.annotations??{}),F,F]),Ct(fe("SELECT * FROM scribbles WHERE id = ?",[h])[0])},vn=function(d){const{id:h,...F}=d,Se=[["updated_at",new Date().toISOString()]];"title"in F&&Se.push(["title",F.title??""]),"content"in F&&Se.push(["content",F.content??""]),"tags"in F&&Se.push(["tags",JSON.stringify(F.tags??[])]),"annotations"in F&&Se.push(["annotations",JSON.stringify(F.annotations??{})]);const Te=Se.map(([Re])=>`${Re} = ?`).join(", ");return te(`UPDATE scribbles SET ${Te} WHERE id = ?`,[...Se.map(([,Re])=>Re),h]),Ct(fe("SELECT * FROM scribbles WHERE id = ?",[h])[0])},rn=function(d){return te("DELETE FROM scribbles WHERE id = ?",[d]),null},Bt=function(d){return{id:d.id,habit_id:d.habit_id,trigger_time:d.trigger_time,days_active:d.days_active!=null?JSON.parse(d.days_active):null}},l=function(){return fe("SELECT * FROM reminders ORDER BY trigger_time ASC").map(Bt)},Tn=function(d){return fe("SELECT * FROM reminders WHERE habit_id = ? ORDER BY trigger_time ASC",[d]).map(Bt)},ke=function(d,h,F){const ce=crypto.randomUUID();return te("INSERT INTO reminders (id, habit_id, trigger_time, days_active) VALUES (?,?,?,?)",[ce,d,h,F!=null?JSON.stringify(F):null]),Bt(fe("SELECT * FROM reminders WHERE id = ?",[ce])[0])},An=function(d){return te("DELETE FROM reminders WHERE id = ?",[d]),null},zt=function(d){return{id:d.id,template_id:d.template_id,trigger_time:d.trigger_time,days_active:d.days_active!=null?JSON.parse(d.days_active):null}},sn=function(){return fe("SELECT * FROM checkin_reminders ORDER BY trigger_time ASC").map(zt)},In=function(d){return fe("SELECT * FROM checkin_reminders WHERE template_id = ? ORDER BY trigger_time ASC",[d]).map(zt)},Pt=function(d,h,F){const ce=crypto.randomUUID();return te("INSERT INTO checkin_reminders (id, template_id, trigger_time, days_active) VALUES (?,?,?,?)",[ce,d,h,F!=null?JSON.stringify(F):null]),zt(fe("SELECT * FROM checkin_reminders WHERE id = ?",[ce])[0])},qt=function(d){return te("DELETE FROM checkin_reminders WHERE id = ?",[d]),null},wn=function(d){const h=fe("SELECT * FROM checkin_templates WHERE id = ?",[d]);return h.length>0?At(h[0]):null},On=function(d){return fe(`SELECT ct.id as template_id, ct.title, COUNT(cr.id) as response_count
     FROM checkin_templates ct
     JOIN checkin_questions cq ON cq.template_id = ct.id
     JOIN checkin_responses cr ON cr.question_id = cq.id
     WHERE cr.logged_date = ?
     GROUP BY ct.id, ct.title
     ORDER BY ct.title`,[d]).map(h=>({template_id:h.template_id,title:h.title,response_count:h.response_count}))},kn=function(d){return fe("SELECT * FROM scribbles WHERE updated_at LIKE ? ORDER BY updated_at DESC",[`${d}%`]).map(Ct)},Rn=function(){return fe("SELECT logged_date as date, COUNT(*) as count FROM checkin_responses GROUP BY logged_date ORDER BY logged_date DESC").map(d=>({date:d.date,count:d.count}))};const ht=await gr({print:()=>{},printErr:()=>{}}),Ln=await ht.installOpfsSAHPoolVfs({directory:"/habitat",clearOnInit:!1}),Ve=new Ln.OpfsSAHPoolDb("/habitat.db");Ve.exec(`
  CREATE TABLE IF NOT EXISTS habits (
    id           TEXT PRIMARY KEY,
    name         TEXT NOT NULL,
    description  TEXT NOT NULL DEFAULT '',
    color        TEXT NOT NULL DEFAULT '#6366f1',
    icon         TEXT NOT NULL DEFAULT 'i-heroicons-star',
    frequency    TEXT NOT NULL DEFAULT 'daily',
    created_at   TEXT NOT NULL,
    archived_at  TEXT,
    tags         TEXT NOT NULL DEFAULT '[]',
    annotations  TEXT NOT NULL DEFAULT '{}',
    type         TEXT NOT NULL DEFAULT 'BOOLEAN',
    target_value REAL NOT NULL DEFAULT 1,
    paused_until TEXT
  );

  CREATE TABLE IF NOT EXISTS completions (
    id           TEXT PRIMARY KEY,
    habit_id     TEXT NOT NULL REFERENCES habits(id) ON DELETE CASCADE,
    date         TEXT NOT NULL,
    completed_at TEXT NOT NULL,
    notes        TEXT NOT NULL DEFAULT '',
    tags         TEXT NOT NULL DEFAULT '[]',
    annotations  TEXT NOT NULL DEFAULT '{}',
    UNIQUE(habit_id, date)
  );

  CREATE INDEX IF NOT EXISTS idx_completions_date     ON completions(date);
  CREATE INDEX IF NOT EXISTS idx_completions_habit_id ON completions(habit_id);

  CREATE TABLE IF NOT EXISTS habit_schedules (
    id              TEXT PRIMARY KEY,
    habit_id        TEXT NOT NULL REFERENCES habits(id) ON DELETE CASCADE,
    schedule_type   TEXT NOT NULL DEFAULT 'DAILY',
    frequency_count INTEGER,
    days_of_week    TEXT,
    due_time        TEXT,
    start_date      TEXT,
    end_date        TEXT
  );

  CREATE INDEX IF NOT EXISTS idx_schedules_habit_id ON habit_schedules(habit_id);

  CREATE TABLE IF NOT EXISTS habit_logs (
    id         TEXT PRIMARY KEY,
    habit_id   TEXT NOT NULL REFERENCES habits(id) ON DELETE CASCADE,
    date       TEXT NOT NULL,
    logged_at  TEXT NOT NULL,
    value      REAL NOT NULL DEFAULT 1,
    notes      TEXT NOT NULL DEFAULT ''
  );

  CREATE INDEX IF NOT EXISTS idx_habit_logs_date     ON habit_logs(date);
  CREATE INDEX IF NOT EXISTS idx_habit_logs_habit_id ON habit_logs(habit_id);

  CREATE TABLE IF NOT EXISTS checkin_entries (
    id         TEXT PRIMARY KEY,
    entry_date TEXT UNIQUE NOT NULL,
    content    TEXT NOT NULL DEFAULT '',
    created_at TEXT NOT NULL,
    updated_at TEXT NOT NULL
  );

  CREATE INDEX IF NOT EXISTS idx_checkin_entries_date ON checkin_entries(entry_date);

  CREATE TABLE IF NOT EXISTS checkin_templates (
    id            TEXT PRIMARY KEY,
    title         TEXT NOT NULL,
    schedule_type TEXT NOT NULL DEFAULT 'DAILY',
    days_active   TEXT
  );

  CREATE TABLE IF NOT EXISTS checkin_questions (
    id            TEXT PRIMARY KEY,
    template_id   TEXT NOT NULL REFERENCES checkin_templates(id) ON DELETE CASCADE,
    prompt        TEXT NOT NULL,
    response_type TEXT NOT NULL DEFAULT 'TEXT',
    display_order INTEGER NOT NULL DEFAULT 0
  );

  CREATE INDEX IF NOT EXISTS idx_checkin_questions_template ON checkin_questions(template_id);

  CREATE TABLE IF NOT EXISTS checkin_responses (
    id            TEXT PRIMARY KEY,
    question_id   TEXT NOT NULL REFERENCES checkin_questions(id) ON DELETE CASCADE,
    logged_date   TEXT NOT NULL,
    value_numeric REAL,
    value_text    TEXT,
    UNIQUE(question_id, logged_date)
  );

  CREATE INDEX IF NOT EXISTS idx_checkin_responses_date     ON checkin_responses(logged_date);
  CREATE INDEX IF NOT EXISTS idx_checkin_responses_question ON checkin_responses(question_id);

  CREATE TABLE IF NOT EXISTS applied_defaults (
    key        TEXT PRIMARY KEY,
    applied_at TEXT NOT NULL
  );

  CREATE TABLE IF NOT EXISTS scribbles (
    id          TEXT PRIMARY KEY,
    title       TEXT NOT NULL DEFAULT '',
    content     TEXT NOT NULL DEFAULT '',
    tags        TEXT NOT NULL DEFAULT '[]',
    annotations TEXT NOT NULL DEFAULT '{}',
    created_at  TEXT NOT NULL,
    updated_at  TEXT NOT NULL
  );

  CREATE INDEX IF NOT EXISTS idx_scribbles_updated ON scribbles(updated_at);

  CREATE TABLE IF NOT EXISTS reminders (
    id           TEXT PRIMARY KEY,
    habit_id     TEXT NOT NULL REFERENCES habits(id) ON DELETE CASCADE,
    trigger_time TEXT NOT NULL,
    days_active  TEXT
  );

  CREATE INDEX IF NOT EXISTS idx_reminders_habit_id ON reminders(habit_id);

  CREATE TABLE IF NOT EXISTS checkin_reminders (
    id           TEXT PRIMARY KEY,
    template_id  TEXT NOT NULL REFERENCES checkin_templates(id) ON DELETE CASCADE,
    trigger_time TEXT NOT NULL,
    days_active  TEXT
  );

  CREATE INDEX IF NOT EXISTS idx_checkin_reminders_template ON checkin_reminders(template_id);
`),me(),u();const wt=`
  SELECT h.*, hs.id as sched_id, hs.schedule_type, hs.frequency_count,
         hs.days_of_week, hs.due_time, hs.start_date, hs.end_date
  FROM habits h
  LEFT JOIN habit_schedules hs ON hs.habit_id = h.id`;self.addEventListener("message",async d=>{const h=d.data;let F;try{switch(h.type){case"GET_HABITS":F=$e();break;case"CREATE_HABIT":F=dt(h.payload);break;case"UPDATE_HABIT":F=Tt(h.payload);break;case"ARCHIVE_HABIT":F=Ne(h.payload.id);break;case"DELETE_HABIT":F=Pe(h.payload.id);break;case"GET_COMPLETIONS_FOR_DATE":F=Qe(h.payload.date);break;case"GET_COMPLETIONS_FOR_HABIT":F=Qt(h.payload.habit_id,h.payload.from,h.payload.to);break;case"GET_COMPLETIONS_FOR_DATE_RANGE":F=Vt(h.payload.from,h.payload.to);break;case"TOGGLE_COMPLETION":F=ln(h.payload.habit_id,h.payload.date,h.payload.tags,h.payload.annotations);break;case"GET_STREAK":F=Xt(h.payload.habit_id);break;case"GET_ARCHIVED_HABITS":F=cn();break;case"GET_ALL_COMPLETIONS":F=Gt();break;case"DELETE_ALL_HABITS":F=_n();break;case"DELETE_ALL_CHECKIN_ENTRIES":F=nt();break;case"DELETE_ALL_CHECKIN_DATA":F=Dt();break;case"DELETE_ALL_SCRIBBLES":F=un();break;case"CLEAR_APPLIED_DEFAULTS":F=fn();break;case"GET_DB_INFO":F=mn();break;case"INTEGRITY_CHECK":F=hn();break;case"IS_DEFAULT_APPLIED":F=dn(h.payload.key);break;case"MARK_DEFAULT_APPLIED":F=pn(h.payload.key);break;case"EXPORT_DB":F=Ue();break;case"EXPORT_JSON_DATA":F=Ye(h.payload);break;case"IMPORT_JSON":F=tt(h.payload);break;case"GET_HABIT_LOGS_FOR_DATE":F=Jt(h.payload.date);break;case"GET_HABIT_LOGS_FOR_HABIT":F=gn(h.payload.habit_id,h.payload.from,h.payload.to);break;case"GET_HABIT_LOGS_FOR_DATE_RANGE":F=$t(h.payload.from,h.payload.to);break;case"LOG_HABIT_VALUE":F=bn(h.payload.habit_id,h.payload.date,h.payload.value,h.payload.notes);break;case"DELETE_HABIT_LOG":F=ot(h.payload.id);break;case"GET_SCHEDULE_FOR_HABIT":F=Fe(h.payload.habit_id);break;case"UPDATE_HABIT_SCHEDULE":F=yn(h.payload);break;case"PAUSE_HABIT":F=Kt(h.payload.id,h.payload.until);break;case"PAUSE_ALL_HABITS":F=bt(h.payload.until);break;case"GET_CHECKIN_ENTRY":F=Lt(h.payload.date);break;case"UPSERT_CHECKIN_ENTRY":F=Yt(h.payload.date,h.payload.content);break;case"DELETE_CHECKIN_ENTRY":F=Ut(h.payload.id);break;case"GET_CHECKIN_ENTRIES":F=En(h.payload.from,h.payload.to);break;case"GET_CHECKIN_TEMPLATES":F=ft();break;case"CREATE_CHECKIN_TEMPLATE":F=Nt(h.payload);break;case"UPDATE_CHECKIN_TEMPLATE":F=Zt(h.payload);break;case"DELETE_CHECKIN_TEMPLATE":F=en(h.payload.id);break;case"GET_CHECKIN_QUESTIONS":F=Ae(h.payload.template_id);break;case"CREATE_CHECKIN_QUESTION":F=Ft(h.payload);break;case"UPDATE_CHECKIN_QUESTION":F=jt(h.payload);break;case"DELETE_CHECKIN_QUESTION":F=qn(h.payload.id);break;case"GET_CHECKIN_RESPONSES":F=Sn(h.payload.template_id,h.payload.date);break;case"UPSERT_CHECKIN_RESPONSE":F=pt(h.payload.question_id,h.payload.logged_date,h.payload.value_numeric,h.payload.value_text);break;case"DELETE_CHECKIN_RESPONSE":F=It(h.payload.id);break;case"GET_SCRIBBLES":F=tn();break;case"CREATE_SCRIBBLE":F=nn(h.payload);break;case"UPDATE_SCRIBBLE":F=vn(h.payload);break;case"DELETE_SCRIBBLE":F=rn(h.payload.id);break;case"GET_ALL_REMINDERS":F=l();break;case"GET_REMINDERS_FOR_HABIT":F=Tn(h.payload.habit_id);break;case"CREATE_REMINDER":F=ke(h.payload.habit_id,h.payload.trigger_time,h.payload.days_active);break;case"DELETE_REMINDER":F=An(h.payload.id);break;case"GET_ALL_CHECKIN_REMINDERS":F=sn();break;case"GET_CHECKIN_REMINDERS_FOR_TEMPLATE":F=In(h.payload.template_id);break;case"CREATE_CHECKIN_REMINDER":F=Pt(h.payload.template_id,h.payload.trigger_time,h.payload.days_active);break;case"DELETE_CHECKIN_REMINDER":F=qt(h.payload.id);break;case"GET_CHECKIN_TEMPLATE":F=wn(h.payload.id);break;case"GET_CHECKIN_RESPONSE_DATES":F=Rn();break;case"GET_CHECKIN_SUMMARY_FOR_DATE":F=On(h.payload.date);break;case"GET_SCRIBBLES_FOR_DATE":F=kn(h.payload.date);break;case"NUKE_OPFS":{Ve.close();const ce=await navigator.storage.getDirectory();for await(const[Se]of ce.entries())await ce.removeEntry(Se,{recursive:!0}).catch(()=>{});F=null;break}default:throw new Error(`Unknown request type: ${h.type}`)}self.postMessage({id:h.id,ok:!0,data:F})}catch(ce){self.postMessage({id:h.id,ok:!1,error:ce instanceof Error?ce.message:String(ce)})}}),self.postMessage({type:"READY"})}catch(me){self.postMessage({type:"INIT_ERROR",message:me instanceof Error?me.message:String(me)})}})();
