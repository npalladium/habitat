import{e as K,g as Q,o as c,c as u,a as l,b as i,j as W,F as z,r as j,k as X,l as Y,t as v,m as E,p as _,n as M,d as h,i as o,w as m,q as Z,v as ee,y,z as O,A as te}from"./O9JIA0ss.js";import{_ as se}from"./nd7kv66y.js";import{_ as le}from"./B4YtyPT5.js";import{_ as ie}from"./lDetNp4R.js";import{_ as oe}from"./BZt495mH.js";const ne={class:"max-w-lg mx-auto space-y-6"},ae={class:"flex items-center gap-3"},re={class:"flex items-center justify-between"},ce={class:"flex items-center gap-2"},de={class:"font-semibold text-sm"},ue={class:"text-xs text-slate-500"},me={class:"flex items-center gap-1"},fe={class:"space-y-1"},ve={class:"flex-1 min-w-0"},_e={class:"flex items-center gap-2 mt-0.5"},pe={key:0,class:"text-xs text-slate-500"},ge={key:1,class:"text-xs text-slate-500 flex items-center gap-0.5"},ye={key:2,class:"text-xs text-slate-500"},xe={class:"flex items-center gap-1 ml-2 shrink-0"},be={key:0,class:"text-xs text-slate-600 px-1"},ke={key:0,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},we={class:"relative w-full sm:max-w-md bg-slate-900 border border-slate-800 rounded-t-3xl sm:rounded-2xl p-5 space-y-4"},he={class:"text-lg font-semibold"},Ce={class:"space-y-3"},Ve={class:"flex items-center gap-2"},Ae={class:"flex gap-2 pt-1"},$e={key:1,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center"},Be={class:"relative w-full sm:max-w-md bg-slate-900 border border-slate-800 rounded-t-3xl sm:rounded-2xl p-5 space-y-4 max-h-[90vh] overflow-y-auto"},Ue={class:"text-lg font-semibold"},ze={class:"space-y-3"},je={class:"flex items-center justify-between"},Ne={key:0},Fe={class:"flex gap-2"},Ee=["onClick"],Me={class:"flex gap-2 pt-1"},Re=K({__name:"activities",setup(Oe){const f=te(),$=y([]),N=y([]),x=y(!1),b=y(!1),C=y(null),V=y(null),B=y(""),p=y(!1),d=O({name:"",icon:"i-heroicons-sparkles",color:"#6366f1"}),n=O({title:"",description:"",estimated_minutes:"",is_recurring:!1,recurrence_rule:"daily",tags:""});async function k(){[$.value,N.value]=await Promise.all([f.getBoredCategories(),f.getBoredActivities()])}Q(k);function U(s){return N.value.filter(e=>e.category_id===s)}function S(s){B.value=s,V.value=null,Object.assign(n,{title:"",description:"",estimated_minutes:"",is_recurring:!1,recurrence_rule:"daily",tags:""}),b.value=!0}function T(s){V.value=s,B.value=s.category_id,Object.assign(n,{title:s.title,description:s.description,estimated_minutes:s.estimated_minutes??"",is_recurring:s.is_recurring,recurrence_rule:s.recurrence_rule??"daily",tags:s.tags.join(", ")}),b.value=!0}function D(){C.value=null,Object.assign(d,{name:"",icon:"i-heroicons-sparkles",color:"#6366f1"}),x.value=!0}function I(s){C.value=s,Object.assign(d,{name:s.name,icon:s.icon,color:s.color}),x.value=!0}async function q(){if(p.value)return;const s={name:d.name.trim(),icon:d.icon,color:d.color};if(s.name){p.value=!0;try{C.value?await f.updateBoredCategory({id:C.value.id,...s}):await f.createBoredCategory({...s,is_system:!1,sort_order:$.value.length}),x.value=!1,await k()}finally{p.value=!1}}}async function R(s){s.is_system||(await f.deleteBoredCategory(s.id),await k())}async function H(){if(p.value)return;const s=n.estimated_minutes!==""?Number(n.estimated_minutes):null,e=n.tags.split(",").map(A=>A.trim()).filter(Boolean),a={title:n.title.trim(),description:n.description.trim(),category_id:B.value,estimated_minutes:s,is_recurring:n.is_recurring,recurrence_rule:n.is_recurring?n.recurrence_rule:null,tags:e,annotations:{}};if(a.title){p.value=!0;try{V.value?await f.updateBoredActivity({id:V.value.id,...a}):await f.createBoredActivity(a),b.value=!1,await k()}finally{p.value=!1}}}async function L(s){await f.deleteBoredActivity(s.id),await k()}async function P(s){await f.archiveBoredActivity(s.id),await k()}return(s,e)=>{const a=W,A=Y,w=se,g=le,G=ie,J=oe;return c(),u("div",ne,[l("div",ae,[i(a,{to:"/bored",variant:"ghost",color:"neutral",size:"sm",icon:"i-heroicons-arrow-left"}),e[13]||(e[13]=l("h1",{class:"text-xl font-bold"},"Manage Activities",-1))]),(c(!0),u(z,null,j(o($),t=>(c(),u("div",{key:t.id,class:"space-y-2"},[l("div",re,[l("div",ce,[i(A,{name:t.icon,class:"w-4 h-4",style:X({color:t.color})},null,8,["name","style"]),l("span",de,v(t.name),1),l("span",ue,"("+v(U(t.id).length)+")",1)]),l("div",me,[t.is_system?_("",!0):(c(),E(a,{key:0,variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-pencil",onClick:r=>I(t)},null,8,["onClick"])),t.is_system?_("",!0):(c(),E(a,{key:1,variant:"ghost",color:"error",size:"xs",icon:"i-heroicons-trash",onClick:r=>R(t)},null,8,["onClick"])),i(a,{variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-plus",onClick:r=>S(t.id)},null,8,["onClick"])])]),l("div",fe,[(c(!0),u(z,null,j(U(t.id),r=>(c(),u("div",{key:r.id,class:"flex items-center justify-between bg-slate-900 border border-slate-800 rounded-xl px-4 py-3"},[l("div",ve,[l("p",{class:M(["text-sm font-medium truncate",r.is_done?"line-through text-slate-500":""])},v(r.title),3),l("div",_e,[r.estimated_minutes?(c(),u("span",pe,v(r.estimated_minutes)+"m ",1)):_("",!0),r.is_recurring?(c(),u("span",ge,[i(A,{name:"i-heroicons-arrow-path",class:"w-3 h-3"}),h(" "+v(r.recurrence_rule),1)])):_("",!0),r.done_count>0?(c(),u("span",ye," Ã—"+v(r.done_count),1)):_("",!0)])]),l("div",xe,[i(a,{variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-pencil",onClick:F=>T(r)},null,8,["onClick"]),i(a,{variant:"ghost",color:"neutral",size:"xs",icon:"i-heroicons-archive-box",onClick:F=>P(r)},null,8,["onClick"]),i(a,{variant:"ghost",color:"error",size:"xs",icon:"i-heroicons-trash",onClick:F=>L(r)},null,8,["onClick"])])]))),128)),U(t.id).length===0?(c(),u("div",be," No activities yet. ")):_("",!0)])]))),128)),i(a,{variant:"soft",color:"neutral",size:"sm",icon:"i-heroicons-plus",class:"w-full",onClick:D},{default:m(()=>[...e[14]||(e[14]=[h(" Add custom category ",-1)])]),_:1}),o(x)?(c(),u("div",ke,[l("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e[0]||(e[0]=t=>x.value=!1)}),l("div",we,[l("h2",he,v(o(C)?"Edit Category":"New Category"),1),l("div",Ce,[i(g,{label:"Name"},{default:m(()=>[i(w,{modelValue:o(d).name,"onUpdate:modelValue":e[1]||(e[1]=t=>o(d).name=t),placeholder:"Category name",class:"w-full"},null,8,["modelValue"])]),_:1}),i(g,{label:"Icon (Heroicons class)"},{default:m(()=>[i(w,{modelValue:o(d).icon,"onUpdate:modelValue":e[2]||(e[2]=t=>o(d).icon=t),placeholder:"i-heroicons-sparkles",class:"w-full"},null,8,["modelValue"])]),_:1}),i(g,{label:"Color"},{default:m(()=>[l("div",Ve,[Z(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>o(d).color=t),type:"color",class:"w-10 h-8 rounded border border-slate-700 bg-transparent cursor-pointer"},null,512),[[ee,o(d).color]]),i(w,{modelValue:o(d).color,"onUpdate:modelValue":e[4]||(e[4]=t=>o(d).color=t),placeholder:"#6366f1",class:"flex-1"},null,8,["modelValue"])])]),_:1})]),l("div",Ae,[i(a,{variant:"soft",color:"neutral",class:"flex-1",onClick:e[5]||(e[5]=t=>x.value=!1)},{default:m(()=>[...e[15]||(e[15]=[h("Cancel",-1)])]),_:1}),i(a,{color:"primary",class:"flex-1",loading:o(p),onClick:q},{default:m(()=>[...e[16]||(e[16]=[h("Save",-1)])]),_:1},8,["loading"])])])])):_("",!0),o(b)?(c(),u("div",$e,[l("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e[6]||(e[6]=t=>b.value=!1)}),l("div",Be,[l("h2",Ue,v(o(V)?"Edit Activity":"New Activity"),1),l("div",ze,[i(g,{label:"Title",required:""},{default:m(()=>[i(w,{modelValue:o(n).title,"onUpdate:modelValue":e[7]||(e[7]=t=>o(n).title=t),placeholder:"Activity title",class:"w-full"},null,8,["modelValue"])]),_:1}),i(g,{label:"Description"},{default:m(()=>[i(G,{modelValue:o(n).description,"onUpdate:modelValue":e[8]||(e[8]=t=>o(n).description=t),placeholder:"Optional description",class:"w-full"},null,8,["modelValue"])]),_:1}),i(g,{label:"Estimated minutes"},{default:m(()=>[i(w,{modelValue:o(n).estimated_minutes,"onUpdate:modelValue":e[9]||(e[9]=t=>o(n).estimated_minutes=t),type:"number",min:"1",placeholder:"e.g. 20",class:"w-full"},null,8,["modelValue"])]),_:1}),l("div",je,[e[17]||(e[17]=l("span",{class:"text-sm"},"Recurring",-1)),i(J,{modelValue:o(n).is_recurring,"onUpdate:modelValue":e[10]||(e[10]=t=>o(n).is_recurring=t)},null,8,["modelValue"])]),o(n).is_recurring?(c(),u("div",Ne,[i(g,{label:"Recurrence"},{default:m(()=>[l("div",Fe,[(c(),u(z,null,j(["daily","weekly","monthly"],t=>l("button",{key:t,class:M(["flex-1 py-1.5 rounded-lg text-sm font-medium capitalize transition-colors",o(n).recurrence_rule===t?"bg-primary-600 text-white":"bg-slate-800 text-slate-300"]),onClick:r=>o(n).recurrence_rule=t},v(t),11,Ee)),64))])]),_:1})])):_("",!0),i(g,{label:"Tags (comma-separated)"},{default:m(()=>[i(w,{modelValue:o(n).tags,"onUpdate:modelValue":e[11]||(e[11]=t=>o(n).tags=t),placeholder:"tag1, tag2",class:"w-full"},null,8,["modelValue"])]),_:1})]),l("div",Me,[i(a,{variant:"soft",color:"neutral",class:"flex-1",onClick:e[12]||(e[12]=t=>b.value=!1)},{default:m(()=>[...e[18]||(e[18]=[h("Cancel",-1)])]),_:1}),i(a,{color:"primary",class:"flex-1",loading:o(p),onClick:H},{default:m(()=>[...e[19]||(e[19]=[h("Save",-1)])]),_:1},8,["loading"])])])])):_("",!0)])}}});export{Re as default};
